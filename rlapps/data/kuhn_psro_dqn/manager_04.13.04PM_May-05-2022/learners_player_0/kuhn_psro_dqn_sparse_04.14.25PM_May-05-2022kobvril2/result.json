{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.411, "episode_media": {}, "episodes_this_iter": 413, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": 0.076, "best_response": -0.076}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23859368020646712, "mean_inference_ms": 0.43712505939994456, "mean_action_processing_ms": 0.02762909483279635, "mean_env_wait_ms": 0.08162688976648629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 25600, "timesteps_this_iter": 4096, "agent_timesteps_total": 25599, "timers": {"load_time_ms": 0.129, "load_throughput": 31638801.444, "learn_time_ms": 6.243, "learn_throughput": 656058.243, "update_time_ms": 1.276}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.5985651612281799, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 25600, "num_agent_steps_sampled": 25599, "num_steps_trained": 40960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 81920, "last_target_update_ts": 16384, "num_target_updates": 1}, "done": false, "episodes_total": 10969, "training_iteration": 10, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-14-36", "timestamp": 1651738476, "time_this_iter_s": 0.5662069320678711, "time_total_s": 9.267001867294312, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 9.267001867294312, "timesteps_since_restore": 40960, "iterations_since_restore": 10, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 11.5, "ram_util_percent": 4.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.487, "episode_media": {}, "episodes_this_iter": 415, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.071, "best_response": 0.071}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23774885333630255, "mean_inference_ms": 0.4390802024677672, "mean_action_processing_ms": 0.02785414532428351, "mean_env_wait_ms": 0.08232492702287146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 35840, "timesteps_this_iter": 4096, "agent_timesteps_total": 35837, "timers": {"load_time_ms": 0.128, "load_throughput": 32034065.232, "learn_time_ms": 5.909, "learn_throughput": 693164.298, "update_time_ms": 1.294}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.5284568071365356, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 35840, "num_agent_steps_sampled": 35837, "num_steps_trained": 81920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 163840, "last_target_update_ts": 26624, "num_target_updates": 2}, "done": false, "episodes_total": 15100, "training_iteration": 20, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-14-42", "timestamp": 1651738482, "time_this_iter_s": 0.6161112785339355, "time_total_s": 14.42347502708435, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 14.42347502708435, "timesteps_since_restore": 81920, "iterations_since_restore": 20, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 4.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.639, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.014, "best_response": 0.014}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24276348112946566, "mean_inference_ms": 0.44474329078635366, "mean_action_processing_ms": 0.02828619970966598, "mean_env_wait_ms": 0.08362497316920209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 46080, "timesteps_this_iter": 4096, "agent_timesteps_total": 46077, "timers": {"load_time_ms": 0.129, "load_throughput": 31867685.372, "learn_time_ms": 6.39, "learn_throughput": 641027.935, "update_time_ms": 1.323}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.6583685874938965, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 46080, "num_agent_steps_sampled": 46077, "num_steps_trained": 122880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 245760, "last_target_update_ts": 36864, "num_target_updates": 3}, "done": false, "episodes_total": 19427, "training_iteration": 30, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-14-47", "timestamp": 1651738487, "time_this_iter_s": 0.5762231349945068, "time_total_s": 19.807032585144043, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 19.807032585144043, "timesteps_since_restore": 122880, "iterations_since_restore": 30, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.596, "episode_media": {}, "episodes_this_iter": 403, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.128, "best_response": 0.128}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23994753027197566, "mean_inference_ms": 0.4461890988530304, "mean_action_processing_ms": 0.028396070395972597, "mean_env_wait_ms": 0.0838779431408361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 56320, "timesteps_this_iter": 4096, "agent_timesteps_total": 56317, "timers": {"load_time_ms": 0.124, "load_throughput": 32943181.561, "learn_time_ms": 5.961, "learn_throughput": 687156.287, "update_time_ms": 1.399}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.6209134459495544, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 56320, "num_agent_steps_sampled": 56317, "num_steps_trained": 163840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 327680, "last_target_update_ts": 47104, "num_target_updates": 4}, "done": false, "episodes_total": 23334, "training_iteration": 40, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-14-52", "timestamp": 1651738492, "time_this_iter_s": 0.4673774242401123, "time_total_s": 25.14414095878601, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 25.14414095878601, "timesteps_since_restore": 163840, "iterations_since_restore": 40, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.469, "episode_media": {}, "episodes_this_iter": 417, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.17, "best_response": 0.17}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2405769559446349, "mean_inference_ms": 0.44830028991465337, "mean_action_processing_ms": 0.028559494457332163, "mean_env_wait_ms": 0.08429835688587282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 66560, "timesteps_this_iter": 4096, "agent_timesteps_total": 66557, "timers": {"load_time_ms": 0.131, "load_throughput": 31298723.236, "learn_time_ms": 5.911, "learn_throughput": 692912.683, "update_time_ms": 1.376}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.6352162957191467, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 66560, "num_agent_steps_sampled": 66557, "num_steps_trained": 204800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 409600, "last_target_update_ts": 57344, "num_target_updates": 5}, "done": false, "episodes_total": 27482, "training_iteration": 50, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-14-58", "timestamp": 1651738498, "time_this_iter_s": 0.46687841415405273, "time_total_s": 30.560817003250122, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 30.560817003250122, "timesteps_since_restore": 204800, "iterations_since_restore": 50, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.604, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.144, "best_response": 0.144}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24114968506255807, "mean_inference_ms": 0.45058766571428976, "mean_action_processing_ms": 0.028723351042353344, "mean_env_wait_ms": 0.08476896436013942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76800, "timesteps_this_iter": 4096, "agent_timesteps_total": 76797, "timers": {"load_time_ms": 0.129, "load_throughput": 31802793.75, "learn_time_ms": 5.9, "learn_throughput": 694214.666, "update_time_ms": 1.429}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7175250053405762, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76797, "num_steps_trained": 245760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 491520, "last_target_update_ts": 67584, "num_target_updates": 6}, "done": false, "episodes_total": 31542, "training_iteration": 60, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-03", "timestamp": 1651738503, "time_this_iter_s": 0.47968554496765137, "time_total_s": 35.933595418930054, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 35.933595418930054, "timesteps_since_restore": 245760, "iterations_since_restore": 60, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 4.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.663, "episode_media": {}, "episodes_this_iter": 386, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.176, "best_response": 0.176}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24037042760213126, "mean_inference_ms": 0.45234077642481074, "mean_action_processing_ms": 0.028857271855172235, "mean_env_wait_ms": 0.08507884023933221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 87040, "timesteps_this_iter": 4096, "agent_timesteps_total": 87039, "timers": {"load_time_ms": 0.134, "load_throughput": 30661911.804, "learn_time_ms": 6.288, "learn_throughput": 651438.605, "update_time_ms": 1.323}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.6903405785560608, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 87040, "num_agent_steps_sampled": 87039, "num_steps_trained": 286720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 573440, "last_target_update_ts": 77824, "num_target_updates": 7}, "done": false, "episodes_total": 35398, "training_iteration": 70, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-09", "timestamp": 1651738509, "time_this_iter_s": 0.6992602348327637, "time_total_s": 41.56063413619995, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 41.56063413619995, "timesteps_since_restore": 286720, "iterations_since_restore": 70, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 4.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.502, "episode_media": {}, "episodes_this_iter": 404, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.079, "best_response": 0.079}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2400752052122602, "mean_inference_ms": 0.45274739194288544, "mean_action_processing_ms": 0.028860767846283338, "mean_env_wait_ms": 0.08511710976560352, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 97280, "timesteps_this_iter": 4096, "agent_timesteps_total": 97277, "timers": {"load_time_ms": 0.136, "load_throughput": 30166583.291, "learn_time_ms": 6.695, "learn_throughput": 611772.951, "update_time_ms": 1.393}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.6728922128677368, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 97280, "num_agent_steps_sampled": 97277, "num_steps_trained": 327680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 655360, "last_target_update_ts": 88064, "num_target_updates": 8}, "done": false, "episodes_total": 39463, "training_iteration": 80, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-14", "timestamp": 1651738514, "time_this_iter_s": 0.43397068977355957, "time_total_s": 46.96350312232971, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 46.96350312232971, "timesteps_since_restore": 327680, "iterations_since_restore": 80, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.652, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.089, "best_response": 0.089}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23983423468842088, "mean_inference_ms": 0.454136712869648, "mean_action_processing_ms": 0.028946870511634644, "mean_env_wait_ms": 0.08532244522249922, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 107520, "timesteps_this_iter": 4096, "agent_timesteps_total": 107518, "timers": {"load_time_ms": 0.141, "load_throughput": 29098694.417, "learn_time_ms": 6.24, "learn_throughput": 656439.274, "update_time_ms": 1.339}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7674023509025574, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 107520, "num_agent_steps_sampled": 107518, "num_steps_trained": 368640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 737280, "last_target_update_ts": 98304, "num_target_updates": 9}, "done": false, "episodes_total": 43375, "training_iteration": 90, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-20", "timestamp": 1651738520, "time_this_iter_s": 0.4777817726135254, "time_total_s": 52.87031030654907, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 52.87031030654907, "timesteps_since_restore": 368640, "iterations_since_restore": 90, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.508, "episode_media": {}, "episodes_this_iter": 412, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.202, "best_response": 0.202}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24000033907783558, "mean_inference_ms": 0.4570930952934763, "mean_action_processing_ms": 0.028994887983459998, "mean_env_wait_ms": 0.08546991310015087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 117760, "timesteps_this_iter": 4096, "agent_timesteps_total": 117757, "timers": {"load_time_ms": 0.133, "load_throughput": 30694781.461, "learn_time_ms": 6.106, "learn_throughput": 670810.882, "update_time_ms": 1.401}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7468034029006958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 117760, "num_agent_steps_sampled": 117757, "num_steps_trained": 409600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 819200, "last_target_update_ts": 108544, "num_target_updates": 10}, "done": false, "episodes_total": 47433, "training_iteration": 100, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-26", "timestamp": 1651738526, "time_this_iter_s": 0.7853090763092041, "time_total_s": 58.819843769073486, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 58.819843769073486, "timesteps_since_restore": 409600, "iterations_since_restore": 100, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.65, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.128, "best_response": 0.128}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23918700667414033, "mean_inference_ms": 0.45638173841904905, "mean_action_processing_ms": 0.028983036257030817, "mean_env_wait_ms": 0.0854194704634005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 128000, "timesteps_this_iter": 4096, "agent_timesteps_total": 127997, "timers": {"load_time_ms": 0.13, "load_throughput": 31557437.884, "learn_time_ms": 5.731, "learn_throughput": 714711.147, "update_time_ms": 1.367}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7567338943481445, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 127997, "num_steps_trained": 450560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 901120, "last_target_update_ts": 118784, "num_target_updates": 11}, "done": false, "episodes_total": 51340, "training_iteration": 110, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-32", "timestamp": 1651738532, "time_this_iter_s": 0.7311756610870361, "time_total_s": 64.30738353729248, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 64.30738353729248, "timesteps_since_restore": 450560, "iterations_since_restore": 110, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.653, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.166, "best_response": 0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23862339110005823, "mean_inference_ms": 0.4554530021995703, "mean_action_processing_ms": 0.02894923890365047, "mean_env_wait_ms": 0.08532316878691688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 138240, "timesteps_this_iter": 4096, "agent_timesteps_total": 138237, "timers": {"load_time_ms": 0.134, "load_throughput": 30541989.66, "learn_time_ms": 5.556, "learn_throughput": 737225.863, "update_time_ms": 1.3}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7707833647727966, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 138240, "num_agent_steps_sampled": 138237, "num_steps_trained": 491520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 983040, "last_target_update_ts": 129024, "num_target_updates": 12}, "done": false, "episodes_total": 55338, "training_iteration": 120, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-37", "timestamp": 1651738537, "time_this_iter_s": 0.4257383346557617, "time_total_s": 69.41269516944885, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 69.41269516944885, "timesteps_since_restore": 491520, "iterations_since_restore": 120, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 4.8}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.525, "episode_media": {}, "episodes_this_iter": 401, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.148, "best_response": 0.148}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2385649331962623, "mean_inference_ms": 0.45587365325953894, "mean_action_processing_ms": 0.028956312939475384, "mean_env_wait_ms": 0.0853649655600927, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148480, "timesteps_this_iter": 4096, "agent_timesteps_total": 148477, "timers": {"load_time_ms": 0.134, "load_throughput": 30552852.897, "learn_time_ms": 6.271, "learn_throughput": 653154.944, "update_time_ms": 1.368}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7656188011169434, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 148480, "num_agent_steps_sampled": 148477, "num_steps_trained": 532480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1064960, "last_target_update_ts": 139264, "num_target_updates": 13}, "done": false, "episodes_total": 59347, "training_iteration": 130, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-43", "timestamp": 1651738543, "time_this_iter_s": 0.4909546375274658, "time_total_s": 75.16781330108643, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 75.16781330108643, "timesteps_since_restore": 532480, "iterations_since_restore": 130, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 4.8}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.521, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.143, "best_response": 0.143}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23844273306890806, "mean_inference_ms": 0.456074616523281, "mean_action_processing_ms": 0.028981476172905217, "mean_env_wait_ms": 0.08541781920764957, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 158720, "timesteps_this_iter": 4096, "agent_timesteps_total": 158717, "timers": {"load_time_ms": 0.128, "load_throughput": 31968494.946, "learn_time_ms": 5.781, "learn_throughput": 708483.273, "update_time_ms": 1.306}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7937495112419128, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 158720, "num_agent_steps_sampled": 158717, "num_steps_trained": 573440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1146880, "last_target_update_ts": 149504, "num_target_updates": 14}, "done": false, "episodes_total": 63328, "training_iteration": 140, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-49", "timestamp": 1651738549, "time_this_iter_s": 0.4275672435760498, "time_total_s": 80.83321833610535, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 80.83321833610535, "timesteps_since_restore": 573440, "iterations_since_restore": 140, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 4.8}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.66, "episode_media": {}, "episodes_this_iter": 389, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.137, "best_response": 0.137}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23890097668891253, "mean_inference_ms": 0.4567283985437749, "mean_action_processing_ms": 0.029055425225395642, "mean_env_wait_ms": 0.08560463468647304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 168960, "timesteps_this_iter": 4096, "agent_timesteps_total": 168957, "timers": {"load_time_ms": 0.129, "load_throughput": 31685483.556, "learn_time_ms": 5.885, "learn_throughput": 695963.913, "update_time_ms": 1.322}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8249207139015198, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 168960, "num_agent_steps_sampled": 168957, "num_steps_trained": 614400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1228800, "last_target_update_ts": 159744, "num_target_updates": 15}, "done": false, "episodes_total": 67354, "training_iteration": 150, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-15-54", "timestamp": 1651738554, "time_this_iter_s": 0.47400760650634766, "time_total_s": 86.3655138015747, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 86.3655138015747, "timesteps_since_restore": 614400, "iterations_since_restore": 150, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.579, "episode_media": {}, "episodes_this_iter": 378, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.149, "best_response": 0.149}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23951678041177193, "mean_inference_ms": 0.45788452846828176, "mean_action_processing_ms": 0.029110333942390768, "mean_env_wait_ms": 0.08578048439626747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 179200, "timesteps_this_iter": 4096, "agent_timesteps_total": 179197, "timers": {"load_time_ms": 0.131, "load_throughput": 31355848.118, "learn_time_ms": 6.084, "learn_throughput": 673221.384, "update_time_ms": 1.325}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8209249377250671, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 179200, "num_agent_steps_sampled": 179197, "num_steps_trained": 655360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1310720, "last_target_update_ts": 169984, "num_target_updates": 16}, "done": false, "episodes_total": 71380, "training_iteration": 160, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-00", "timestamp": 1651738560, "time_this_iter_s": 0.4470651149749756, "time_total_s": 91.83294558525085, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 91.83294558525085, "timesteps_since_restore": 655360, "iterations_since_restore": 160, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 4.9}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.648, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.259, "best_response": 0.259}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2393965909304826, "mean_inference_ms": 0.458369729005916, "mean_action_processing_ms": 0.029176738938750234, "mean_env_wait_ms": 0.08589459337159956, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 189440, "timesteps_this_iter": 4096, "agent_timesteps_total": 189438, "timers": {"load_time_ms": 0.13, "load_throughput": 31418926.818, "learn_time_ms": 5.856, "learn_throughput": 699477.594, "update_time_ms": 1.327}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7802860140800476, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 189440, "num_agent_steps_sampled": 189438, "num_steps_trained": 696320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1392640, "last_target_update_ts": 180224, "num_target_updates": 17}, "done": false, "episodes_total": 75226, "training_iteration": 170, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-05", "timestamp": 1651738565, "time_this_iter_s": 0.4613478183746338, "time_total_s": 97.28847217559814, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 97.28847217559814, "timesteps_since_restore": 696320, "iterations_since_restore": 170, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 4.9}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.582, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.082, "best_response": 0.082}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2389336517602741, "mean_inference_ms": 0.4576824153485962, "mean_action_processing_ms": 0.02911230047712012, "mean_env_wait_ms": 0.0857649919229099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 199680, "timesteps_this_iter": 4096, "agent_timesteps_total": 199679, "timers": {"load_time_ms": 0.129, "load_throughput": 31679640.76, "learn_time_ms": 6.159, "learn_throughput": 665015.181, "update_time_ms": 1.282}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8094437122344971, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 199680, "num_agent_steps_sampled": 199679, "num_steps_trained": 737280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1474560, "last_target_update_ts": 190464, "num_target_updates": 18}, "done": false, "episodes_total": 79252, "training_iteration": 180, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-11", "timestamp": 1651738571, "time_this_iter_s": 0.9137723445892334, "time_total_s": 103.08205533027649, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 103.08205533027649, "timesteps_since_restore": 737280, "iterations_since_restore": 180, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.0}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.52, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.212, "best_response": 0.212}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23842083972375946, "mean_inference_ms": 0.4571979668758809, "mean_action_processing_ms": 0.029088210553518196, "mean_env_wait_ms": 0.08567724772059367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 209920, "timesteps_this_iter": 4096, "agent_timesteps_total": 209918, "timers": {"load_time_ms": 0.13, "load_throughput": 31390223.249, "learn_time_ms": 6.179, "learn_throughput": 662887.991, "update_time_ms": 1.365}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8779646754264832, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 209920, "num_agent_steps_sampled": 209918, "num_steps_trained": 778240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1556480, "last_target_update_ts": 200704, "num_target_updates": 19}, "done": false, "episodes_total": 83196, "training_iteration": 190, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-17", "timestamp": 1651738577, "time_this_iter_s": 0.9014396667480469, "time_total_s": 108.55621123313904, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 108.55621123313904, "timesteps_since_restore": 778240, "iterations_since_restore": 190, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.45, "ram_util_percent": 5.0}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.682, "episode_media": {}, "episodes_this_iter": 381, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.205, "best_response": 0.205}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23805275804464776, "mean_inference_ms": 0.45662581253930445, "mean_action_processing_ms": 0.02908559427692439, "mean_env_wait_ms": 0.0856553649131768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 220160, "timesteps_this_iter": 4096, "agent_timesteps_total": 220156, "timers": {"load_time_ms": 0.143, "load_throughput": 28704877.5, "learn_time_ms": 6.277, "learn_throughput": 652549.604, "update_time_ms": 1.333}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8184266090393066, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 220160, "num_agent_steps_sampled": 220156, "num_steps_trained": 819200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1638400, "last_target_update_ts": 210944, "num_target_updates": 20}, "done": false, "episodes_total": 87109, "training_iteration": 200, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-22", "timestamp": 1651738582, "time_this_iter_s": 0.9314980506896973, "time_total_s": 114.15049147605896, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 114.15049147605896, "timesteps_since_restore": 819200, "iterations_since_restore": 200, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 5.0}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.642, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.173, "best_response": 0.173}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23813540506771405, "mean_inference_ms": 0.45716908066768897, "mean_action_processing_ms": 0.029058634849053345, "mean_env_wait_ms": 0.08558580931241298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 230400, "timesteps_this_iter": 4096, "agent_timesteps_total": 230398, "timers": {"load_time_ms": 0.13, "load_throughput": 31464961.875, "learn_time_ms": 6.155, "learn_throughput": 665468.55, "update_time_ms": 1.328}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8306101560592651, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 230398, "num_steps_trained": 860160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1720320, "last_target_update_ts": 221184, "num_target_updates": 21}, "done": false, "episodes_total": 91090, "training_iteration": 210, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-28", "timestamp": 1651738588, "time_this_iter_s": 0.5237925052642822, "time_total_s": 119.41441655158997, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 119.41441655158997, "timesteps_since_restore": 860160, "iterations_since_restore": 210, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.0}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.49, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.215, "best_response": 0.215}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23766833367095963, "mean_inference_ms": 0.4565563076911684, "mean_action_processing_ms": 0.02900787037775959, "mean_env_wait_ms": 0.08546054662170678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 240640, "timesteps_this_iter": 4096, "agent_timesteps_total": 240636, "timers": {"load_time_ms": 0.129, "load_throughput": 31779262.272, "learn_time_ms": 6.396, "learn_throughput": 640356.529, "update_time_ms": 1.379}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7929405570030212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 240640, "num_agent_steps_sampled": 240636, "num_steps_trained": 901120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1802240, "last_target_update_ts": 231424, "num_target_updates": 22}, "done": false, "episodes_total": 95128, "training_iteration": 220, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-33", "timestamp": 1651738593, "time_this_iter_s": 0.5010192394256592, "time_total_s": 125.02457404136658, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 125.02457404136658, "timesteps_since_restore": 901120, "iterations_since_restore": 220, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 5.1}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.502, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.188, "best_response": 0.188}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2373921760509587, "mean_inference_ms": 0.4563879561551591, "mean_action_processing_ms": 0.02900860166939785, "mean_env_wait_ms": 0.08545695669047604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 250880, "timesteps_this_iter": 4096, "agent_timesteps_total": 250880, "timers": {"load_time_ms": 0.135, "load_throughput": 30390711.452, "learn_time_ms": 6.35, "learn_throughput": 645057.06, "update_time_ms": 1.38}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8151299357414246, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 250880, "num_agent_steps_sampled": 250880, "num_steps_trained": 942080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1884160, "last_target_update_ts": 241664, "num_target_updates": 23}, "done": false, "episodes_total": 99078, "training_iteration": 230, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-39", "timestamp": 1651738599, "time_this_iter_s": 0.4395730495452881, "time_total_s": 130.73638033866882, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 130.73638033866882, "timesteps_since_restore": 942080, "iterations_since_restore": 230, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.1}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.646, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.168, "best_response": 0.168}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23741892782715907, "mean_inference_ms": 0.4564547917763267, "mean_action_processing_ms": 0.029036871306326383, "mean_env_wait_ms": 0.08552527046364876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 261120, "timesteps_this_iter": 4096, "agent_timesteps_total": 261117, "timers": {"load_time_ms": 0.135, "load_throughput": 30342404.069, "learn_time_ms": 6.234, "learn_throughput": 657056.882, "update_time_ms": 1.247}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8188822269439697, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 261120, "num_agent_steps_sampled": 261117, "num_steps_trained": 983040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1966080, "last_target_update_ts": 251904, "num_target_updates": 24}, "done": false, "episodes_total": 103035, "training_iteration": 240, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-44", "timestamp": 1651738604, "time_this_iter_s": 0.4900491237640381, "time_total_s": 136.0125608444214, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 136.0125608444214, "timesteps_since_restore": 983040, "iterations_since_restore": 240, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 5.1}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.497, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.146, "best_response": 0.146}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23734470133041335, "mean_inference_ms": 0.45646855892466354, "mean_action_processing_ms": 0.029020535296720888, "mean_env_wait_ms": 0.08549440495171044, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 271360, "timesteps_this_iter": 4096, "agent_timesteps_total": 271357, "timers": {"load_time_ms": 0.126, "load_throughput": 32624134.417, "learn_time_ms": 6.324, "learn_throughput": 647720.113, "update_time_ms": 1.424}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8169124722480774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 271360, "num_agent_steps_sampled": 271357, "num_steps_trained": 1024000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2048000, "last_target_update_ts": 262144, "num_target_updates": 25}, "done": false, "episodes_total": 107103, "training_iteration": 250, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-50", "timestamp": 1651738610, "time_this_iter_s": 0.4713914394378662, "time_total_s": 141.78147292137146, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 141.78147292137146, "timesteps_since_restore": 1024000, "iterations_since_restore": 250, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.1}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.503, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.246, "best_response": 0.246}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23753350899991996, "mean_inference_ms": 0.4569373968225761, "mean_action_processing_ms": 0.02905707661983827, "mean_env_wait_ms": 0.0855877371550249, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 281600, "timesteps_this_iter": 4096, "agent_timesteps_total": 281598, "timers": {"load_time_ms": 0.129, "load_throughput": 31820465.242, "learn_time_ms": 6.4, "learn_throughput": 640003.471, "update_time_ms": 1.418}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7806004285812378, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 281600, "num_agent_steps_sampled": 281598, "num_steps_trained": 1064960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2129920, "last_target_update_ts": 272384, "num_target_updates": 26}, "done": false, "episodes_total": 111098, "training_iteration": 260, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-16-56", "timestamp": 1651738616, "time_this_iter_s": 1.1120378971099854, "time_total_s": 147.78608560562134, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 147.78608560562134, "timesteps_since_restore": 1064960, "iterations_since_restore": 260, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.507, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.026, "best_response": 0.026}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23779203192781395, "mean_inference_ms": 0.4573236399459624, "mean_action_processing_ms": 0.029084582744599515, "mean_env_wait_ms": 0.08567191938073837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 291840, "timesteps_this_iter": 4096, "agent_timesteps_total": 291838, "timers": {"load_time_ms": 0.129, "load_throughput": 31849961.409, "learn_time_ms": 6.095, "learn_throughput": 672036.316, "update_time_ms": 1.408}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.7910116314888, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 291840, "num_agent_steps_sampled": 291838, "num_steps_trained": 1105920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2211840, "last_target_update_ts": 282624, "num_target_updates": 27}, "done": false, "episodes_total": 115139, "training_iteration": 270, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-02", "timestamp": 1651738622, "time_this_iter_s": 0.48891353607177734, "time_total_s": 153.2608983516693, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 153.2608983516693, "timesteps_since_restore": 1105920, "iterations_since_restore": 270, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.485, "episode_media": {}, "episodes_this_iter": 415, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.098, "best_response": 0.098}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23765059516303869, "mean_inference_ms": 0.45716092691044796, "mean_action_processing_ms": 0.029080163361062308, "mean_env_wait_ms": 0.0856500835465747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 302080, "timesteps_this_iter": 4096, "agent_timesteps_total": 302078, "timers": {"load_time_ms": 0.129, "load_throughput": 31744030.273, "learn_time_ms": 5.944, "learn_throughput": 689074.563, "update_time_ms": 1.411}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8114829659461975, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 302080, "num_agent_steps_sampled": 302078, "num_steps_trained": 1146880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2293760, "last_target_update_ts": 292864, "num_target_updates": 28}, "done": false, "episodes_total": 119108, "training_iteration": 280, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-08", "timestamp": 1651738628, "time_this_iter_s": 1.0896217823028564, "time_total_s": 159.15454411506653, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 159.15454411506653, "timesteps_since_restore": 1146880, "iterations_since_restore": 280, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.15, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.525, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.059, "best_response": 0.059}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23779020242137733, "mean_inference_ms": 0.4572600058504837, "mean_action_processing_ms": 0.029087479373391695, "mean_env_wait_ms": 0.08569558387810619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 312320, "timesteps_this_iter": 4096, "agent_timesteps_total": 312318, "timers": {"load_time_ms": 0.136, "load_throughput": 30177181.071, "learn_time_ms": 6.422, "learn_throughput": 637855.378, "update_time_ms": 1.364}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8482877016067505, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 312320, "num_agent_steps_sampled": 312318, "num_steps_trained": 1187840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2375680, "last_target_update_ts": 303104, "num_target_updates": 29}, "done": false, "episodes_total": 123200, "training_iteration": 290, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-13", "timestamp": 1651738633, "time_this_iter_s": 0.48695921897888184, "time_total_s": 164.65878796577454, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 164.65878796577454, "timesteps_since_restore": 1187840, "iterations_since_restore": 290, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 9.0, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.501, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.136, "best_response": 0.136}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23776436142313004, "mean_inference_ms": 0.4569771313619184, "mean_action_processing_ms": 0.02907793781989094, "mean_env_wait_ms": 0.08566757789715983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 322560, "timesteps_this_iter": 4096, "agent_timesteps_total": 322558, "timers": {"load_time_ms": 0.136, "load_throughput": 30018992.109, "learn_time_ms": 6.72, "learn_throughput": 609532.955, "update_time_ms": 1.435}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8467575311660767, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 322560, "num_agent_steps_sampled": 322558, "num_steps_trained": 1228800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2457600, "last_target_update_ts": 313344, "num_target_updates": 30}, "done": false, "episodes_total": 127318, "training_iteration": 300, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-19", "timestamp": 1651738639, "time_this_iter_s": 0.47431159019470215, "time_total_s": 169.99399137496948, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 169.99399137496948, "timesteps_since_restore": 1228800, "iterations_since_restore": 300, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.8, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.664, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.16, "best_response": 0.16}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23780580043450428, "mean_inference_ms": 0.45710846314216463, "mean_action_processing_ms": 0.029114071302666012, "mean_env_wait_ms": 0.0857393206109156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 332800, "timesteps_this_iter": 4096, "agent_timesteps_total": 332796, "timers": {"load_time_ms": 0.132, "load_throughput": 30999403.075, "learn_time_ms": 5.923, "learn_throughput": 691587.733, "update_time_ms": 1.383}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8551737070083618, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 332800, "num_agent_steps_sampled": 332796, "num_steps_trained": 1269760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2539520, "last_target_update_ts": 323584, "num_target_updates": 31}, "done": false, "episodes_total": 131178, "training_iteration": 310, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-25", "timestamp": 1651738645, "time_this_iter_s": 1.1391088962554932, "time_total_s": 175.9514832496643, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 175.9514832496643, "timesteps_since_restore": 1269760, "iterations_since_restore": 310, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.45, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.515, "episode_media": {}, "episodes_this_iter": 407, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.138, "best_response": 0.138}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23776059297266144, "mean_inference_ms": 0.45819151849422984, "mean_action_processing_ms": 0.029102987478457826, "mean_env_wait_ms": 0.08572265521117689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 343040, "timesteps_this_iter": 4096, "agent_timesteps_total": 343037, "timers": {"load_time_ms": 0.13, "load_throughput": 31395959.766, "learn_time_ms": 6.021, "learn_throughput": 680283.091, "update_time_ms": 1.283}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8873932361602783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 343040, "num_agent_steps_sampled": 343037, "num_steps_trained": 1310720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2621440, "last_target_update_ts": 333824, "num_target_updates": 32}, "done": false, "episodes_total": 135196, "training_iteration": 320, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-31", "timestamp": 1651738651, "time_this_iter_s": 0.4493539333343506, "time_total_s": 181.68957686424255, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 181.68957686424255, "timesteps_since_restore": 1310720, "iterations_since_restore": 320, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.648, "episode_media": {}, "episodes_this_iter": 394, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.144, "best_response": 0.144}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23774366702810898, "mean_inference_ms": 0.45784853470147313, "mean_action_processing_ms": 0.029106843573538977, "mean_env_wait_ms": 0.08573468004027075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 353280, "timesteps_this_iter": 4096, "agent_timesteps_total": 353278, "timers": {"load_time_ms": 0.128, "load_throughput": 31897269.187, "learn_time_ms": 6.225, "learn_throughput": 658008.158, "update_time_ms": 1.364}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8828977346420288, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 353280, "num_agent_steps_sampled": 353278, "num_steps_trained": 1351680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2703360, "last_target_update_ts": 344064, "num_target_updates": 33}, "done": false, "episodes_total": 139248, "training_iteration": 330, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-36", "timestamp": 1651738656, "time_this_iter_s": 0.48102760314941406, "time_total_s": 187.1337296962738, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 187.1337296962738, "timesteps_since_restore": 1351680, "iterations_since_restore": 330, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.499, "episode_media": {}, "episodes_this_iter": 415, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.053, "best_response": 0.053}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23774114555507173, "mean_inference_ms": 0.4581588687851745, "mean_action_processing_ms": 0.029114577161939374, "mean_env_wait_ms": 0.08574745906480807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 363520, "timesteps_this_iter": 4096, "agent_timesteps_total": 363518, "timers": {"load_time_ms": 0.129, "load_throughput": 31650459.071, "learn_time_ms": 5.836, "learn_throughput": 701872.321, "update_time_ms": 1.292}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8797799944877625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 363520, "num_agent_steps_sampled": 363518, "num_steps_trained": 1392640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2785280, "last_target_update_ts": 354304, "num_target_updates": 34}, "done": false, "episodes_total": 143254, "training_iteration": 340, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-42", "timestamp": 1651738662, "time_this_iter_s": 0.4382152557373047, "time_total_s": 192.62080025672913, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 192.62080025672913, "timesteps_since_restore": 1392640, "iterations_since_restore": 340, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.504, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.28, "best_response": 0.28}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2376808262868019, "mean_inference_ms": 0.45813341193936313, "mean_action_processing_ms": 0.02911784682575427, "mean_env_wait_ms": 0.0857617586286734, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 373760, "timesteps_this_iter": 4096, "agent_timesteps_total": 373758, "timers": {"load_time_ms": 0.136, "load_throughput": 30108428.293, "learn_time_ms": 6.28, "learn_throughput": 652259.736, "update_time_ms": 1.425}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.875350296497345, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 373760, "num_agent_steps_sampled": 373758, "num_steps_trained": 1433600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2867200, "last_target_update_ts": 364544, "num_target_updates": 35}, "done": false, "episodes_total": 147228, "training_iteration": 350, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-48", "timestamp": 1651738668, "time_this_iter_s": 0.489260196685791, "time_total_s": 198.93516039848328, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 198.93516039848328, "timesteps_since_restore": 1433600, "iterations_since_restore": 350, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.674, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.176, "best_response": 0.176}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2377236799001541, "mean_inference_ms": 0.4580425657807508, "mean_action_processing_ms": 0.029142860617318262, "mean_env_wait_ms": 0.08581779665494645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 384000, "timesteps_this_iter": 4096, "agent_timesteps_total": 383997, "timers": {"load_time_ms": 0.131, "load_throughput": 31327259.635, "learn_time_ms": 6.117, "learn_throughput": 669595.129, "update_time_ms": 1.426}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8648892641067505, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 383997, "num_steps_trained": 1474560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2949120, "last_target_update_ts": 374784, "num_target_updates": 36}, "done": false, "episodes_total": 151206, "training_iteration": 360, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-54", "timestamp": 1651738674, "time_this_iter_s": 0.4974043369293213, "time_total_s": 204.54678010940552, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 204.54678010940552, "timesteps_since_restore": 1474560, "iterations_since_restore": 360, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.501, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.188, "best_response": 0.188}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23804772050687653, "mean_inference_ms": 0.45881162916618223, "mean_action_processing_ms": 0.029171770216045317, "mean_env_wait_ms": 0.08589388685159631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 394240, "timesteps_this_iter": 4096, "agent_timesteps_total": 394237, "timers": {"load_time_ms": 0.13, "load_throughput": 31499576.795, "learn_time_ms": 5.778, "learn_throughput": 708948.132, "update_time_ms": 1.358}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9280972480773926, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 394240, "num_agent_steps_sampled": 394237, "num_steps_trained": 1515520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3031040, "last_target_update_ts": 385024, "num_target_updates": 37}, "done": false, "episodes_total": 155245, "training_iteration": 370, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-17-59", "timestamp": 1651738679, "time_this_iter_s": 0.4339015483856201, "time_total_s": 210.2020947933197, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 210.2020947933197, "timesteps_since_restore": 1515520, "iterations_since_restore": 370, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.546, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.232, "best_response": 0.232}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23834351608178295, "mean_inference_ms": 0.459385758694522, "mean_action_processing_ms": 0.029200300419483786, "mean_env_wait_ms": 0.08600756403465198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 404480, "timesteps_this_iter": 4096, "agent_timesteps_total": 404477, "timers": {"load_time_ms": 0.13, "load_throughput": 31627152.401, "learn_time_ms": 6.258, "learn_throughput": 654518.582, "update_time_ms": 1.393}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9176199436187744, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 404480, "num_agent_steps_sampled": 404477, "num_steps_trained": 1556480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3112960, "last_target_update_ts": 395264, "num_target_updates": 38}, "done": false, "episodes_total": 159162, "training_iteration": 380, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-05", "timestamp": 1651738685, "time_this_iter_s": 0.48726511001586914, "time_total_s": 215.79682564735413, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 215.79682564735413, "timesteps_since_restore": 1556480, "iterations_since_restore": 380, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.656, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.185, "best_response": 0.185}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23823729173901528, "mean_inference_ms": 0.4589929877141881, "mean_action_processing_ms": 0.02921013835463836, "mean_env_wait_ms": 0.0860044384184103, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 414720, "timesteps_this_iter": 4096, "agent_timesteps_total": 414716, "timers": {"load_time_ms": 0.131, "load_throughput": 31264548.106, "learn_time_ms": 6.061, "learn_throughput": 675784.817, "update_time_ms": 1.481}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8981354832649231, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 414720, "num_agent_steps_sampled": 414716, "num_steps_trained": 1597440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3194880, "last_target_update_ts": 405504, "num_target_updates": 39}, "done": false, "episodes_total": 163124, "training_iteration": 390, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-11", "timestamp": 1651738691, "time_this_iter_s": 1.2150213718414307, "time_total_s": 221.9959728717804, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 221.9959728717804, "timesteps_since_restore": 1597440, "iterations_since_restore": 390, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.561, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.161, "best_response": 0.161}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23808181252903474, "mean_inference_ms": 0.4589576600939174, "mean_action_processing_ms": 0.029174973150578213, "mean_env_wait_ms": 0.08596116515027072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 424960, "timesteps_this_iter": 4096, "agent_timesteps_total": 424957, "timers": {"load_time_ms": 0.134, "load_throughput": 30520286.346, "learn_time_ms": 6.13, "learn_throughput": 668225.191, "update_time_ms": 1.442}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8855283856391907, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 424960, "num_agent_steps_sampled": 424957, "num_steps_trained": 1638400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3276800, "last_target_update_ts": 415744, "num_target_updates": 40}, "done": false, "episodes_total": 167168, "training_iteration": 400, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-17", "timestamp": 1651738697, "time_this_iter_s": 0.4502081871032715, "time_total_s": 227.64990735054016, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 227.64990735054016, "timesteps_since_restore": 1638400, "iterations_since_restore": 400, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.556, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.2, "best_response": 0.2}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23805045626335383, "mean_inference_ms": 0.45905634098727427, "mean_action_processing_ms": 0.029191343932848772, "mean_env_wait_ms": 0.085986234711405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 435200, "timesteps_this_iter": 4096, "agent_timesteps_total": 435196, "timers": {"load_time_ms": 0.141, "load_throughput": 29010248.538, "learn_time_ms": 6.159, "learn_throughput": 665064.095, "update_time_ms": 1.436}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.921758770942688, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 435200, "num_agent_steps_sampled": 435196, "num_steps_trained": 1679360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3358720, "last_target_update_ts": 425984, "num_target_updates": 41}, "done": false, "episodes_total": 171102, "training_iteration": 410, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-23", "timestamp": 1651738703, "time_this_iter_s": 0.46895337104797363, "time_total_s": 233.24645280838013, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 233.24645280838013, "timesteps_since_restore": 1679360, "iterations_since_restore": 410, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.501, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.206, "best_response": 0.206}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23813791576230012, "mean_inference_ms": 0.45922738245896366, "mean_action_processing_ms": 0.029216162438216068, "mean_env_wait_ms": 0.086001320295431, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 445440, "timesteps_this_iter": 4096, "agent_timesteps_total": 445436, "timers": {"load_time_ms": 0.13, "load_throughput": 31557437.884, "learn_time_ms": 5.997, "learn_throughput": 682965.843, "update_time_ms": 1.381}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8961653709411621, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 445440, "num_agent_steps_sampled": 445436, "num_steps_trained": 1720320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3440640, "last_target_update_ts": 436224, "num_target_updates": 42}, "done": false, "episodes_total": 175091, "training_iteration": 420, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-28", "timestamp": 1651738708, "time_this_iter_s": 0.4512510299682617, "time_total_s": 238.75925707817078, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 238.75925707817078, "timesteps_since_restore": 1720320, "iterations_since_restore": 420, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.529, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.167, "best_response": 0.167}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23832884162423074, "mean_inference_ms": 0.4591469505931244, "mean_action_processing_ms": 0.029196590924164944, "mean_env_wait_ms": 0.0859862160034517, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 455680, "timesteps_this_iter": 4096, "agent_timesteps_total": 455678, "timers": {"load_time_ms": 0.13, "load_throughput": 31493802.354, "learn_time_ms": 5.925, "learn_throughput": 691317.787, "update_time_ms": 1.287}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9440126419067383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 455680, "num_agent_steps_sampled": 455678, "num_steps_trained": 1761280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3522560, "last_target_update_ts": 446464, "num_target_updates": 43}, "done": false, "episodes_total": 179178, "training_iteration": 430, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-34", "timestamp": 1651738714, "time_this_iter_s": 0.5436229705810547, "time_total_s": 244.55721759796143, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 244.55721759796143, "timesteps_since_restore": 1761280, "iterations_since_restore": 430, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.655, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.136, "best_response": 0.136}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23839894116601384, "mean_inference_ms": 0.4591297691150948, "mean_action_processing_ms": 0.029208889921705852, "mean_env_wait_ms": 0.0860071802365444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 465920, "timesteps_this_iter": 4096, "agent_timesteps_total": 465917, "timers": {"load_time_ms": 0.131, "load_throughput": 31350126.248, "learn_time_ms": 6.084, "learn_throughput": 673200.28, "update_time_ms": 1.312}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8596464991569519, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 465920, "num_agent_steps_sampled": 465917, "num_steps_trained": 1802240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3604480, "last_target_update_ts": 456704, "num_target_updates": 44}, "done": false, "episodes_total": 183067, "training_iteration": 440, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-40", "timestamp": 1651738720, "time_this_iter_s": 0.542863130569458, "time_total_s": 250.2768030166626, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 250.2768030166626, "timesteps_since_restore": 1802240, "iterations_since_restore": 440, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.558, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.198, "best_response": 0.198}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23838385322887023, "mean_inference_ms": 0.45932703410028364, "mean_action_processing_ms": 0.029190019042597277, "mean_env_wait_ms": 0.08599480418174031, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 476160, "timesteps_this_iter": 4096, "agent_timesteps_total": 476158, "timers": {"load_time_ms": 0.129, "load_throughput": 31656291.107, "learn_time_ms": 5.871, "learn_throughput": 697702.162, "update_time_ms": 1.329}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9326810240745544, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 476160, "num_agent_steps_sampled": 476158, "num_steps_trained": 1843200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3686400, "last_target_update_ts": 466944, "num_target_updates": 45}, "done": false, "episodes_total": 187114, "training_iteration": 450, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-46", "timestamp": 1651738726, "time_this_iter_s": 0.5132780075073242, "time_total_s": 256.08200669288635, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 256.08200669288635, "timesteps_since_restore": 1843200, "iterations_since_restore": 450, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.571, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.12, "best_response": 0.12}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23837386508818623, "mean_inference_ms": 0.4592401644960358, "mean_action_processing_ms": 0.02919838360328531, "mean_env_wait_ms": 0.08600061725016946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 486400, "timesteps_this_iter": 4096, "agent_timesteps_total": 486397, "timers": {"load_time_ms": 0.13, "load_throughput": 31453440.469, "learn_time_ms": 5.72, "learn_throughput": 716126.269, "update_time_ms": 1.366}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8498332500457764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 486400, "num_agent_steps_sampled": 486397, "num_steps_trained": 1884160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3768320, "last_target_update_ts": 477184, "num_target_updates": 46}, "done": false, "episodes_total": 191088, "training_iteration": 460, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-52", "timestamp": 1651738732, "time_this_iter_s": 0.5523386001586914, "time_total_s": 262.6397521495819, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 262.6397521495819, "timesteps_since_restore": 1884160, "iterations_since_restore": 460, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.673, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.107, "best_response": 0.107}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23849405305449606, "mean_inference_ms": 0.4592881143279609, "mean_action_processing_ms": 0.02923292188425949, "mean_env_wait_ms": 0.08606274987304845, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 496640, "timesteps_this_iter": 4096, "agent_timesteps_total": 496637, "timers": {"load_time_ms": 0.131, "load_throughput": 31373026.267, "learn_time_ms": 5.678, "learn_throughput": 721406.762, "update_time_ms": 1.33}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9011328220367432, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 496640, "num_agent_steps_sampled": 496637, "num_steps_trained": 1925120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3850240, "last_target_update_ts": 487424, "num_target_updates": 47}, "done": false, "episodes_total": 195021, "training_iteration": 470, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-18-58", "timestamp": 1651738738, "time_this_iter_s": 0.4336411952972412, "time_total_s": 268.17888593673706, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 268.17888593673706, "timesteps_since_restore": 1925120, "iterations_since_restore": 470, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.513, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.113, "best_response": 0.113}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23851130106345614, "mean_inference_ms": 0.4593429336672253, "mean_action_processing_ms": 0.02920916169632747, "mean_env_wait_ms": 0.08602188603549074, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 506880, "timesteps_this_iter": 4096, "agent_timesteps_total": 506878, "timers": {"load_time_ms": 0.133, "load_throughput": 30865736.946, "learn_time_ms": 6.091, "learn_throughput": 672449.299, "update_time_ms": 1.423}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.892955482006073, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 506880, "num_agent_steps_sampled": 506878, "num_steps_trained": 1966080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3932160, "last_target_update_ts": 497664, "num_target_updates": 48}, "done": false, "episodes_total": 199114, "training_iteration": 480, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-04", "timestamp": 1651738744, "time_this_iter_s": 0.5079436302185059, "time_total_s": 273.8445580005646, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 273.8445580005646, "timesteps_since_restore": 1966080, "iterations_since_restore": 480, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.678, "episode_media": {}, "episodes_this_iter": 387, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.157, "best_response": 0.157}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23845646568292528, "mean_inference_ms": 0.4589399007172675, "mean_action_processing_ms": 0.0292196230310731, "mean_env_wait_ms": 0.0860272979608236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 517120, "timesteps_this_iter": 4096, "agent_timesteps_total": 517117, "timers": {"load_time_ms": 0.137, "load_throughput": 29930085.686, "learn_time_ms": 6.112, "learn_throughput": 670180.232, "update_time_ms": 1.347}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8870821595191956, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 517120, "num_agent_steps_sampled": 517117, "num_steps_trained": 2007040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4014080, "last_target_update_ts": 507904, "num_target_updates": 49}, "done": false, "episodes_total": 203123, "training_iteration": 490, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-10", "timestamp": 1651738750, "time_this_iter_s": 0.4407634735107422, "time_total_s": 279.576810836792, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 279.576810836792, "timesteps_since_restore": 2007040, "iterations_since_restore": 490, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.498, "episode_media": {}, "episodes_this_iter": 407, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.189, "best_response": 0.189}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23833516482299294, "mean_inference_ms": 0.4591162212434954, "mean_action_processing_ms": 0.0291990258862176, "mean_env_wait_ms": 0.08598181193382308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 527360, "timesteps_this_iter": 4096, "agent_timesteps_total": 527358, "timers": {"load_time_ms": 0.129, "load_throughput": 31744030.273, "learn_time_ms": 6.103, "learn_throughput": 671138.451, "update_time_ms": 1.319}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.894341230392456, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 527360, "num_agent_steps_sampled": 527358, "num_steps_trained": 2048000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4096000, "last_target_update_ts": 518144, "num_target_updates": 50}, "done": false, "episodes_total": 207056, "training_iteration": 500, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-15", "timestamp": 1651738755, "time_this_iter_s": 0.4536585807800293, "time_total_s": 285.2487916946411, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 285.2487916946411, "timesteps_since_restore": 2048000, "iterations_since_restore": 500, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.656, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.167, "best_response": 0.167}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23814373779705036, "mean_inference_ms": 0.4585719595953593, "mean_action_processing_ms": 0.0291909524979952, "mean_env_wait_ms": 0.08595368977859462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 537600, "timesteps_this_iter": 4096, "agent_timesteps_total": 537598, "timers": {"load_time_ms": 0.13, "load_throughput": 31441927.496, "learn_time_ms": 5.85, "learn_throughput": 700207.422, "update_time_ms": 1.341}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9266918897628784, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 537600, "num_agent_steps_sampled": 537598, "num_steps_trained": 2088960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4177920, "last_target_update_ts": 528384, "num_target_updates": 51}, "done": false, "episodes_total": 210963, "training_iteration": 510, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-21", "timestamp": 1651738761, "time_this_iter_s": 0.44345521926879883, "time_total_s": 290.6695032119751, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 290.6695032119751, "timesteps_since_restore": 2088960, "iterations_since_restore": 510, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.672, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.262, "best_response": 0.262}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23797504323394394, "mean_inference_ms": 0.4583137440927828, "mean_action_processing_ms": 0.029178754149034616, "mean_env_wait_ms": 0.08592830342713235, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 547840, "timesteps_this_iter": 4096, "agent_timesteps_total": 547840, "timers": {"load_time_ms": 0.129, "load_throughput": 31814572.563, "learn_time_ms": 5.901, "learn_throughput": 694077.237, "update_time_ms": 1.385}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9203116297721863, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 547840, "num_agent_steps_sampled": 547840, "num_steps_trained": 2129920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4259840, "last_target_update_ts": 538624, "num_target_updates": 52}, "done": false, "episodes_total": 214929, "training_iteration": 520, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-26", "timestamp": 1651738766, "time_this_iter_s": 0.49242591857910156, "time_total_s": 296.2876284122467, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 296.2876284122467, "timesteps_since_restore": 2129920, "iterations_since_restore": 520, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.665, "episode_media": {}, "episodes_this_iter": 386, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.231, "best_response": 0.231}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.237914383277793, "mean_inference_ms": 0.45834453602349096, "mean_action_processing_ms": 0.029183136385911496, "mean_env_wait_ms": 0.08593653953549134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 558080, "timesteps_this_iter": 4096, "agent_timesteps_total": 558077, "timers": {"load_time_ms": 0.13, "load_throughput": 31441927.496, "learn_time_ms": 5.981, "learn_throughput": 684852.572, "update_time_ms": 1.379}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9124463796615601, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 558080, "num_agent_steps_sampled": 558077, "num_steps_trained": 2170880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4341760, "last_target_update_ts": 548864, "num_target_updates": 53}, "done": false, "episodes_total": 218846, "training_iteration": 530, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-32", "timestamp": 1651738772, "time_this_iter_s": 0.4949674606323242, "time_total_s": 301.9005215167999, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 301.9005215167999, "timesteps_since_restore": 2170880, "iterations_since_restore": 530, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.494, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.171, "best_response": 0.171}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23779821039880084, "mean_inference_ms": 0.458526833906974, "mean_action_processing_ms": 0.029164435369166478, "mean_env_wait_ms": 0.0858908383677717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 568320, "timesteps_this_iter": 4096, "agent_timesteps_total": 568316, "timers": {"load_time_ms": 0.13, "load_throughput": 31493802.354, "learn_time_ms": 6.302, "learn_throughput": 649972.162, "update_time_ms": 1.384}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8696169257164001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 568320, "num_agent_steps_sampled": 568316, "num_steps_trained": 2211840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4423680, "last_target_update_ts": 559104, "num_target_updates": 54}, "done": false, "episodes_total": 222839, "training_iteration": 540, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-38", "timestamp": 1651738778, "time_this_iter_s": 0.5475428104400635, "time_total_s": 307.5848882198334, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 307.5848882198334, "timesteps_since_restore": 2211840, "iterations_since_restore": 540, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.529, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.115, "best_response": 0.115}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2379252622879572, "mean_inference_ms": 0.458764120924493, "mean_action_processing_ms": 0.029162380391401104, "mean_env_wait_ms": 0.08590216799445471, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 578560, "timesteps_this_iter": 4096, "agent_timesteps_total": 578557, "timers": {"load_time_ms": 0.131, "load_throughput": 31264548.106, "learn_time_ms": 5.806, "learn_throughput": 705477.933, "update_time_ms": 1.272}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9233291149139404, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 578560, "num_agent_steps_sampled": 578557, "num_steps_trained": 2252800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4505600, "last_target_update_ts": 569344, "num_target_updates": 55}, "done": false, "episodes_total": 226746, "training_iteration": 550, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-44", "timestamp": 1651738784, "time_this_iter_s": 0.46662092208862305, "time_total_s": 313.3191947937012, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 313.3191947937012, "timesteps_since_restore": 2252800, "iterations_since_restore": 550, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.648, "episode_media": {}, "episodes_this_iter": 387, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.139, "best_response": 0.139}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23796031290028227, "mean_inference_ms": 0.45865945868588287, "mean_action_processing_ms": 0.029180523603285657, "mean_env_wait_ms": 0.08593371244243116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 588800, "timesteps_this_iter": 4096, "agent_timesteps_total": 588797, "timers": {"load_time_ms": 0.136, "load_throughput": 30092606.733, "learn_time_ms": 6.162, "learn_throughput": 664721.851, "update_time_ms": 1.358}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8913764357566833, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 588800, "num_agent_steps_sampled": 588797, "num_steps_trained": 2293760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4587520, "last_target_update_ts": 579584, "num_target_updates": 56}, "done": false, "episodes_total": 230712, "training_iteration": 560, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-51", "timestamp": 1651738791, "time_this_iter_s": 1.4426116943359375, "time_total_s": 320.109347820282, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 320.109347820282, "timesteps_since_restore": 2293760, "iterations_since_restore": 560, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.5, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.287, "best_response": 0.287}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23793205491041358, "mean_inference_ms": 0.458755907840856, "mean_action_processing_ms": 0.029169043801020735, "mean_env_wait_ms": 0.08591305772220786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 599040, "timesteps_this_iter": 4096, "agent_timesteps_total": 599039, "timers": {"load_time_ms": 0.13, "load_throughput": 31580641.882, "learn_time_ms": 5.752, "learn_throughput": 712039.241, "update_time_ms": 1.381}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9005915522575378, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 599040, "num_agent_steps_sampled": 599039, "num_steps_trained": 2334720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4669440, "last_target_update_ts": 589824, "num_target_updates": 57}, "done": false, "episodes_total": 234743, "training_iteration": 570, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-19-56", "timestamp": 1651738796, "time_this_iter_s": 1.3591938018798828, "time_total_s": 325.74786710739136, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 325.74786710739136, "timesteps_since_restore": 2334720, "iterations_since_restore": 570, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.533, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.159, "best_response": 0.159}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23768220803772824, "mean_inference_ms": 0.4585380341919953, "mean_action_processing_ms": 0.029156848967741966, "mean_env_wait_ms": 0.08588358204932689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 609280, "timesteps_this_iter": 4096, "agent_timesteps_total": 609277, "timers": {"load_time_ms": 0.131, "load_throughput": 31373026.267, "learn_time_ms": 6.031, "learn_throughput": 679132.111, "update_time_ms": 1.389}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9265182018280029, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 609280, "num_agent_steps_sampled": 609277, "num_steps_trained": 2375680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4751360, "last_target_update_ts": 600064, "num_target_updates": 58}, "done": false, "episodes_total": 238637, "training_iteration": 580, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-02", "timestamp": 1651738802, "time_this_iter_s": 0.480609655380249, "time_total_s": 331.4893870353699, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 331.4893870353699, "timesteps_since_restore": 2375680, "iterations_since_restore": 580, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.619, "episode_media": {}, "episodes_this_iter": 386, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.091, "best_response": 0.091}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23763066537669916, "mean_inference_ms": 0.458287845460029, "mean_action_processing_ms": 0.0291576310963437, "mean_env_wait_ms": 0.08588598230391097, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 619520, "timesteps_this_iter": 4096, "agent_timesteps_total": 619519, "timers": {"load_time_ms": 0.14, "load_throughput": 29192640.924, "learn_time_ms": 6.613, "learn_throughput": 619371.149, "update_time_ms": 1.43}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8991242051124573, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 619520, "num_agent_steps_sampled": 619519, "num_steps_trained": 2416640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4833280, "last_target_update_ts": 610304, "num_target_updates": 59}, "done": false, "episodes_total": 242692, "training_iteration": 590, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-08", "timestamp": 1651738808, "time_this_iter_s": 0.4608876705169678, "time_total_s": 337.2152361869812, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 337.2152361869812, "timesteps_since_restore": 2416640, "iterations_since_restore": 590, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.497, "episode_media": {}, "episodes_this_iter": 403, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.142, "best_response": 0.142}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23751453990057347, "mean_inference_ms": 0.45834556319588615, "mean_action_processing_ms": 0.029140701620045967, "mean_env_wait_ms": 0.08585330466128115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 629760, "timesteps_this_iter": 4096, "agent_timesteps_total": 629757, "timers": {"load_time_ms": 0.138, "load_throughput": 29753843.408, "learn_time_ms": 6.166, "learn_throughput": 664254.088, "update_time_ms": 1.448}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9043360352516174, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 629760, "num_agent_steps_sampled": 629757, "num_steps_trained": 2457600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4915200, "last_target_update_ts": 620544, "num_target_updates": 60}, "done": false, "episodes_total": 246640, "training_iteration": 600, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-14", "timestamp": 1651738814, "time_this_iter_s": 0.44863390922546387, "time_total_s": 342.82581639289856, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 342.82581639289856, "timesteps_since_restore": 2457600, "iterations_since_restore": 600, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.673, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.198, "best_response": 0.198}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2376230551711964, "mean_inference_ms": 0.4583982852982339, "mean_action_processing_ms": 0.029189024546533857, "mean_env_wait_ms": 0.08593745752062043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 640000, "timesteps_this_iter": 4096, "agent_timesteps_total": 639998, "timers": {"load_time_ms": 0.131, "load_throughput": 31179435.906, "learn_time_ms": 5.834, "learn_throughput": 702113.27, "update_time_ms": 1.403}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9339395761489868, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 639998, "num_steps_trained": 2498560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4997120, "last_target_update_ts": 630784, "num_target_updates": 61}, "done": false, "episodes_total": 250538, "training_iteration": 610, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-19", "timestamp": 1651738819, "time_this_iter_s": 0.45616841316223145, "time_total_s": 348.55642008781433, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 348.55642008781433, "timesteps_since_restore": 2498560, "iterations_since_restore": 610, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.575, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.186, "best_response": 0.186}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2375889577410967, "mean_inference_ms": 0.45854091736103214, "mean_action_processing_ms": 0.029166840921129113, "mean_env_wait_ms": 0.08592376882454045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 650240, "timesteps_this_iter": 4096, "agent_timesteps_total": 650237, "timers": {"load_time_ms": 0.137, "load_throughput": 29914450.956, "learn_time_ms": 6.287, "learn_throughput": 651554.724, "update_time_ms": 1.453}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9057420492172241, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 650240, "num_agent_steps_sampled": 650237, "num_steps_trained": 2539520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5079040, "last_target_update_ts": 641024, "num_target_updates": 62}, "done": false, "episodes_total": 254546, "training_iteration": 620, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-25", "timestamp": 1651738825, "time_this_iter_s": 0.5118069648742676, "time_total_s": 354.2961518764496, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 354.2961518764496, "timesteps_since_restore": 2539520, "iterations_since_restore": 620, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.512, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.085, "best_response": 0.085}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23777932619379172, "mean_inference_ms": 0.45891672081121876, "mean_action_processing_ms": 0.02919606969668929, "mean_env_wait_ms": 0.0859697816306626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 660480, "timesteps_this_iter": 4096, "agent_timesteps_total": 660478, "timers": {"load_time_ms": 0.139, "load_throughput": 29432703.759, "learn_time_ms": 5.986, "learn_throughput": 684252.482, "update_time_ms": 1.325}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8959440588951111, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 660480, "num_agent_steps_sampled": 660478, "num_steps_trained": 2580480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5160960, "last_target_update_ts": 651264, "num_target_updates": 63}, "done": false, "episodes_total": 258515, "training_iteration": 630, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-31", "timestamp": 1651738831, "time_this_iter_s": 0.4353749752044678, "time_total_s": 360.0570557117462, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 360.0570557117462, "timesteps_since_restore": 2580480, "iterations_since_restore": 630, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.515, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.203, "best_response": 0.203}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.237672254344804, "mean_inference_ms": 0.45875236281904436, "mean_action_processing_ms": 0.029189236004164513, "mean_env_wait_ms": 0.08594690230908852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 670720, "timesteps_this_iter": 4096, "agent_timesteps_total": 670718, "timers": {"load_time_ms": 0.131, "load_throughput": 31241806.117, "learn_time_ms": 5.714, "learn_throughput": 716849.393, "update_time_ms": 1.312}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9663631916046143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 670720, "num_agent_steps_sampled": 670718, "num_steps_trained": 2621440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5242880, "last_target_update_ts": 661504, "num_target_updates": 64}, "done": false, "episodes_total": 262456, "training_iteration": 640, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-37", "timestamp": 1651738837, "time_this_iter_s": 0.4602053165435791, "time_total_s": 365.61849665641785, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 365.61849665641785, "timesteps_since_restore": 2621440, "iterations_since_restore": 640, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.669, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.113, "best_response": 0.113}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2377155582801875, "mean_inference_ms": 0.45884858643372545, "mean_action_processing_ms": 0.029218155546206225, "mean_env_wait_ms": 0.08600620254918477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 680960, "timesteps_this_iter": 4096, "agent_timesteps_total": 680958, "timers": {"load_time_ms": 0.13, "load_throughput": 31592256.683, "learn_time_ms": 5.757, "learn_throughput": 711493.7, "update_time_ms": 1.372}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8832424879074097, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 680960, "num_agent_steps_sampled": 680958, "num_steps_trained": 2662400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5324800, "last_target_update_ts": 671744, "num_target_updates": 65}, "done": false, "episodes_total": 266392, "training_iteration": 650, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-43", "timestamp": 1651738843, "time_this_iter_s": 0.5560548305511475, "time_total_s": 371.4955155849457, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 371.4955155849457, "timesteps_since_restore": 2662400, "iterations_since_restore": 650, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.653, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.094, "best_response": 0.094}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2375185633700019, "mean_inference_ms": 0.4588738820747012, "mean_action_processing_ms": 0.029190062389881255, "mean_env_wait_ms": 0.08595254550927849, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 691200, "timesteps_this_iter": 4096, "agent_timesteps_total": 691197, "timers": {"load_time_ms": 0.131, "load_throughput": 31185095.633, "learn_time_ms": 6.048, "learn_throughput": 677298.088, "update_time_ms": 1.404}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9087345600128174, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 691200, "num_agent_steps_sampled": 691197, "num_steps_trained": 2703360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5406720, "last_target_update_ts": 681984, "num_target_updates": 66}, "done": false, "episodes_total": 270340, "training_iteration": 660, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-48", "timestamp": 1651738848, "time_this_iter_s": 0.44324398040771484, "time_total_s": 377.29241824150085, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 377.29241824150085, "timesteps_since_restore": 2703360, "iterations_since_restore": 660, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.682, "episode_media": {}, "episodes_this_iter": 380, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.193, "best_response": 0.193}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23736138703412257, "mean_inference_ms": 0.4586906335166539, "mean_action_processing_ms": 0.029189098123196103, "mean_env_wait_ms": 0.08593607571808301, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 701440, "timesteps_this_iter": 4096, "agent_timesteps_total": 701438, "timers": {"load_time_ms": 0.132, "load_throughput": 31128590.658, "learn_time_ms": 5.937, "learn_throughput": 689935.19, "update_time_ms": 1.363}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.935997724533081, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 701440, "num_agent_steps_sampled": 701438, "num_steps_trained": 2744320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5488640, "last_target_update_ts": 692224, "num_target_updates": 67}, "done": false, "episodes_total": 274180, "training_iteration": 670, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-20-54", "timestamp": 1651738854, "time_this_iter_s": 0.5010924339294434, "time_total_s": 382.91608715057373, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 382.91608715057373, "timesteps_since_restore": 2744320, "iterations_since_restore": 670, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.515, "episode_media": {}, "episodes_this_iter": 408, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.188, "best_response": 0.188}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23729136106655618, "mean_inference_ms": 0.45876742015306626, "mean_action_processing_ms": 0.029158293188269173, "mean_env_wait_ms": 0.08588728159744435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 711680, "timesteps_this_iter": 4096, "agent_timesteps_total": 711678, "timers": {"load_time_ms": 0.131, "load_throughput": 31253172.974, "learn_time_ms": 5.936, "learn_throughput": 690018.322, "update_time_ms": 1.36}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9052115082740784, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 711680, "num_agent_steps_sampled": 711678, "num_steps_trained": 2785280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5570560, "last_target_update_ts": 702464, "num_target_updates": 68}, "done": false, "episodes_total": 278235, "training_iteration": 680, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-00", "timestamp": 1651738860, "time_this_iter_s": 0.43937230110168457, "time_total_s": 388.596209526062, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 388.596209526062, "timesteps_since_restore": 2785280, "iterations_since_restore": 680, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.523, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.194, "best_response": 0.194}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23710700606778912, "mean_inference_ms": 0.4585260203566926, "mean_action_processing_ms": 0.02914933668027134, "mean_env_wait_ms": 0.08585339291769403, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 721920, "timesteps_this_iter": 4096, "agent_timesteps_total": 721919, "timers": {"load_time_ms": 0.129, "load_throughput": 31644629.184, "learn_time_ms": 5.869, "learn_throughput": 697855.203, "update_time_ms": 1.339}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8780794143676758, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 721920, "num_agent_steps_sampled": 721919, "num_steps_trained": 2826240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5652480, "last_target_update_ts": 712704, "num_target_updates": 69}, "done": false, "episodes_total": 282131, "training_iteration": 690, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-06", "timestamp": 1651738866, "time_this_iter_s": 0.4587526321411133, "time_total_s": 394.2394096851349, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 394.2394096851349, "timesteps_since_restore": 2826240, "iterations_since_restore": 690, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.616, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.213, "best_response": 0.213}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23716275634958733, "mean_inference_ms": 0.4586341904477922, "mean_action_processing_ms": 0.029173260014525644, "mean_env_wait_ms": 0.08590693324946436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 732160, "timesteps_this_iter": 4096, "agent_timesteps_total": 732157, "timers": {"load_time_ms": 0.129, "load_throughput": 31744030.273, "learn_time_ms": 5.56, "learn_throughput": 736675.808, "update_time_ms": 1.295}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9242087602615356, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 732160, "num_agent_steps_sampled": 732157, "num_steps_trained": 2867200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5734400, "last_target_update_ts": 722944, "num_target_updates": 70}, "done": false, "episodes_total": 286025, "training_iteration": 700, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-12", "timestamp": 1651738872, "time_this_iter_s": 1.4119932651519775, "time_total_s": 400.91823172569275, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 400.91823172569275, "timesteps_since_restore": 2867200, "iterations_since_restore": 700, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.25, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.661, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.071, "best_response": 0.071}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23727396929367695, "mean_inference_ms": 0.4586658395538371, "mean_action_processing_ms": 0.029187363104554352, "mean_env_wait_ms": 0.08594094515712576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 742400, "timesteps_this_iter": 4096, "agent_timesteps_total": 742399, "timers": {"load_time_ms": 0.13, "load_throughput": 31598067.287, "learn_time_ms": 5.89, "learn_throughput": 695473.686, "update_time_ms": 1.35}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9088034629821777, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 742400, "num_agent_steps_sampled": 742399, "num_steps_trained": 2908160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5816320, "last_target_update_ts": 733184, "num_target_updates": 71}, "done": false, "episodes_total": 290054, "training_iteration": 710, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-18", "timestamp": 1651738878, "time_this_iter_s": 1.441922903060913, "time_total_s": 406.8735101222992, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 406.8735101222992, "timesteps_since_restore": 2908160, "iterations_since_restore": 710, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.498, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.105, "best_response": 0.105}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23716386280307483, "mean_inference_ms": 0.4586127472556183, "mean_action_processing_ms": 0.029164438634458393, "mean_env_wait_ms": 0.08589372899922253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 752640, "timesteps_this_iter": 4096, "agent_timesteps_total": 752640, "timers": {"load_time_ms": 0.131, "load_throughput": 31196421.253, "learn_time_ms": 5.965, "learn_throughput": 686705.833, "update_time_ms": 1.304}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8661928176879883, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 752640, "num_agent_steps_sampled": 752640, "num_steps_trained": 2949120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5898240, "last_target_update_ts": 743424, "num_target_updates": 72}, "done": false, "episodes_total": 294036, "training_iteration": 720, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-24", "timestamp": 1651738884, "time_this_iter_s": 0.5130815505981445, "time_total_s": 412.5007529258728, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 412.5007529258728, "timesteps_since_restore": 2949120, "iterations_since_restore": 720, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.48, "episode_media": {}, "episodes_this_iter": 412, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.188, "best_response": 0.188}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23717066734615191, "mean_inference_ms": 0.4587106845162332, "mean_action_processing_ms": 0.02917148325749376, "mean_env_wait_ms": 0.08589506959234387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 762880, "timesteps_this_iter": 4096, "agent_timesteps_total": 762878, "timers": {"load_time_ms": 0.131, "load_throughput": 31287323.227, "learn_time_ms": 6.381, "learn_throughput": 641897.355, "update_time_ms": 1.373}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9177212119102478, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 762880, "num_agent_steps_sampled": 762878, "num_steps_trained": 2990080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5980160, "last_target_update_ts": 753664, "num_target_updates": 73}, "done": false, "episodes_total": 297956, "training_iteration": 730, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-30", "timestamp": 1651738890, "time_this_iter_s": 0.4436955451965332, "time_total_s": 418.398558139801, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 418.398558139801, "timesteps_since_restore": 2990080, "iterations_since_restore": 730, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.642, "episode_media": {}, "episodes_this_iter": 380, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.117, "best_response": 0.117}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23714938466000973, "mean_inference_ms": 0.4585239107630301, "mean_action_processing_ms": 0.02917681547498817, "mean_env_wait_ms": 0.08591924619402821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 773120, "timesteps_this_iter": 4096, "agent_timesteps_total": 773116, "timers": {"load_time_ms": 0.147, "load_throughput": 27839684.304, "learn_time_ms": 6.46, "learn_throughput": 634081.56, "update_time_ms": 1.36}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.879642128944397, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 773120, "num_agent_steps_sampled": 773116, "num_steps_trained": 3031040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6062080, "last_target_update_ts": 763904, "num_target_updates": 74}, "done": false, "episodes_total": 301921, "training_iteration": 740, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-36", "timestamp": 1651738896, "time_this_iter_s": 0.44641971588134766, "time_total_s": 424.1045935153961, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 424.1045935153961, "timesteps_since_restore": 3031040, "iterations_since_restore": 740, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.619, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.169, "best_response": 0.169}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23719452445588152, "mean_inference_ms": 0.458654765366669, "mean_action_processing_ms": 0.029181605476603933, "mean_env_wait_ms": 0.08592877310710044, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 783360, "timesteps_this_iter": 4096, "agent_timesteps_total": 783357, "timers": {"load_time_ms": 0.132, "load_throughput": 31134231.939, "learn_time_ms": 5.87, "learn_throughput": 697758.836, "update_time_ms": 1.262}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8607132434844971, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 783360, "num_agent_steps_sampled": 783357, "num_steps_trained": 3072000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6144000, "last_target_update_ts": 774144, "num_target_updates": 75}, "done": false, "episodes_total": 305925, "training_iteration": 750, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-42", "timestamp": 1651738902, "time_this_iter_s": 0.5412678718566895, "time_total_s": 429.8911712169647, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 429.8911712169647, "timesteps_since_restore": 3072000, "iterations_since_restore": 750, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.523, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.148, "best_response": 0.148}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23716231948147845, "mean_inference_ms": 0.4588284854457754, "mean_action_processing_ms": 0.02917063064909993, "mean_env_wait_ms": 0.08591142880196327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 793600, "timesteps_this_iter": 4096, "agent_timesteps_total": 793597, "timers": {"load_time_ms": 0.13, "load_throughput": 31453440.469, "learn_time_ms": 5.886, "learn_throughput": 695893.435, "update_time_ms": 1.446}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8965610265731812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 793600, "num_agent_steps_sampled": 793597, "num_steps_trained": 3112960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6225920, "last_target_update_ts": 784384, "num_target_updates": 76}, "done": false, "episodes_total": 309916, "training_iteration": 760, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-47", "timestamp": 1651738907, "time_this_iter_s": 0.48302412033081055, "time_total_s": 435.6237196922302, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 435.6237196922302, "timesteps_since_restore": 3112960, "iterations_since_restore": 760, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.491, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.131, "best_response": 0.131}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2370633341393687, "mean_inference_ms": 0.45893102453321866, "mean_action_processing_ms": 0.029164165476189958, "mean_env_wait_ms": 0.08588208703175461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 803840, "timesteps_this_iter": 4096, "agent_timesteps_total": 803837, "timers": {"load_time_ms": 0.128, "load_throughput": 31980396.843, "learn_time_ms": 5.608, "learn_throughput": 730430.404, "update_time_ms": 1.349}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.879655659198761, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 803840, "num_agent_steps_sampled": 803837, "num_steps_trained": 3153920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6307840, "last_target_update_ts": 794624, "num_target_updates": 77}, "done": false, "episodes_total": 313854, "training_iteration": 770, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-53", "timestamp": 1651738913, "time_this_iter_s": 0.4631354808807373, "time_total_s": 441.361980676651, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 441.361980676651, "timesteps_since_restore": 3153920, "iterations_since_restore": 770, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.663, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.115, "best_response": 0.115}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2370971553519571, "mean_inference_ms": 0.45878945754380407, "mean_action_processing_ms": 0.029181499290816575, "mean_env_wait_ms": 0.08592868113309236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 814080, "timesteps_this_iter": 4096, "agent_timesteps_total": 814077, "timers": {"load_time_ms": 0.129, "load_throughput": 31738165.867, "learn_time_ms": 5.876, "learn_throughput": 697085.009, "update_time_ms": 1.412}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9467230439186096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 814080, "num_agent_steps_sampled": 814077, "num_steps_trained": 3194880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6389760, "last_target_update_ts": 804864, "num_target_updates": 78}, "done": false, "episodes_total": 317831, "training_iteration": 780, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-21-59", "timestamp": 1651738919, "time_this_iter_s": 0.47069263458251953, "time_total_s": 447.13275361061096, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 447.13275361061096, "timesteps_since_restore": 3194880, "iterations_since_restore": 780, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.505, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.212, "best_response": 0.212}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23712314805015136, "mean_inference_ms": 0.4590008895377548, "mean_action_processing_ms": 0.029171928381116444, "mean_env_wait_ms": 0.0859117942417007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 824320, "timesteps_this_iter": 4096, "agent_timesteps_total": 824320, "timers": {"load_time_ms": 0.132, "load_throughput": 31083533.895, "learn_time_ms": 6.045, "learn_throughput": 677565.211, "update_time_ms": 1.352}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8455710411071777, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 824320, "num_agent_steps_sampled": 824320, "num_steps_trained": 3235840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6471680, "last_target_update_ts": 815104, "num_target_updates": 79}, "done": false, "episodes_total": 321829, "training_iteration": 790, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-05", "timestamp": 1651738925, "time_this_iter_s": 0.4926314353942871, "time_total_s": 452.8581931591034, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 452.8581931591034, "timesteps_since_restore": 3235840, "iterations_since_restore": 790, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.675, "episode_media": {}, "episodes_this_iter": 380, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.143, "best_response": 0.143}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23706608568895599, "mean_inference_ms": 0.4586562111718697, "mean_action_processing_ms": 0.02918179951383874, "mean_env_wait_ms": 0.08592508998150157, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 834560, "timesteps_this_iter": 4096, "agent_timesteps_total": 834556, "timers": {"load_time_ms": 0.131, "load_throughput": 31384488.827, "learn_time_ms": 5.844, "learn_throughput": 700867.286, "update_time_ms": 1.382}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.886621356010437, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 834560, "num_agent_steps_sampled": 834556, "num_steps_trained": 3276800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6553600, "last_target_update_ts": 825344, "num_target_updates": 80}, "done": false, "episodes_total": 325787, "training_iteration": 800, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-10", "timestamp": 1651738930, "time_this_iter_s": 0.45874524116516113, "time_total_s": 458.41043734550476, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 458.41043734550476, "timesteps_since_restore": 3276800, "iterations_since_restore": 800, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.655, "episode_media": {}, "episodes_this_iter": 389, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.242, "best_response": 0.242}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23705180547955956, "mean_inference_ms": 0.45872378569770755, "mean_action_processing_ms": 0.0291843340981853, "mean_env_wait_ms": 0.08593110299193393, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 844800, "timesteps_this_iter": 4096, "agent_timesteps_total": 844797, "timers": {"load_time_ms": 0.13, "load_throughput": 31441927.496, "learn_time_ms": 5.753, "learn_throughput": 711915.315, "update_time_ms": 1.405}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9292162656784058, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 844800, "num_agent_steps_sampled": 844797, "num_steps_trained": 3317760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6635520, "last_target_update_ts": 835584, "num_target_updates": 81}, "done": false, "episodes_total": 329757, "training_iteration": 810, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-16", "timestamp": 1651738936, "time_this_iter_s": 0.47586727142333984, "time_total_s": 464.30346393585205, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 464.30346393585205, "timesteps_since_restore": 3317760, "iterations_since_restore": 810, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.638, "episode_media": {}, "episodes_this_iter": 381, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.178, "best_response": 0.178}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2370266335323687, "mean_inference_ms": 0.45875681096844756, "mean_action_processing_ms": 0.029183629332063192, "mean_env_wait_ms": 0.08593321953107493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 855040, "timesteps_this_iter": 4096, "agent_timesteps_total": 855037, "timers": {"load_time_ms": 0.13, "load_throughput": 31499576.795, "learn_time_ms": 5.902, "learn_throughput": 693979.107, "update_time_ms": 1.372}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9169129729270935, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 855040, "num_agent_steps_sampled": 855037, "num_steps_trained": 3358720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6717440, "last_target_update_ts": 845824, "num_target_updates": 82}, "done": false, "episodes_total": 333747, "training_iteration": 820, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-22", "timestamp": 1651738942, "time_this_iter_s": 0.48711729049682617, "time_total_s": 470.12097692489624, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 470.12097692489624, "timesteps_since_restore": 3358720, "iterations_since_restore": 820, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.471, "episode_media": {}, "episodes_this_iter": 413, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.204, "best_response": 0.204}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2370806279757831, "mean_inference_ms": 0.4589055693593755, "mean_action_processing_ms": 0.029180162270281293, "mean_env_wait_ms": 0.08591075010336001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 865280, "timesteps_this_iter": 4096, "agent_timesteps_total": 865276, "timers": {"load_time_ms": 0.131, "load_throughput": 31213425.116, "learn_time_ms": 5.804, "learn_throughput": 705770.651, "update_time_ms": 1.345}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8309414982795715, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 865280, "num_agent_steps_sampled": 865276, "num_steps_trained": 3399680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6799360, "last_target_update_ts": 856064, "num_target_updates": 83}, "done": false, "episodes_total": 337800, "training_iteration": 830, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-28", "timestamp": 1651738948, "time_this_iter_s": 0.45345473289489746, "time_total_s": 475.8635652065277, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 475.8635652065277, "timesteps_since_restore": 3399680, "iterations_since_restore": 830, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.579, "episode_media": {}, "episodes_this_iter": 416, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.244, "best_response": 0.244}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23695310420571133, "mean_inference_ms": 0.458752456116291, "mean_action_processing_ms": 0.029160864801108126, "mean_env_wait_ms": 0.08590815335488149, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 875520, "timesteps_this_iter": 4096, "agent_timesteps_total": 875516, "timers": {"load_time_ms": 0.132, "load_throughput": 31033000.694, "learn_time_ms": 5.703, "learn_throughput": 718218.953, "update_time_ms": 1.53}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9151776432991028, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 875520, "num_agent_steps_sampled": 875516, "num_steps_trained": 3440640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6881280, "last_target_update_ts": 866304, "num_target_updates": 84}, "done": false, "episodes_total": 341699, "training_iteration": 840, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-35", "timestamp": 1651738955, "time_this_iter_s": 1.4948697090148926, "time_total_s": 482.7372260093689, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 482.7372260093689, "timesteps_since_restore": 3440640, "iterations_since_restore": 840, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.199999999999999, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.653, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.111, "best_response": 0.111}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2369875465369749, "mean_inference_ms": 0.4586388950417889, "mean_action_processing_ms": 0.029185947313545277, "mean_env_wait_ms": 0.08594009960729566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 885760, "timesteps_this_iter": 4096, "agent_timesteps_total": 885757, "timers": {"load_time_ms": 0.131, "load_throughput": 31207755.103, "learn_time_ms": 5.597, "learn_throughput": 731762.0, "update_time_ms": 1.355}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9180461764335632, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 885760, "num_agent_steps_sampled": 885757, "num_steps_trained": 3481600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6963200, "last_target_update_ts": 876544, "num_target_updates": 85}, "done": false, "episodes_total": 345667, "training_iteration": 850, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-41", "timestamp": 1651738961, "time_this_iter_s": 0.49846982955932617, "time_total_s": 488.69524812698364, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 488.69524812698364, "timesteps_since_restore": 3481600, "iterations_since_restore": 850, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.521, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.232, "best_response": 0.232}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23696876057104516, "mean_inference_ms": 0.45876043210949463, "mean_action_processing_ms": 0.029165850205722727, "mean_env_wait_ms": 0.08590759587097813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 896000, "timesteps_this_iter": 4096, "agent_timesteps_total": 895999, "timers": {"load_time_ms": 0.134, "load_throughput": 30618194.946, "learn_time_ms": 6.21, "learn_throughput": 659533.915, "update_time_ms": 1.398}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8849174976348877, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 896000, "num_agent_steps_sampled": 895999, "num_steps_trained": 3522560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7045120, "last_target_update_ts": 886784, "num_target_updates": 86}, "done": false, "episodes_total": 349672, "training_iteration": 860, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-47", "timestamp": 1651738967, "time_this_iter_s": 0.49756550788879395, "time_total_s": 494.606543302536, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 494.606543302536, "timesteps_since_restore": 3522560, "iterations_since_restore": 860, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.655, "episode_media": {}, "episodes_this_iter": 381, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.184, "best_response": 0.184}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23694826038293046, "mean_inference_ms": 0.4584878148631172, "mean_action_processing_ms": 0.029175626172230892, "mean_env_wait_ms": 0.08592293374267873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 906240, "timesteps_this_iter": 4096, "agent_timesteps_total": 906237, "timers": {"load_time_ms": 0.132, "load_throughput": 31061054.392, "learn_time_ms": 6.137, "learn_throughput": 667433.399, "update_time_ms": 1.371}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8755810856819153, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 906240, "num_agent_steps_sampled": 906237, "num_steps_trained": 3563520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7127040, "last_target_update_ts": 897024, "num_target_updates": 87}, "done": false, "episodes_total": 353689, "training_iteration": 870, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-53", "timestamp": 1651738973, "time_this_iter_s": 0.46530675888061523, "time_total_s": 500.40056347846985, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 500.40056347846985, "timesteps_since_restore": 3563520, "iterations_since_restore": 870, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 9.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.506, "episode_media": {}, "episodes_this_iter": 407, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.108, "best_response": 0.108}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23692233398662893, "mean_inference_ms": 0.4587917881351476, "mean_action_processing_ms": 0.029161290890718627, "mean_env_wait_ms": 0.08588659046021396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 916480, "timesteps_this_iter": 4096, "agent_timesteps_total": 916477, "timers": {"load_time_ms": 0.128, "load_throughput": 31920975.816, "learn_time_ms": 5.791, "learn_throughput": 707304.859, "update_time_ms": 1.407}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8806296586990356, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 916480, "num_agent_steps_sampled": 916477, "num_steps_trained": 3604480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7208960, "last_target_update_ts": 907264, "num_target_updates": 88}, "done": false, "episodes_total": 357700, "training_iteration": 880, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-22-59", "timestamp": 1651738979, "time_this_iter_s": 0.4662952423095703, "time_total_s": 506.39360308647156, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 506.39360308647156, "timesteps_since_restore": 3604480, "iterations_since_restore": 880, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.511, "episode_media": {}, "episodes_this_iter": 407, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.163, "best_response": 0.163}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23681251200332853, "mean_inference_ms": 0.4592450925232607, "mean_action_processing_ms": 0.029155965685628567, "mean_env_wait_ms": 0.08587490253160146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 926720, "timesteps_this_iter": 4096, "agent_timesteps_total": 926716, "timers": {"load_time_ms": 0.13, "load_throughput": 31441927.496, "learn_time_ms": 6.093, "learn_throughput": 672301.935, "update_time_ms": 1.387}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8867247104644775, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 926720, "num_agent_steps_sampled": 926716, "num_steps_trained": 3645440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7290880, "last_target_update_ts": 917504, "num_target_updates": 89}, "done": false, "episodes_total": 361647, "training_iteration": 890, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-06", "timestamp": 1651738986, "time_this_iter_s": 0.5261397361755371, "time_total_s": 513.237811088562, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 513.237811088562, "timesteps_since_restore": 3645440, "iterations_since_restore": 890, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.598, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.206, "best_response": 0.206}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23678801913837047, "mean_inference_ms": 0.4590904636348181, "mean_action_processing_ms": 0.029154345033016803, "mean_env_wait_ms": 0.08586861583597746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 936960, "timesteps_this_iter": 4096, "agent_timesteps_total": 936956, "timers": {"load_time_ms": 0.134, "load_throughput": 30531134.146, "learn_time_ms": 5.87, "learn_throughput": 697733.332, "update_time_ms": 1.347}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8667665719985962, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 936960, "num_agent_steps_sampled": 936956, "num_steps_trained": 3686400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7372800, "last_target_update_ts": 927744, "num_target_updates": 90}, "done": false, "episodes_total": 365623, "training_iteration": 900, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-12", "timestamp": 1651738992, "time_this_iter_s": 0.44684696197509766, "time_total_s": 518.9945769309998, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 518.9945769309998, "timesteps_since_restore": 3686400, "iterations_since_restore": 900, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.662, "episode_media": {}, "episodes_this_iter": 382, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.129, "best_response": 0.129}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23676294846260487, "mean_inference_ms": 0.45884475564664506, "mean_action_processing_ms": 0.029157284120385527, "mean_env_wait_ms": 0.08587325277166358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 947200, "timesteps_this_iter": 4096, "agent_timesteps_total": 947199, "timers": {"load_time_ms": 0.13, "load_throughput": 31482259.82, "learn_time_ms": 6.114, "learn_throughput": 669955.473, "update_time_ms": 1.378}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9538629055023193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 947200, "num_agent_steps_sampled": 947199, "num_steps_trained": 3727360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7454720, "last_target_update_ts": 937984, "num_target_updates": 91}, "done": false, "episodes_total": 369593, "training_iteration": 910, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-18", "timestamp": 1651738998, "time_this_iter_s": 0.5534865856170654, "time_total_s": 525.0405161380768, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 525.0405161380768, "timesteps_since_restore": 3727360, "iterations_since_restore": 910, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.491, "episode_media": {}, "episodes_this_iter": 416, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.216, "best_response": 0.216}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23681823845973435, "mean_inference_ms": 0.45910728175491555, "mean_action_processing_ms": 0.02915209006738241, "mean_env_wait_ms": 0.08585594238598052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 957440, "timesteps_this_iter": 4096, "agent_timesteps_total": 957437, "timers": {"load_time_ms": 0.129, "load_throughput": 31785141.876, "learn_time_ms": 5.961, "learn_throughput": 687142.545, "update_time_ms": 1.426}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8910006284713745, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 957440, "num_agent_steps_sampled": 957437, "num_steps_trained": 3768320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7536640, "last_target_update_ts": 948224, "num_target_updates": 92}, "done": false, "episodes_total": 373621, "training_iteration": 920, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-24", "timestamp": 1651739004, "time_this_iter_s": 0.5332543849945068, "time_total_s": 531.2216308116913, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 531.2216308116913, "timesteps_since_restore": 3768320, "iterations_since_restore": 920, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.502, "episode_media": {}, "episodes_this_iter": 407, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.138, "best_response": 0.138}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23673695665798528, "mean_inference_ms": 0.4590188904208825, "mean_action_processing_ms": 0.02914931757924007, "mean_env_wait_ms": 0.08585138203394459, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 967680, "timesteps_this_iter": 4096, "agent_timesteps_total": 967678, "timers": {"load_time_ms": 0.129, "load_throughput": 31714729.895, "learn_time_ms": 6.168, "learn_throughput": 664084.622, "update_time_ms": 1.333}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9012642502784729, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 967680, "num_agent_steps_sampled": 967678, "num_steps_trained": 3809280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7618560, "last_target_update_ts": 958464, "num_target_updates": 93}, "done": false, "episodes_total": 377555, "training_iteration": 930, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-30", "timestamp": 1651739010, "time_this_iter_s": 0.5587115287780762, "time_total_s": 537.1534941196442, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 537.1534941196442, "timesteps_since_restore": 3809280, "iterations_since_restore": 930, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.503, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.092, "best_response": 0.092}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23672821589932433, "mean_inference_ms": 0.458878136960442, "mean_action_processing_ms": 0.02914171299620393, "mean_env_wait_ms": 0.08583145280427713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 977920, "timesteps_this_iter": 4096, "agent_timesteps_total": 977920, "timers": {"load_time_ms": 0.13, "load_throughput": 31603880.029, "learn_time_ms": 5.788, "learn_throughput": 707718.607, "update_time_ms": 1.283}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9072462320327759, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 977920, "num_agent_steps_sampled": 977920, "num_steps_trained": 3850240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7700480, "last_target_update_ts": 968704, "num_target_updates": 94}, "done": false, "episodes_total": 381641, "training_iteration": 940, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-36", "timestamp": 1651739016, "time_this_iter_s": 0.44908714294433594, "time_total_s": 543.042448759079, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 543.042448759079, "timesteps_since_restore": 3850240, "iterations_since_restore": 940, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.687, "episode_media": {}, "episodes_this_iter": 381, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.179, "best_response": 0.179}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23667598162314635, "mean_inference_ms": 0.4585300536967436, "mean_action_processing_ms": 0.029151700244954053, "mean_env_wait_ms": 0.08584828206898504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 988160, "timesteps_this_iter": 4096, "agent_timesteps_total": 988158, "timers": {"load_time_ms": 0.137, "load_throughput": 29893630.04, "learn_time_ms": 5.888, "learn_throughput": 695670.821, "update_time_ms": 1.24}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8744231462478638, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 988160, "num_agent_steps_sampled": 988158, "num_steps_trained": 3891200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7782400, "last_target_update_ts": 978944, "num_target_updates": 95}, "done": false, "episodes_total": 385553, "training_iteration": 950, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-42", "timestamp": 1651739022, "time_this_iter_s": 0.44091272354125977, "time_total_s": 549.0511691570282, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 549.0511691570282, "timesteps_since_restore": 3891200, "iterations_since_restore": 950, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.47, "episode_media": {}, "episodes_this_iter": 412, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.265, "best_response": 0.265}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2365965858051253, "mean_inference_ms": 0.45866516794304296, "mean_action_processing_ms": 0.029132490715062326, "mean_env_wait_ms": 0.08579401024007936, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 998400, "timesteps_this_iter": 4096, "agent_timesteps_total": 998397, "timers": {"load_time_ms": 0.131, "load_throughput": 31173778.233, "learn_time_ms": 5.997, "learn_throughput": 683055.451, "update_time_ms": 1.371}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8547835946083069, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 998400, "num_agent_steps_sampled": 998397, "num_steps_trained": 3932160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7864320, "last_target_update_ts": 989184, "num_target_updates": 96}, "done": false, "episodes_total": 389607, "training_iteration": 960, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-48", "timestamp": 1651739028, "time_this_iter_s": 0.46637845039367676, "time_total_s": 555.1460695266724, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 555.1460695266724, "timesteps_since_restore": 3932160, "iterations_since_restore": 960, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.662, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.155, "best_response": 0.155}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23651279424413138, "mean_inference_ms": 0.45835808666456124, "mean_action_processing_ms": 0.02913728849596104, "mean_env_wait_ms": 0.08581639747837906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1008640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1008638, "timers": {"load_time_ms": 0.131, "load_throughput": 31361572.077, "learn_time_ms": 6.103, "learn_throughput": 671180.403, "update_time_ms": 1.315}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9523575305938721, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1008640, "num_agent_steps_sampled": 1008638, "num_steps_trained": 3973120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7946240, "last_target_update_ts": 999424, "num_target_updates": 97}, "done": false, "episodes_total": 393476, "training_iteration": 970, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-23-54", "timestamp": 1651739034, "time_this_iter_s": 0.5006496906280518, "time_total_s": 560.9835438728333, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 560.9835438728333, "timesteps_since_restore": 3973120, "iterations_since_restore": 970, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.549, "episode_media": {}, "episodes_this_iter": 413, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.152, "best_response": 0.152}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23642418382549274, "mean_inference_ms": 0.4583909064750859, "mean_action_processing_ms": 0.029104990167320863, "mean_env_wait_ms": 0.08576983491075876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1018880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1018879, "timers": {"load_time_ms": 0.137, "load_throughput": 29826161.778, "learn_time_ms": 6.137, "learn_throughput": 667394.507, "update_time_ms": 1.375}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8801858425140381, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1018880, "num_agent_steps_sampled": 1018879, "num_steps_trained": 4014080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8028160, "last_target_update_ts": 1009664, "num_target_updates": 98}, "done": false, "episodes_total": 397552, "training_iteration": 980, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-00", "timestamp": 1651739040, "time_this_iter_s": 0.45889735221862793, "time_total_s": 567.0318470001221, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 567.0318470001221, "timesteps_since_restore": 4014080, "iterations_since_restore": 980, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.647, "episode_media": {}, "episodes_this_iter": 389, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.206, "best_response": 0.206}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23643148688973492, "mean_inference_ms": 0.45814096180247915, "mean_action_processing_ms": 0.029121404567080043, "mean_env_wait_ms": 0.08577824375871154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1029120, "timesteps_this_iter": 4096, "agent_timesteps_total": 1029118, "timers": {"load_time_ms": 0.133, "load_throughput": 30689298.292, "learn_time_ms": 6.264, "learn_throughput": 653930.624, "update_time_ms": 1.387}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9143607020378113, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1029120, "num_agent_steps_sampled": 1029118, "num_steps_trained": 4055040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8110080, "last_target_update_ts": 1019904, "num_target_updates": 99}, "done": false, "episodes_total": 401522, "training_iteration": 990, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-07", "timestamp": 1651739047, "time_this_iter_s": 1.5162556171417236, "time_total_s": 573.7982699871063, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 573.7982699871063, "timesteps_since_restore": 4055040, "iterations_since_restore": 990, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.504, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.193, "best_response": 0.193}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2364776152432998, "mean_inference_ms": 0.4584777706106855, "mean_action_processing_ms": 0.029113023807236692, "mean_env_wait_ms": 0.08575947727157682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1039360, "timesteps_this_iter": 4096, "agent_timesteps_total": 1039356, "timers": {"load_time_ms": 0.13, "load_throughput": 31511132.032, "learn_time_ms": 6.037, "learn_throughput": 678469.648, "update_time_ms": 1.461}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8656379580497742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1039360, "num_agent_steps_sampled": 1039356, "num_steps_trained": 4096000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8192000, "last_target_update_ts": 1030144, "num_target_updates": 100}, "done": false, "episodes_total": 405542, "training_iteration": 1000, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-13", "timestamp": 1651739053, "time_this_iter_s": 0.5299220085144043, "time_total_s": 579.8723037242889, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 579.8723037242889, "timesteps_since_restore": 4096000, "iterations_since_restore": 1000, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.543, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.166, "best_response": 0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23647628840345203, "mean_inference_ms": 0.45859050498042137, "mean_action_processing_ms": 0.029108989318446504, "mean_env_wait_ms": 0.08577109843448898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1049600, "timesteps_this_iter": 4096, "agent_timesteps_total": 1049598, "timers": {"load_time_ms": 0.131, "load_throughput": 31344406.466, "learn_time_ms": 5.85, "learn_throughput": 700118.963, "update_time_ms": 1.343}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8754532933235168, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1049600, "num_agent_steps_sampled": 1049598, "num_steps_trained": 4136960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8273920, "last_target_update_ts": 1040384, "num_target_updates": 101}, "done": false, "episodes_total": 409444, "training_iteration": 1010, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-19", "timestamp": 1651739059, "time_this_iter_s": 0.45177769660949707, "time_total_s": 585.6814670562744, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 585.6814670562744, "timesteps_since_restore": 4136960, "iterations_since_restore": 1010, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.646, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.213, "best_response": 0.213}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2365062158067474, "mean_inference_ms": 0.4583555795420747, "mean_action_processing_ms": 0.02912492489103147, "mean_env_wait_ms": 0.08579109134172808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1059840, "timesteps_this_iter": 4096, "agent_timesteps_total": 1059838, "timers": {"load_time_ms": 0.131, "load_throughput": 31247488.512, "learn_time_ms": 5.71, "learn_throughput": 717337.28, "update_time_ms": 1.347}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8907680511474609, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1059840, "num_agent_steps_sampled": 1059838, "num_steps_trained": 4177920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8355840, "last_target_update_ts": 1050624, "num_target_updates": 102}, "done": false, "episodes_total": 413474, "training_iteration": 1020, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-25", "timestamp": 1651739065, "time_this_iter_s": 0.4651343822479248, "time_total_s": 591.4510316848755, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 591.4510316848755, "timesteps_since_restore": 4177920, "iterations_since_restore": 1020, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.693, "episode_media": {}, "episodes_this_iter": 380, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.248, "best_response": 0.248}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2365015443086199, "mean_inference_ms": 0.45834934919612497, "mean_action_processing_ms": 0.029136868796162906, "mean_env_wait_ms": 0.08580589485548387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1070080, "timesteps_this_iter": 4096, "agent_timesteps_total": 1070079, "timers": {"load_time_ms": 0.132, "load_throughput": 31139875.266, "learn_time_ms": 6.224, "learn_throughput": 658139.236, "update_time_ms": 1.42}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9030668139457703, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1070080, "num_agent_steps_sampled": 1070079, "num_steps_trained": 4218880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8437760, "last_target_update_ts": 1060864, "num_target_updates": 103}, "done": false, "episodes_total": 417317, "training_iteration": 1030, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-31", "timestamp": 1651739071, "time_this_iter_s": 0.4434537887573242, "time_total_s": 597.4262435436249, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 597.4262435436249, "timesteps_since_restore": 4218880, "iterations_since_restore": 1030, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.566, "episode_media": {}, "episodes_this_iter": 381, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.161, "best_response": 0.161}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23651795782120816, "mean_inference_ms": 0.4587291737533582, "mean_action_processing_ms": 0.029121884976301835, "mean_env_wait_ms": 0.0858124566089359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1080320, "timesteps_this_iter": 4096, "agent_timesteps_total": 1080317, "timers": {"load_time_ms": 0.132, "load_throughput": 30921290.828, "learn_time_ms": 6.031, "learn_throughput": 679172.383, "update_time_ms": 1.439}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9054057598114014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1080320, "num_agent_steps_sampled": 1080317, "num_steps_trained": 4259840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8519680, "last_target_update_ts": 1071104, "num_target_updates": 104}, "done": false, "episodes_total": 421338, "training_iteration": 1040, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-37", "timestamp": 1651739077, "time_this_iter_s": 0.502692461013794, "time_total_s": 603.6064395904541, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 603.6064395904541, "timesteps_since_restore": 4259840, "iterations_since_restore": 1040, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.661, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.21, "best_response": 0.21}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23655526906371888, "mean_inference_ms": 0.45855471110423646, "mean_action_processing_ms": 0.02914590445970309, "mean_env_wait_ms": 0.08584128546473917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1090560, "timesteps_this_iter": 4096, "agent_timesteps_total": 1090557, "timers": {"load_time_ms": 0.135, "load_throughput": 30310284.375, "learn_time_ms": 6.26, "learn_throughput": 654289.252, "update_time_ms": 1.404}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9447371363639832, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1090560, "num_agent_steps_sampled": 1090557, "num_steps_trained": 4300800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8601600, "last_target_update_ts": 1081344, "num_target_updates": 105}, "done": false, "episodes_total": 425189, "training_iteration": 1050, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-43", "timestamp": 1651739083, "time_this_iter_s": 0.44483017921447754, "time_total_s": 609.5982847213745, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 609.5982847213745, "timesteps_since_restore": 4300800, "iterations_since_restore": 1050, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.552, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.127, "best_response": 0.127}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23648291988607378, "mean_inference_ms": 0.4585947075356356, "mean_action_processing_ms": 0.02911863616141244, "mean_env_wait_ms": 0.0858067921457747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1100800, "timesteps_this_iter": 4096, "agent_timesteps_total": 1100797, "timers": {"load_time_ms": 0.132, "load_throughput": 30960297.682, "learn_time_ms": 6.425, "learn_throughput": 637531.095, "update_time_ms": 1.348}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9114247560501099, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1100800, "num_agent_steps_sampled": 1100797, "num_steps_trained": 4341760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8683520, "last_target_update_ts": 1091584, "num_target_updates": 106}, "done": false, "episodes_total": 429264, "training_iteration": 1060, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-49", "timestamp": 1651739089, "time_this_iter_s": 0.463714599609375, "time_total_s": 615.4719116687775, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 615.4719116687775, "timesteps_since_restore": 4341760, "iterations_since_restore": 1060, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.49, "episode_media": {}, "episodes_this_iter": 414, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.191, "best_response": 0.191}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23653344294175271, "mean_inference_ms": 0.4586529061540495, "mean_action_processing_ms": 0.02912532274693356, "mean_env_wait_ms": 0.08580049778642805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1111040, "timesteps_this_iter": 4096, "agent_timesteps_total": 1111037, "timers": {"load_time_ms": 0.132, "load_throughput": 30926857.217, "learn_time_ms": 5.79, "learn_throughput": 707462.143, "update_time_ms": 1.285}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8731736540794373, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1111040, "num_agent_steps_sampled": 1111037, "num_steps_trained": 4382720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8765440, "last_target_update_ts": 1101824, "num_target_updates": 107}, "done": false, "episodes_total": 433236, "training_iteration": 1070, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-24-55", "timestamp": 1651739095, "time_this_iter_s": 0.44881248474121094, "time_total_s": 621.4485423564911, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 621.4485423564911, "timesteps_since_restore": 4382720, "iterations_since_restore": 1070, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.6, "episode_media": {}, "episodes_this_iter": 418, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.159, "best_response": 0.159}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23648542897710992, "mean_inference_ms": 0.4584786028217894, "mean_action_processing_ms": 0.029127359180312746, "mean_env_wait_ms": 0.08581459442389297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1121280, "timesteps_this_iter": 4096, "agent_timesteps_total": 1121279, "timers": {"load_time_ms": 0.13, "load_throughput": 31609694.911, "learn_time_ms": 5.889, "learn_throughput": 695507.473, "update_time_ms": 1.285}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8863353729248047, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1121280, "num_agent_steps_sampled": 1121279, "num_steps_trained": 4423680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8847360, "last_target_update_ts": 1112064, "num_target_updates": 108}, "done": false, "episodes_total": 437151, "training_iteration": 1080, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-01", "timestamp": 1651739101, "time_this_iter_s": 0.46825265884399414, "time_total_s": 627.483588218689, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 627.483588218689, "timesteps_since_restore": 4423680, "iterations_since_restore": 1080, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.681, "episode_media": {}, "episodes_this_iter": 381, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.181, "best_response": 0.181}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23649439221556587, "mean_inference_ms": 0.45832890000509613, "mean_action_processing_ms": 0.029148349779015297, "mean_env_wait_ms": 0.08582692894139263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1131520, "timesteps_this_iter": 4096, "agent_timesteps_total": 1131519, "timers": {"load_time_ms": 0.131, "load_throughput": 31168122.612, "learn_time_ms": 5.856, "learn_throughput": 699412.098, "update_time_ms": 1.378}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.843264102935791, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1131520, "num_agent_steps_sampled": 1131519, "num_steps_trained": 4464640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8929280, "last_target_update_ts": 1122304, "num_target_updates": 109}, "done": false, "episodes_total": 441098, "training_iteration": 1090, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-07", "timestamp": 1651739107, "time_this_iter_s": 0.4561619758605957, "time_total_s": 633.3028950691223, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 633.3028950691223, "timesteps_since_restore": 4464640, "iterations_since_restore": 1090, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.512, "episode_media": {}, "episodes_this_iter": 403, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.172, "best_response": 0.172}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23648102052855227, "mean_inference_ms": 0.4584891365788178, "mean_action_processing_ms": 0.02912578169294659, "mean_env_wait_ms": 0.08579749461145261, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1141760, "timesteps_this_iter": 4096, "agent_timesteps_total": 1141757, "timers": {"load_time_ms": 0.129, "load_throughput": 31849961.409, "learn_time_ms": 5.824, "learn_throughput": 703329.138, "update_time_ms": 1.332}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.901446521282196, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1141760, "num_agent_steps_sampled": 1141757, "num_steps_trained": 4505600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9011200, "last_target_update_ts": 1132544, "num_target_updates": 110}, "done": false, "episodes_total": 445189, "training_iteration": 1100, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-13", "timestamp": 1651739113, "time_this_iter_s": 0.4655623435974121, "time_total_s": 639.3292286396027, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 639.3292286396027, "timesteps_since_restore": 4505600, "iterations_since_restore": 1100, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.491, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.232, "best_response": 0.232}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2365677762996143, "mean_inference_ms": 0.4585571515897065, "mean_action_processing_ms": 0.029133901520570066, "mean_env_wait_ms": 0.08580247984478875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1152000, "timesteps_this_iter": 4096, "agent_timesteps_total": 1151997, "timers": {"load_time_ms": 0.129, "load_throughput": 31808682.066, "learn_time_ms": 5.764, "learn_throughput": 710649.028, "update_time_ms": 1.386}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9000881910324097, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1152000, "num_agent_steps_sampled": 1151997, "num_steps_trained": 4546560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9093120, "last_target_update_ts": 1142784, "num_target_updates": 111}, "done": false, "episodes_total": 449165, "training_iteration": 1110, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-19", "timestamp": 1651739119, "time_this_iter_s": 0.4471700191497803, "time_total_s": 645.3769102096558, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 645.3769102096558, "timesteps_since_restore": 4546560, "iterations_since_restore": 1110, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.513, "episode_media": {}, "episodes_this_iter": 418, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.233, "best_response": 0.233}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2366384959141951, "mean_inference_ms": 0.45883307899364406, "mean_action_processing_ms": 0.02913632722860454, "mean_env_wait_ms": 0.08582624251607404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1162240, "timesteps_this_iter": 4096, "agent_timesteps_total": 1162238, "timers": {"load_time_ms": 0.131, "load_throughput": 31310131.555, "learn_time_ms": 5.733, "learn_throughput": 714422.851, "update_time_ms": 1.429}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9020238518714905, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1162240, "num_agent_steps_sampled": 1162238, "num_steps_trained": 4587520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9175040, "last_target_update_ts": 1153024, "num_target_updates": 112}, "done": false, "episodes_total": 453118, "training_iteration": 1120, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-27", "timestamp": 1651739127, "time_this_iter_s": 1.5308685302734375, "time_total_s": 652.6805853843689, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 652.6805853843689, "timesteps_since_restore": 4587520, "iterations_since_restore": 1120, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.4, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.505, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.144, "best_response": 0.144}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2366149249896294, "mean_inference_ms": 0.4587839174153458, "mean_action_processing_ms": 0.02913560173603894, "mean_env_wait_ms": 0.08581546338896955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1172480, "timesteps_this_iter": 4096, "agent_timesteps_total": 1172477, "timers": {"load_time_ms": 0.134, "load_throughput": 30596383.231, "learn_time_ms": 6.722, "learn_throughput": 609353.512, "update_time_ms": 1.509}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9158457517623901, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1172480, "num_agent_steps_sampled": 1172477, "num_steps_trained": 4628480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9256960, "last_target_update_ts": 1163264, "num_target_updates": 113}, "done": false, "episodes_total": 457217, "training_iteration": 1130, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-33", "timestamp": 1651739133, "time_this_iter_s": 0.529303789138794, "time_total_s": 658.7315194606781, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 658.7315194606781, "timesteps_since_restore": 4628480, "iterations_since_restore": 1130, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.578, "episode_media": {}, "episodes_this_iter": 415, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.12, "best_response": 0.12}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2366111020151344, "mean_inference_ms": 0.45872033036717047, "mean_action_processing_ms": 0.029128782901963603, "mean_env_wait_ms": 0.08582556590305256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1182720, "timesteps_this_iter": 4096, "agent_timesteps_total": 1182719, "timers": {"load_time_ms": 0.133, "load_throughput": 30738717.452, "learn_time_ms": 6.025, "learn_throughput": 679857.743, "update_time_ms": 1.415}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9023394584655762, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1182720, "num_agent_steps_sampled": 1182719, "num_steps_trained": 4669440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9338880, "last_target_update_ts": 1173504, "num_target_updates": 114}, "done": false, "episodes_total": 461204, "training_iteration": 1140, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-39", "timestamp": 1651739139, "time_this_iter_s": 0.5224571228027344, "time_total_s": 664.7269876003265, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 664.7269876003265, "timesteps_since_restore": 4669440, "iterations_since_restore": 1140, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.663, "episode_media": {}, "episodes_this_iter": 389, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.056, "best_response": 0.056}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23666276057564323, "mean_inference_ms": 0.4586039227403512, "mean_action_processing_ms": 0.02915245679611587, "mean_env_wait_ms": 0.08585875585367077, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1192960, "timesteps_this_iter": 4096, "agent_timesteps_total": 1192959, "timers": {"load_time_ms": 0.134, "load_throughput": 30607285.202, "learn_time_ms": 6.138, "learn_throughput": 667293.409, "update_time_ms": 1.458}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8405205011367798, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1192960, "num_agent_steps_sampled": 1192959, "num_steps_trained": 4710400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9420800, "last_target_update_ts": 1183744, "num_target_updates": 115}, "done": false, "episodes_total": 465142, "training_iteration": 1150, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-45", "timestamp": 1651739145, "time_this_iter_s": 0.4671671390533447, "time_total_s": 670.728926897049, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 670.728926897049, "timesteps_since_restore": 4710400, "iterations_since_restore": 1150, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.69, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.117, "best_response": 0.117}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2366110912520976, "mean_inference_ms": 0.4586127072534181, "mean_action_processing_ms": 0.029159441641377334, "mean_env_wait_ms": 0.08586433489256286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1203200, "timesteps_this_iter": 4096, "agent_timesteps_total": 1203197, "timers": {"load_time_ms": 0.13, "load_throughput": 31574837.684, "learn_time_ms": 5.833, "learn_throughput": 702156.314, "update_time_ms": 1.407}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.864155650138855, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1203200, "num_agent_steps_sampled": 1203197, "num_steps_trained": 4751360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9502720, "last_target_update_ts": 1193984, "num_target_updates": 116}, "done": false, "episodes_total": 468983, "training_iteration": 1160, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-51", "timestamp": 1651739151, "time_this_iter_s": 0.4561951160430908, "time_total_s": 676.7967219352722, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 676.7967219352722, "timesteps_since_restore": 4751360, "iterations_since_restore": 1160, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.66, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.151, "best_response": 0.151}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23656550689221026, "mean_inference_ms": 0.4586159822897953, "mean_action_processing_ms": 0.029158484245431222, "mean_env_wait_ms": 0.08586301421954869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1213440, "timesteps_this_iter": 4096, "agent_timesteps_total": 1213438, "timers": {"load_time_ms": 0.127, "load_throughput": 32274787.12, "learn_time_ms": 5.956, "learn_throughput": 687720.186, "update_time_ms": 1.365}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9363754987716675, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1213440, "num_agent_steps_sampled": 1213438, "num_steps_trained": 4792320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9584640, "last_target_update_ts": 1204224, "num_target_updates": 117}, "done": false, "episodes_total": 472904, "training_iteration": 1170, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-25-57", "timestamp": 1651739157, "time_this_iter_s": 0.562476634979248, "time_total_s": 683.0417125225067, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 683.0417125225067, "timesteps_since_restore": 4792320, "iterations_since_restore": 1170, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.601, "episode_media": {}, "episodes_this_iter": 381, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.169, "best_response": 0.169}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23653209182040258, "mean_inference_ms": 0.45872927775277533, "mean_action_processing_ms": 0.029147715383207297, "mean_env_wait_ms": 0.0858605175886426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1223680, "timesteps_this_iter": 4096, "agent_timesteps_total": 1223678, "timers": {"load_time_ms": 0.135, "load_throughput": 30390711.452, "learn_time_ms": 6.323, "learn_throughput": 647751.861, "update_time_ms": 1.413}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9196922779083252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1223680, "num_agent_steps_sampled": 1223678, "num_steps_trained": 4833280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9666560, "last_target_update_ts": 1214464, "num_target_updates": 118}, "done": false, "episodes_total": 476885, "training_iteration": 1180, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-03", "timestamp": 1651739163, "time_this_iter_s": 0.48082613945007324, "time_total_s": 689.0116922855377, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 689.0116922855377, "timesteps_since_restore": 4833280, "iterations_since_restore": 1180, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.465, "episode_media": {}, "episodes_this_iter": 422, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.17, "best_response": 0.17}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23663481861884447, "mean_inference_ms": 0.4590106071849671, "mean_action_processing_ms": 0.029161931553065578, "mean_env_wait_ms": 0.08586792193296616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1233920, "timesteps_this_iter": 4096, "agent_timesteps_total": 1233917, "timers": {"load_time_ms": 0.131, "load_throughput": 31258859.505, "learn_time_ms": 5.872, "learn_throughput": 697552.02, "update_time_ms": 1.451}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8549437522888184, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1233920, "num_agent_steps_sampled": 1233917, "num_steps_trained": 4874240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9748480, "last_target_update_ts": 1224704, "num_target_updates": 119}, "done": false, "episodes_total": 480880, "training_iteration": 1190, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-10", "timestamp": 1651739170, "time_this_iter_s": 0.452617883682251, "time_total_s": 695.1501665115356, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 695.1501665115356, "timesteps_since_restore": 4874240, "iterations_since_restore": 1190, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.524, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.15, "best_response": 0.15}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23666812909476015, "mean_inference_ms": 0.45905978441619416, "mean_action_processing_ms": 0.02915145759004971, "mean_env_wait_ms": 0.08588059369818907, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1244160, "timesteps_this_iter": 4096, "agent_timesteps_total": 1244158, "timers": {"load_time_ms": 0.137, "load_throughput": 29945736.768, "learn_time_ms": 6.198, "learn_throughput": 660827.741, "update_time_ms": 1.449}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8744230270385742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1244160, "num_agent_steps_sampled": 1244158, "num_steps_trained": 4915200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9830400, "last_target_update_ts": 1234944, "num_target_updates": 120}, "done": false, "episodes_total": 484819, "training_iteration": 1200, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-16", "timestamp": 1651739176, "time_this_iter_s": 0.5383963584899902, "time_total_s": 701.220196723938, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 701.220196723938, "timesteps_since_restore": 4915200, "iterations_since_restore": 1200, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.677, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.211, "best_response": 0.211}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23664396071938273, "mean_inference_ms": 0.4587475628337543, "mean_action_processing_ms": 0.02917177018105348, "mean_env_wait_ms": 0.08589830360772341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1254400, "timesteps_this_iter": 4096, "agent_timesteps_total": 1254398, "timers": {"load_time_ms": 0.129, "load_throughput": 31679640.76, "learn_time_ms": 6.056, "learn_throughput": 676367.477, "update_time_ms": 1.416}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8994104266166687, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1254400, "num_agent_steps_sampled": 1254398, "num_steps_trained": 4956160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9912320, "last_target_update_ts": 1245184, "num_target_updates": 121}, "done": false, "episodes_total": 488797, "training_iteration": 1210, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-22", "timestamp": 1651739182, "time_this_iter_s": 0.4668388366699219, "time_total_s": 707.105904340744, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 707.105904340744, "timesteps_since_restore": 4956160, "iterations_since_restore": 1210, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.616, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.128, "best_response": 0.128}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23667480706046468, "mean_inference_ms": 0.4589784415731435, "mean_action_processing_ms": 0.029163689764348803, "mean_env_wait_ms": 0.08590164664911441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1264640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1264637, "timers": {"load_time_ms": 0.13, "load_throughput": 31615511.932, "learn_time_ms": 5.88, "learn_throughput": 696610.15, "update_time_ms": 1.389}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8944424390792847, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1264640, "num_agent_steps_sampled": 1264637, "num_steps_trained": 4997120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9994240, "last_target_update_ts": 1255424, "num_target_updates": 122}, "done": false, "episodes_total": 492803, "training_iteration": 1220, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-28", "timestamp": 1651739188, "time_this_iter_s": 0.5086688995361328, "time_total_s": 713.2507407665253, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 713.2507407665253, "timesteps_since_restore": 4997120, "iterations_since_restore": 1220, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.506, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.176, "best_response": 0.176}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23666230324843787, "mean_inference_ms": 0.45918161199129215, "mean_action_processing_ms": 0.029161251175162838, "mean_env_wait_ms": 0.08587882250618604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1274880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1274877, "timers": {"load_time_ms": 0.133, "load_throughput": 30904603.677, "learn_time_ms": 6.076, "learn_throughput": 674151.288, "update_time_ms": 1.383}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.909103274345398, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1274880, "num_agent_steps_sampled": 1274877, "num_steps_trained": 5038080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10076160, "last_target_update_ts": 1265664, "num_target_updates": 123}, "done": false, "episodes_total": 496806, "training_iteration": 1230, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-34", "timestamp": 1651739194, "time_this_iter_s": 0.4875495433807373, "time_total_s": 719.1451392173767, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 719.1451392173767, "timesteps_since_restore": 5038080, "iterations_since_restore": 1230, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.542, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.105, "best_response": 0.105}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23665759849481394, "mean_inference_ms": 0.45915480041220325, "mean_action_processing_ms": 0.029152766183241738, "mean_env_wait_ms": 0.08588191957591387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1285120, "timesteps_this_iter": 4096, "agent_timesteps_total": 1285118, "timers": {"load_time_ms": 0.131, "load_throughput": 31332973.161, "learn_time_ms": 5.709, "learn_throughput": 717439.131, "update_time_ms": 1.459}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8560097813606262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1285120, "num_agent_steps_sampled": 1285118, "num_steps_trained": 5079040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10158080, "last_target_update_ts": 1275904, "num_target_updates": 124}, "done": false, "episodes_total": 500745, "training_iteration": 1240, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-40", "timestamp": 1651739200, "time_this_iter_s": 0.4870939254760742, "time_total_s": 725.1561117172241, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 725.1561117172241, "timesteps_since_restore": 5079040, "iterations_since_restore": 1240, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.67, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.175, "best_response": 0.175}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2366975357680426, "mean_inference_ms": 0.4589349766058082, "mean_action_processing_ms": 0.029177433174857506, "mean_env_wait_ms": 0.08591400772702255, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1295360, "timesteps_this_iter": 4096, "agent_timesteps_total": 1295357, "timers": {"load_time_ms": 0.13, "load_throughput": 31621331.095, "learn_time_ms": 5.298, "learn_throughput": 773143.594, "update_time_ms": 1.356}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9333196878433228, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1295360, "num_agent_steps_sampled": 1295357, "num_steps_trained": 5120000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10240000, "last_target_update_ts": 1286144, "num_target_updates": 125}, "done": false, "episodes_total": 504696, "training_iteration": 1250, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-47", "timestamp": 1651739207, "time_this_iter_s": 1.5682001113891602, "time_total_s": 732.1066899299622, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 732.1066899299622, "timesteps_since_restore": 5120000, "iterations_since_restore": 1250, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.449999999999999, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.504, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.167, "best_response": 0.167}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23664485113661307, "mean_inference_ms": 0.45905262000609026, "mean_action_processing_ms": 0.02915124489563948, "mean_env_wait_ms": 0.0858605629171302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1305600, "timesteps_this_iter": 4096, "agent_timesteps_total": 1305596, "timers": {"load_time_ms": 0.131, "load_throughput": 31236125.789, "learn_time_ms": 5.799, "learn_throughput": 706371.336, "update_time_ms": 1.447}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8905160427093506, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1305600, "num_agent_steps_sampled": 1305596, "num_steps_trained": 5160960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10321920, "last_target_update_ts": 1296384, "num_target_updates": 126}, "done": false, "episodes_total": 508715, "training_iteration": 1260, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-53", "timestamp": 1651739213, "time_this_iter_s": 1.5726184844970703, "time_total_s": 738.0777320861816, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 738.0777320861816, "timesteps_since_restore": 5160960, "iterations_since_restore": 1260, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.475, "episode_media": {}, "episodes_this_iter": 417, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.119, "best_response": 0.119}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23669446437972472, "mean_inference_ms": 0.45909190350094614, "mean_action_processing_ms": 0.029159049927688002, "mean_env_wait_ms": 0.08586494531151115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1315840, "timesteps_this_iter": 4096, "agent_timesteps_total": 1315839, "timers": {"load_time_ms": 0.13, "load_throughput": 31557437.884, "learn_time_ms": 5.952, "learn_throughput": 688166.458, "update_time_ms": 1.323}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9269007444381714, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1315840, "num_agent_steps_sampled": 1315839, "num_steps_trained": 5201920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10403840, "last_target_update_ts": 1306624, "num_target_updates": 127}, "done": false, "episodes_total": 512817, "training_iteration": 1270, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-26-59", "timestamp": 1651739219, "time_this_iter_s": 0.4453465938568115, "time_total_s": 744.2321932315826, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 744.2321932315826, "timesteps_since_restore": 5201920, "iterations_since_restore": 1270, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.46, "episode_media": {}, "episodes_this_iter": 418, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.186, "best_response": 0.186}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367268570611164, "mean_inference_ms": 0.4590816207348515, "mean_action_processing_ms": 0.029165066803957862, "mean_env_wait_ms": 0.08586876885099781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1326080, "timesteps_this_iter": 4096, "agent_timesteps_total": 1326076, "timers": {"load_time_ms": 0.14, "load_throughput": 29267238.814, "learn_time_ms": 6.076, "learn_throughput": 674085.159, "update_time_ms": 1.349}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9182354807853699, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1326080, "num_agent_steps_sampled": 1326076, "num_steps_trained": 5242880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10485760, "last_target_update_ts": 1316864, "num_target_updates": 128}, "done": false, "episodes_total": 516792, "training_iteration": 1280, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-05", "timestamp": 1651739225, "time_this_iter_s": 0.47345829010009766, "time_total_s": 750.27827501297, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 750.27827501297, "timesteps_since_restore": 5242880, "iterations_since_restore": 1280, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.577, "episode_media": {}, "episodes_this_iter": 414, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.07, "best_response": 0.07}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23668436079589084, "mean_inference_ms": 0.45900685171068323, "mean_action_processing_ms": 0.02915145853519261, "mean_env_wait_ms": 0.0858867282056448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1336320, "timesteps_this_iter": 4096, "agent_timesteps_total": 1336318, "timers": {"load_time_ms": 0.132, "load_throughput": 31004997.625, "learn_time_ms": 5.963, "learn_throughput": 686862.326, "update_time_ms": 1.391}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8945496678352356, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1336320, "num_agent_steps_sampled": 1336318, "num_steps_trained": 5283840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10567680, "last_target_update_ts": 1327104, "num_target_updates": 129}, "done": false, "episodes_total": 520731, "training_iteration": 1290, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-11", "timestamp": 1651739231, "time_this_iter_s": 0.5532956123352051, "time_total_s": 756.242190361023, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 756.242190361023, "timesteps_since_restore": 5283840, "iterations_since_restore": 1290, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.6, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.612, "episode_media": {}, "episodes_this_iter": 409, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.243, "best_response": 0.243}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367570575759443, "mean_inference_ms": 0.458987869418408, "mean_action_processing_ms": 0.029158500755679957, "mean_env_wait_ms": 0.08590388800085547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1346560, "timesteps_this_iter": 4096, "agent_timesteps_total": 1346557, "timers": {"load_time_ms": 0.129, "load_throughput": 31703024.883, "learn_time_ms": 5.543, "learn_throughput": 738915.927, "update_time_ms": 1.357}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8436304330825806, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1346560, "num_agent_steps_sampled": 1346557, "num_steps_trained": 5324800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10649600, "last_target_update_ts": 1337344, "num_target_updates": 130}, "done": false, "episodes_total": 524723, "training_iteration": 1300, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-18", "timestamp": 1651739238, "time_this_iter_s": 0.5158021450042725, "time_total_s": 762.4371886253357, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 762.4371886253357, "timesteps_since_restore": 5324800, "iterations_since_restore": 1300, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.668, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.2, "best_response": 0.2}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23677336995018294, "mean_inference_ms": 0.45889901144737477, "mean_action_processing_ms": 0.029171507155355145, "mean_env_wait_ms": 0.08591966807073632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1356800, "timesteps_this_iter": 4096, "agent_timesteps_total": 1356798, "timers": {"load_time_ms": 0.133, "load_throughput": 30700266.59, "learn_time_ms": 5.842, "learn_throughput": 701127.575, "update_time_ms": 1.349}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8894742727279663, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1356800, "num_agent_steps_sampled": 1356798, "num_steps_trained": 5365760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10731520, "last_target_update_ts": 1347584, "num_target_updates": 131}, "done": false, "episodes_total": 528675, "training_iteration": 1310, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-24", "timestamp": 1651739244, "time_this_iter_s": 0.4497840404510498, "time_total_s": 768.5290298461914, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 768.5290298461914, "timesteps_since_restore": 5365760, "iterations_since_restore": 1310, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.51, "episode_media": {}, "episodes_this_iter": 408, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.171, "best_response": 0.171}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23671844573280465, "mean_inference_ms": 0.4590013225716296, "mean_action_processing_ms": 0.029163050149705317, "mean_env_wait_ms": 0.08588300658279963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1367040, "timesteps_this_iter": 4096, "agent_timesteps_total": 1367037, "timers": {"load_time_ms": 0.132, "load_throughput": 31100414.888, "learn_time_ms": 5.851, "learn_throughput": 700087.58, "update_time_ms": 1.316}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9225889444351196, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1367040, "num_agent_steps_sampled": 1367037, "num_steps_trained": 5406720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10813440, "last_target_update_ts": 1357824, "num_target_updates": 132}, "done": false, "episodes_total": 532706, "training_iteration": 1320, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-30", "timestamp": 1651739250, "time_this_iter_s": 0.4504687786102295, "time_total_s": 774.4793326854706, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 774.4793326854706, "timesteps_since_restore": 5406720, "iterations_since_restore": 1320, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.633, "episode_media": {}, "episodes_this_iter": 390, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.205, "best_response": 0.205}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23668525972956886, "mean_inference_ms": 0.4588530459661161, "mean_action_processing_ms": 0.029153453986259008, "mean_env_wait_ms": 0.08588576709884194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1377280, "timesteps_this_iter": 4096, "agent_timesteps_total": 1377277, "timers": {"load_time_ms": 0.138, "load_throughput": 29610253.678, "learn_time_ms": 6.201, "learn_throughput": 660545.711, "update_time_ms": 1.398}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8933752775192261, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1377280, "num_agent_steps_sampled": 1377277, "num_steps_trained": 5447680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10895360, "last_target_update_ts": 1368064, "num_target_updates": 133}, "done": false, "episodes_total": 536641, "training_iteration": 1330, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-36", "timestamp": 1651739256, "time_this_iter_s": 0.46219587326049805, "time_total_s": 780.4649353027344, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 780.4649353027344, "timesteps_since_restore": 5447680, "iterations_since_restore": 1330, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.493, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.217, "best_response": 0.217}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23673287915358185, "mean_inference_ms": 0.45913542960979875, "mean_action_processing_ms": 0.029156088046819163, "mean_env_wait_ms": 0.08587467049505915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1387520, "timesteps_this_iter": 4096, "agent_timesteps_total": 1387518, "timers": {"load_time_ms": 0.129, "load_throughput": 31685483.556, "learn_time_ms": 6.019, "learn_throughput": 680463.621, "update_time_ms": 1.387}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.882699728012085, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1387520, "num_agent_steps_sampled": 1387518, "num_steps_trained": 5488640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10977280, "last_target_update_ts": 1378304, "num_target_updates": 134}, "done": false, "episodes_total": 540736, "training_iteration": 1340, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-42", "timestamp": 1651739262, "time_this_iter_s": 0.48320794105529785, "time_total_s": 786.6322863101959, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 786.6322863101959, "timesteps_since_restore": 5488640, "iterations_since_restore": 1340, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.66, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.109, "best_response": 0.109}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23677058122019334, "mean_inference_ms": 0.4590249925291486, "mean_action_processing_ms": 0.02917278827460229, "mean_env_wait_ms": 0.08591502567131479, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1397760, "timesteps_this_iter": 4096, "agent_timesteps_total": 1397759, "timers": {"load_time_ms": 0.138, "load_throughput": 29692134.781, "learn_time_ms": 6.27, "learn_throughput": 653299.002, "update_time_ms": 1.345}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9228874444961548, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1397760, "num_agent_steps_sampled": 1397759, "num_steps_trained": 5529600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11059200, "last_target_update_ts": 1388544, "num_target_updates": 135}, "done": false, "episodes_total": 544657, "training_iteration": 1350, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-48", "timestamp": 1651739268, "time_this_iter_s": 0.4985966682434082, "time_total_s": 792.7537434101105, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 792.7537434101105, "timesteps_since_restore": 5529600, "iterations_since_restore": 1350, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.665, "episode_media": {}, "episodes_this_iter": 386, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.108, "best_response": 0.108}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23671784021137263, "mean_inference_ms": 0.4589351887996754, "mean_action_processing_ms": 0.029167428986680805, "mean_env_wait_ms": 0.08589571881262094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1408000, "timesteps_this_iter": 4096, "agent_timesteps_total": 1407999, "timers": {"load_time_ms": 0.13, "load_throughput": 31401698.381, "learn_time_ms": 6.241, "learn_throughput": 656268.758, "update_time_ms": 1.538}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8937031626701355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1408000, "num_agent_steps_sampled": 1407999, "num_steps_trained": 5570560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11141120, "last_target_update_ts": 1398784, "num_target_updates": 136}, "done": false, "episodes_total": 548621, "training_iteration": 1360, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-27-54", "timestamp": 1651739274, "time_this_iter_s": 0.4585096836090088, "time_total_s": 798.4848444461823, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 798.4848444461823, "timesteps_since_restore": 5570560, "iterations_since_restore": 1360, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.487, "episode_media": {}, "episodes_this_iter": 414, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.172, "best_response": 0.172}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23672610074739442, "mean_inference_ms": 0.45914902540702074, "mean_action_processing_ms": 0.029163246813324353, "mean_env_wait_ms": 0.08588096157155718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1418240, "timesteps_this_iter": 4096, "agent_timesteps_total": 1418237, "timers": {"load_time_ms": 0.13, "load_throughput": 31424673.832, "learn_time_ms": 5.686, "learn_throughput": 720405.459, "update_time_ms": 1.48}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.931824266910553, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1418240, "num_agent_steps_sampled": 1418237, "num_steps_trained": 5611520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11223040, "last_target_update_ts": 1409024, "num_target_updates": 137}, "done": false, "episodes_total": 552698, "training_iteration": 1370, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-00", "timestamp": 1651739280, "time_this_iter_s": 0.5313668251037598, "time_total_s": 804.511598110199, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 804.511598110199, "timesteps_since_restore": 5611520, "iterations_since_restore": 1370, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.486, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.141, "best_response": 0.141}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23673345280675648, "mean_inference_ms": 0.4591563460704657, "mean_action_processing_ms": 0.02915885522759235, "mean_env_wait_ms": 0.08588079052635468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1428480, "timesteps_this_iter": 4096, "agent_timesteps_total": 1428476, "timers": {"load_time_ms": 0.138, "load_throughput": 29676747.597, "learn_time_ms": 6.131, "learn_throughput": 668040.704, "update_time_ms": 1.487}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8841347694396973, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1428480, "num_agent_steps_sampled": 1428476, "num_steps_trained": 5652480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11304960, "last_target_update_ts": 1419264, "num_target_updates": 138}, "done": false, "episodes_total": 556695, "training_iteration": 1380, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-06", "timestamp": 1651739286, "time_this_iter_s": 0.47086572647094727, "time_total_s": 810.4779229164124, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 810.4779229164124, "timesteps_since_restore": 5652480, "iterations_since_restore": 1380, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.478, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.219, "best_response": 0.219}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23673300581896178, "mean_inference_ms": 0.45906165436231616, "mean_action_processing_ms": 0.029157868603903993, "mean_env_wait_ms": 0.0858787976103481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1438720, "timesteps_this_iter": 4096, "agent_timesteps_total": 1438718, "timers": {"load_time_ms": 0.129, "load_throughput": 31838156.383, "learn_time_ms": 5.535, "learn_throughput": 740058.636, "update_time_ms": 1.294}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8792885541915894, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1438720, "num_agent_steps_sampled": 1438718, "num_steps_trained": 5693440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11386880, "last_target_update_ts": 1429504, "num_target_updates": 139}, "done": false, "episodes_total": 560766, "training_iteration": 1390, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-14", "timestamp": 1651739294, "time_this_iter_s": 1.6303048133850098, "time_total_s": 817.8920645713806, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 817.8920645713806, "timesteps_since_restore": 5693440, "iterations_since_restore": 1390, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.501, "episode_media": {}, "episodes_this_iter": 412, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.198, "best_response": 0.198}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23667860434093382, "mean_inference_ms": 0.45902610286253265, "mean_action_processing_ms": 0.029145309525267064, "mean_env_wait_ms": 0.0858672970966032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1448960, "timesteps_this_iter": 4096, "agent_timesteps_total": 1448957, "timers": {"load_time_ms": 0.131, "load_throughput": 31304426.356, "learn_time_ms": 5.869, "learn_throughput": 697909.067, "update_time_ms": 1.36}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8897736668586731, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1448960, "num_agent_steps_sampled": 1448957, "num_steps_trained": 5734400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11468800, "last_target_update_ts": 1439744, "num_target_updates": 140}, "done": false, "episodes_total": 564749, "training_iteration": 1400, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-20", "timestamp": 1651739300, "time_this_iter_s": 0.46549105644226074, "time_total_s": 823.7826108932495, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 823.7826108932495, "timesteps_since_restore": 5734400, "iterations_since_restore": 1400, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.674, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.077, "best_response": 0.077}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23673304522916164, "mean_inference_ms": 0.4588256311963448, "mean_action_processing_ms": 0.029166987614880447, "mean_env_wait_ms": 0.08590545669046629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1459200, "timesteps_this_iter": 4096, "agent_timesteps_total": 1459197, "timers": {"load_time_ms": 0.136, "load_throughput": 30171881.25, "learn_time_ms": 5.835, "learn_throughput": 701938.279, "update_time_ms": 1.362}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.889081597328186, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1459200, "num_agent_steps_sampled": 1459197, "num_steps_trained": 5775360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11550720, "last_target_update_ts": 1449984, "num_target_updates": 141}, "done": false, "episodes_total": 568655, "training_iteration": 1410, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-26", "timestamp": 1651739306, "time_this_iter_s": 0.4748516082763672, "time_total_s": 829.8227620124817, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 829.8227620124817, "timesteps_since_restore": 5775360, "iterations_since_restore": 1410, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.501, "episode_media": {}, "episodes_this_iter": 404, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.122, "best_response": 0.122}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23667415374318096, "mean_inference_ms": 0.4589813555063164, "mean_action_processing_ms": 0.029143983744050115, "mean_env_wait_ms": 0.08586792306646313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1469440, "timesteps_this_iter": 4096, "agent_timesteps_total": 1469438, "timers": {"load_time_ms": 0.132, "load_throughput": 30921290.828, "learn_time_ms": 6.187, "learn_throughput": 662047.553, "update_time_ms": 1.326}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.875537097454071, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1469440, "num_agent_steps_sampled": 1469438, "num_steps_trained": 5816320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11632640, "last_target_update_ts": 1460224, "num_target_updates": 142}, "done": false, "episodes_total": 572742, "training_iteration": 1420, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-32", "timestamp": 1651739312, "time_this_iter_s": 0.5024881362915039, "time_total_s": 835.9262204170227, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 835.9262204170227, "timesteps_since_restore": 5816320, "iterations_since_restore": 1420, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.505, "episode_media": {}, "episodes_this_iter": 404, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.09, "best_response": 0.09}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23670603801882936, "mean_inference_ms": 0.4589797297866396, "mean_action_processing_ms": 0.029155730994116603, "mean_env_wait_ms": 0.08588602328979775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1479680, "timesteps_this_iter": 4096, "agent_timesteps_total": 1479676, "timers": {"load_time_ms": 0.131, "load_throughput": 31173778.233, "learn_time_ms": 5.846, "learn_throughput": 700615.763, "update_time_ms": 1.401}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8849841356277466, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1479680, "num_agent_steps_sampled": 1479676, "num_steps_trained": 5857280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11714560, "last_target_update_ts": 1470464, "num_target_updates": 143}, "done": false, "episodes_total": 576648, "training_iteration": 1430, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-38", "timestamp": 1651739318, "time_this_iter_s": 0.5011351108551025, "time_total_s": 842.1812314987183, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 842.1812314987183, "timesteps_since_restore": 5857280, "iterations_since_restore": 1430, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.493, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.152, "best_response": 0.152}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23679210361581815, "mean_inference_ms": 0.45919839058584005, "mean_action_processing_ms": 0.029168876778852586, "mean_env_wait_ms": 0.08590964125653362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1489920, "timesteps_this_iter": 4096, "agent_timesteps_total": 1489918, "timers": {"load_time_ms": 0.133, "load_throughput": 30865736.946, "learn_time_ms": 5.637, "learn_throughput": 726587.432, "update_time_ms": 1.374}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.910320520401001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1489920, "num_agent_steps_sampled": 1489918, "num_steps_trained": 5898240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11796480, "last_target_update_ts": 1480704, "num_target_updates": 144}, "done": false, "episodes_total": 580602, "training_iteration": 1440, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-44", "timestamp": 1651739324, "time_this_iter_s": 0.45327210426330566, "time_total_s": 848.3324327468872, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 848.3324327468872, "timesteps_since_restore": 5898240, "iterations_since_restore": 1440, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.508, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.15, "best_response": 0.15}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367753522422572, "mean_inference_ms": 0.4592915798703245, "mean_action_processing_ms": 0.029162982862937236, "mean_env_wait_ms": 0.08591282785717386, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1500160, "timesteps_this_iter": 4096, "agent_timesteps_total": 1500157, "timers": {"load_time_ms": 0.134, "load_throughput": 30466162.766, "learn_time_ms": 5.589, "learn_throughput": 732895.179, "update_time_ms": 1.35}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8731440901756287, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1500160, "num_agent_steps_sampled": 1500157, "num_steps_trained": 5939200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11878400, "last_target_update_ts": 1490944, "num_target_updates": 145}, "done": false, "episodes_total": 584686, "training_iteration": 1450, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-50", "timestamp": 1651739330, "time_this_iter_s": 0.44835329055786133, "time_total_s": 854.411066532135, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 854.411066532135, "timesteps_since_restore": 5939200, "iterations_since_restore": 1450, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.666, "episode_media": {}, "episodes_this_iter": 382, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.137, "best_response": 0.137}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23683238742774426, "mean_inference_ms": 0.45915149879538103, "mean_action_processing_ms": 0.029181479403834438, "mean_env_wait_ms": 0.08594486970369389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1510400, "timesteps_this_iter": 4096, "agent_timesteps_total": 1510397, "timers": {"load_time_ms": 0.137, "load_throughput": 29831340.83, "learn_time_ms": 5.908, "learn_throughput": 693323.749, "update_time_ms": 1.387}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9003954529762268, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1510400, "num_agent_steps_sampled": 1510397, "num_steps_trained": 5980160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11960320, "last_target_update_ts": 1501184, "num_target_updates": 146}, "done": false, "episodes_total": 588674, "training_iteration": 1460, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-28-57", "timestamp": 1651739337, "time_this_iter_s": 0.4635140895843506, "time_total_s": 860.5238847732544, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 860.5238847732544, "timesteps_since_restore": 5980160, "iterations_since_restore": 1460, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.523, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.099, "best_response": 0.099}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23676538584139, "mean_inference_ms": 0.4592695357328067, "mean_action_processing_ms": 0.02916070539286741, "mean_env_wait_ms": 0.08590865650468338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1520640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1520637, "timers": {"load_time_ms": 0.13, "load_throughput": 31511132.032, "learn_time_ms": 5.823, "learn_throughput": 703438.571, "update_time_ms": 1.317}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8570061326026917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1520640, "num_agent_steps_sampled": 1520637, "num_steps_trained": 6021120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12042240, "last_target_update_ts": 1511424, "num_target_updates": 147}, "done": false, "episodes_total": 592715, "training_iteration": 1470, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-03", "timestamp": 1651739343, "time_this_iter_s": 0.48018598556518555, "time_total_s": 866.6585149765015, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 866.6585149765015, "timesteps_since_restore": 6021120, "iterations_since_restore": 1470, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.689, "episode_media": {}, "episodes_this_iter": 380, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.111, "best_response": 0.111}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23687158931946456, "mean_inference_ms": 0.4590943685235965, "mean_action_processing_ms": 0.02918511688332993, "mean_env_wait_ms": 0.0859534972169989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1530880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1530876, "timers": {"load_time_ms": 0.128, "load_throughput": 32105903.913, "learn_time_ms": 5.548, "learn_throughput": 738334.788, "update_time_ms": 1.308}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.876533567905426, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1530880, "num_agent_steps_sampled": 1530876, "num_steps_trained": 6062080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12124160, "last_target_update_ts": 1521664, "num_target_updates": 148}, "done": false, "episodes_total": 596681, "training_iteration": 1480, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-09", "timestamp": 1651739349, "time_this_iter_s": 0.5067706108093262, "time_total_s": 872.6913151741028, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 872.6913151741028, "timesteps_since_restore": 6062080, "iterations_since_restore": 1480, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.497, "episode_media": {}, "episodes_this_iter": 408, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.131, "best_response": 0.131}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680705145145356, "mean_inference_ms": 0.4592832554604606, "mean_action_processing_ms": 0.029162860304782642, "mean_env_wait_ms": 0.08591113825039405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1541120, "timesteps_this_iter": 4096, "agent_timesteps_total": 1541118, "timers": {"load_time_ms": 0.132, "load_throughput": 31111679.073, "learn_time_ms": 6.174, "learn_throughput": 663405.062, "update_time_ms": 1.399}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9347606301307678, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1541120, "num_agent_steps_sampled": 1541118, "num_steps_trained": 6103040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12206080, "last_target_update_ts": 1531904, "num_target_updates": 149}, "done": false, "episodes_total": 600747, "training_iteration": 1490, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-15", "timestamp": 1651739355, "time_this_iter_s": 0.4979374408721924, "time_total_s": 878.7009923458099, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 878.7009923458099, "timesteps_since_restore": 6103040, "iterations_since_restore": 1490, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.521, "episode_media": {}, "episodes_this_iter": 416, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.209, "best_response": 0.209}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680635439792116, "mean_inference_ms": 0.45927246886428325, "mean_action_processing_ms": 0.029159142587073448, "mean_env_wait_ms": 0.08591573644860147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1551360, "timesteps_this_iter": 4096, "agent_timesteps_total": 1551359, "timers": {"load_time_ms": 0.133, "load_throughput": 30788296.029, "learn_time_ms": 5.903, "learn_throughput": 693934.257, "update_time_ms": 1.383}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9209916591644287, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1551360, "num_agent_steps_sampled": 1551359, "num_steps_trained": 6144000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12288000, "last_target_update_ts": 1542144, "num_target_updates": 150}, "done": false, "episodes_total": 604662, "training_iteration": 1500, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-21", "timestamp": 1651739361, "time_this_iter_s": 0.47179198265075684, "time_total_s": 884.6677510738373, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 884.6677510738373, "timesteps_since_restore": 6144000, "iterations_since_restore": 1500, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.663, "episode_media": {}, "episodes_this_iter": 387, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.209, "best_response": 0.209}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23679810604231608, "mean_inference_ms": 0.4590619168406433, "mean_action_processing_ms": 0.029181689699351417, "mean_env_wait_ms": 0.08594152757688689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1561600, "timesteps_this_iter": 4096, "agent_timesteps_total": 1561598, "timers": {"load_time_ms": 0.131, "load_throughput": 31156817.526, "learn_time_ms": 5.902, "learn_throughput": 693993.124, "update_time_ms": 1.385}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8690081238746643, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1561600, "num_agent_steps_sampled": 1561598, "num_steps_trained": 6184960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12369920, "last_target_update_ts": 1552384, "num_target_updates": 151}, "done": false, "episodes_total": 608608, "training_iteration": 1510, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-27", "timestamp": 1651739367, "time_this_iter_s": 0.47412633895874023, "time_total_s": 890.5911090373993, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 890.5911090373993, "timesteps_since_restore": 6184960, "iterations_since_restore": 1510, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.656, "episode_media": {}, "episodes_this_iter": 388, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.191, "best_response": 0.191}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23676764914613727, "mean_inference_ms": 0.4590588298810544, "mean_action_processing_ms": 0.029173142825298023, "mean_env_wait_ms": 0.08593265572845482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1571840, "timesteps_this_iter": 4096, "agent_timesteps_total": 1571839, "timers": {"load_time_ms": 0.138, "load_throughput": 29620464.11, "learn_time_ms": 6.549, "learn_throughput": 625397.946, "update_time_ms": 1.435}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9166686534881592, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1571840, "num_agent_steps_sampled": 1571839, "num_steps_trained": 6225920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12451840, "last_target_update_ts": 1562624, "num_target_updates": 152}, "done": false, "episodes_total": 612532, "training_iteration": 1520, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-34", "timestamp": 1651739374, "time_this_iter_s": 1.6903860569000244, "time_total_s": 897.8470814228058, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 897.8470814228058, "timesteps_since_restore": 6225920, "iterations_since_restore": 1520, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.15, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.527, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.157, "best_response": 0.157}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367246383106732, "mean_inference_ms": 0.4591164542494306, "mean_action_processing_ms": 0.029161780913337113, "mean_env_wait_ms": 0.08591256108756445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1582080, "timesteps_this_iter": 4096, "agent_timesteps_total": 1582076, "timers": {"load_time_ms": 0.13, "load_throughput": 31407439.093, "learn_time_ms": 6.121, "learn_throughput": 669219.531, "update_time_ms": 1.352}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.919048547744751, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1582080, "num_agent_steps_sampled": 1582076, "num_steps_trained": 6266880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12533760, "last_target_update_ts": 1572864, "num_target_updates": 153}, "done": false, "episodes_total": 616570, "training_iteration": 1530, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-41", "timestamp": 1651739381, "time_this_iter_s": 0.46347737312316895, "time_total_s": 903.9349548816681, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 903.9349548816681, "timesteps_since_restore": 6266880, "iterations_since_restore": 1530, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.532, "episode_media": {}, "episodes_this_iter": 413, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.252, "best_response": 0.252}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23672561069067852, "mean_inference_ms": 0.45912633383702084, "mean_action_processing_ms": 0.029152773519459083, "mean_env_wait_ms": 0.08590501989646993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1592320, "timesteps_this_iter": 4096, "agent_timesteps_total": 1592318, "timers": {"load_time_ms": 0.131, "load_throughput": 31384488.827, "learn_time_ms": 6.016, "learn_throughput": 680889.728, "update_time_ms": 1.375}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8639490008354187, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1592320, "num_agent_steps_sampled": 1592318, "num_steps_trained": 6307840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12615680, "last_target_update_ts": 1583104, "num_target_updates": 154}, "done": false, "episodes_total": 620506, "training_iteration": 1540, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-47", "timestamp": 1651739387, "time_this_iter_s": 0.5360875129699707, "time_total_s": 909.9712533950806, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 909.9712533950806, "timesteps_since_restore": 6307840, "iterations_since_restore": 1540, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.467, "episode_media": {}, "episodes_this_iter": 416, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.197, "best_response": 0.197}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367497311142092, "mean_inference_ms": 0.4592143758487422, "mean_action_processing_ms": 0.029164877297684952, "mean_env_wait_ms": 0.08590029060045869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1602560, "timesteps_this_iter": 4096, "agent_timesteps_total": 1602559, "timers": {"load_time_ms": 0.131, "load_throughput": 31236125.789, "learn_time_ms": 6.244, "learn_throughput": 655975.578, "update_time_ms": 1.425}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8441011309623718, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1602560, "num_agent_steps_sampled": 1602559, "num_steps_trained": 6348800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12697600, "last_target_update_ts": 1593344, "num_target_updates": 155}, "done": false, "episodes_total": 624479, "training_iteration": 1550, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-53", "timestamp": 1651739393, "time_this_iter_s": 0.4778141975402832, "time_total_s": 916.0554525852203, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 916.0554525852203, "timesteps_since_restore": 6348800, "iterations_since_restore": 1550, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.603, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.211, "best_response": 0.211}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367297794631396, "mean_inference_ms": 0.4591832928930136, "mean_action_processing_ms": 0.029161190857565758, "mean_env_wait_ms": 0.08591827550642099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1612800, "timesteps_this_iter": 4096, "agent_timesteps_total": 1612797, "timers": {"load_time_ms": 0.135, "load_throughput": 30299592.917, "learn_time_ms": 6.406, "learn_throughput": 639415.112, "update_time_ms": 1.367}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8942097425460815, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1612800, "num_agent_steps_sampled": 1612797, "num_steps_trained": 6389760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12779520, "last_target_update_ts": 1603584, "num_target_updates": 156}, "done": false, "episodes_total": 628449, "training_iteration": 1560, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-29-59", "timestamp": 1651739399, "time_this_iter_s": 0.5077738761901855, "time_total_s": 922.3067717552185, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 922.3067717552185, "timesteps_since_restore": 6389760, "iterations_since_restore": 1560, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.573, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.202, "best_response": 0.202}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23674340690940676, "mean_inference_ms": 0.4593054999085626, "mean_action_processing_ms": 0.029156456797292868, "mean_env_wait_ms": 0.08592407747726916, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1623040, "timesteps_this_iter": 4096, "agent_timesteps_total": 1623039, "timers": {"load_time_ms": 0.136, "load_throughput": 30108428.293, "learn_time_ms": 6.136, "learn_throughput": 667542.321, "update_time_ms": 1.571}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8753693103790283, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1623040, "num_agent_steps_sampled": 1623039, "num_steps_trained": 6430720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12861440, "last_target_update_ts": 1613824, "num_target_updates": 157}, "done": false, "episodes_total": 632506, "training_iteration": 1570, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-05", "timestamp": 1651739405, "time_this_iter_s": 0.5461633205413818, "time_total_s": 928.4179418087006, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 928.4179418087006, "timesteps_since_restore": 6430720, "iterations_since_restore": 1570, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.499, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.105, "best_response": 0.105}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367855014615049, "mean_inference_ms": 0.45938515586780115, "mean_action_processing_ms": 0.029168677232633663, "mean_env_wait_ms": 0.08591568611088102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1633280, "timesteps_this_iter": 4096, "agent_timesteps_total": 1633276, "timers": {"load_time_ms": 0.131, "load_throughput": 31355848.118, "learn_time_ms": 5.764, "learn_throughput": 710660.787, "update_time_ms": 1.332}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8971049189567566, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1633280, "num_agent_steps_sampled": 1633276, "num_steps_trained": 6471680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12943360, "last_target_update_ts": 1624064, "num_target_updates": 158}, "done": false, "episodes_total": 636514, "training_iteration": 1580, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-11", "timestamp": 1651739411, "time_this_iter_s": 0.43491363525390625, "time_total_s": 934.4543764591217, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 934.4543764591217, "timesteps_since_restore": 6471680, "iterations_since_restore": 1580, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.551, "episode_media": {}, "episodes_this_iter": 399, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.151, "best_response": 0.151}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23669716255405407, "mean_inference_ms": 0.45923684093116357, "mean_action_processing_ms": 0.0291522671412134, "mean_env_wait_ms": 0.08591315726900758, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1643520, "timesteps_this_iter": 4096, "agent_timesteps_total": 1643518, "timers": {"load_time_ms": 0.132, "load_throughput": 30949142.828, "learn_time_ms": 6.031, "learn_throughput": 679161.643, "update_time_ms": 1.361}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8825668096542358, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1643520, "num_agent_steps_sampled": 1643518, "num_steps_trained": 6512640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13025280, "last_target_update_ts": 1634304, "num_target_updates": 159}, "done": false, "episodes_total": 640463, "training_iteration": 1590, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-17", "timestamp": 1651739417, "time_this_iter_s": 0.45047831535339355, "time_total_s": 940.2557761669159, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 940.2557761669159, "timesteps_since_restore": 6512640, "iterations_since_restore": 1590, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.515, "episode_media": {}, "episodes_this_iter": 407, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.173, "best_response": 0.173}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23667361680497398, "mean_inference_ms": 0.45915321779643237, "mean_action_processing_ms": 0.029149089592651885, "mean_env_wait_ms": 0.08589951315021689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1653760, "timesteps_this_iter": 4096, "agent_timesteps_total": 1653756, "timers": {"load_time_ms": 0.132, "load_throughput": 31061054.392, "learn_time_ms": 5.727, "learn_throughput": 715208.036, "update_time_ms": 1.357}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8542386293411255, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1653760, "num_agent_steps_sampled": 1653756, "num_steps_trained": 6553600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13107200, "last_target_update_ts": 1644544, "num_target_updates": 160}, "done": false, "episodes_total": 644457, "training_iteration": 1600, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-23", "timestamp": 1651739423, "time_this_iter_s": 0.4742143154144287, "time_total_s": 946.2088179588318, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 946.2088179588318, "timesteps_since_restore": 6553600, "iterations_since_restore": 1600, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.662, "episode_media": {}, "episodes_this_iter": 384, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.25, "best_response": 0.25}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23673296931095095, "mean_inference_ms": 0.4590574137666341, "mean_action_processing_ms": 0.029177869799645366, "mean_env_wait_ms": 0.08593879577816432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1664000, "timesteps_this_iter": 4096, "agent_timesteps_total": 1663996, "timers": {"load_time_ms": 0.133, "load_throughput": 30777264.751, "learn_time_ms": 5.828, "learn_throughput": 702819.858, "update_time_ms": 1.391}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9135949611663818, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1664000, "num_agent_steps_sampled": 1663996, "num_steps_trained": 6594560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13189120, "last_target_update_ts": 1654784, "num_target_updates": 161}, "done": false, "episodes_total": 648405, "training_iteration": 1610, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-29", "timestamp": 1651739429, "time_this_iter_s": 0.4479665756225586, "time_total_s": 952.3420367240906, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 952.3420367240906, "timesteps_since_restore": 6594560, "iterations_since_restore": 1610, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 5.2, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.632, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.202, "best_response": 0.202}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23668803998502982, "mean_inference_ms": 0.45899500715874364, "mean_action_processing_ms": 0.02916476520985767, "mean_env_wait_ms": 0.08592077614814377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1674240, "timesteps_this_iter": 4096, "agent_timesteps_total": 1674238, "timers": {"load_time_ms": 0.132, "load_throughput": 31128590.658, "learn_time_ms": 6.007, "learn_throughput": 681868.014, "update_time_ms": 1.317}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.879298985004425, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1674240, "num_agent_steps_sampled": 1674238, "num_steps_trained": 6635520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13271040, "last_target_update_ts": 1665024, "num_target_updates": 162}, "done": false, "episodes_total": 652414, "training_iteration": 1620, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-36", "timestamp": 1651739436, "time_this_iter_s": 0.4630131721496582, "time_total_s": 958.3934557437897, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 958.3934557437897, "timesteps_since_restore": 6635520, "iterations_since_restore": 1620, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 5.3, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.516, "episode_media": {}, "episodes_this_iter": 403, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.149, "best_response": 0.149}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23668753056757874, "mean_inference_ms": 0.4591914308980091, "mean_action_processing_ms": 0.02915460959885018, "mean_env_wait_ms": 0.08590366669920114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1684480, "timesteps_this_iter": 4096, "agent_timesteps_total": 1684476, "timers": {"load_time_ms": 0.13, "load_throughput": 31453440.469, "learn_time_ms": 5.938, "learn_throughput": 689749.6, "update_time_ms": 1.411}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9022553563117981, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1684480, "num_agent_steps_sampled": 1684476, "num_steps_trained": 6676480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13352960, "last_target_update_ts": 1675264, "num_target_updates": 163}, "done": false, "episodes_total": 656458, "training_iteration": 1630, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-42", "timestamp": 1651739442, "time_this_iter_s": 0.536020040512085, "time_total_s": 964.513117313385, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 964.513117313385, "timesteps_since_restore": 6676480, "iterations_since_restore": 1630, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.675, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.201, "best_response": 0.201}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23672873367978775, "mean_inference_ms": 0.4589238168074548, "mean_action_processing_ms": 0.029183057185556797, "mean_env_wait_ms": 0.0859416400061266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1694720, "timesteps_this_iter": 4096, "agent_timesteps_total": 1694719, "timers": {"load_time_ms": 0.131, "load_throughput": 31367298.127, "learn_time_ms": 6.206, "learn_throughput": 659969.697, "update_time_ms": 1.33}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.899401068687439, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1694720, "num_agent_steps_sampled": 1694719, "num_steps_trained": 6717440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13434880, "last_target_update_ts": 1685504, "num_target_updates": 164}, "done": false, "episodes_total": 660372, "training_iteration": 1640, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-48", "timestamp": 1651739448, "time_this_iter_s": 0.46857118606567383, "time_total_s": 970.5100145339966, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 970.5100145339966, "timesteps_since_restore": 6717440, "iterations_since_restore": 1640, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.495, "episode_media": {}, "episodes_this_iter": 412, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.133, "best_response": 0.133}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23668095554841534, "mean_inference_ms": 0.4591699745002813, "mean_action_processing_ms": 0.0291547372109668, "mean_env_wait_ms": 0.08590019818489253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1704960, "timesteps_this_iter": 4096, "agent_timesteps_total": 1704957, "timers": {"load_time_ms": 0.128, "load_throughput": 31938778.925, "learn_time_ms": 5.807, "learn_throughput": 705411.309, "update_time_ms": 1.287}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9173855185508728, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1704960, "num_agent_steps_sampled": 1704957, "num_steps_trained": 6758400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13516800, "last_target_update_ts": 1695744, "num_target_updates": 165}, "done": false, "episodes_total": 664419, "training_iteration": 1650, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-30-55", "timestamp": 1651739455, "time_this_iter_s": 1.6629254817962646, "time_total_s": 977.9551758766174, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 977.9551758766174, "timesteps_since_restore": 6758400, "iterations_since_restore": 1650, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.516, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.207, "best_response": 0.207}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23669302776224266, "mean_inference_ms": 0.45918143021823493, "mean_action_processing_ms": 0.029155020181028335, "mean_env_wait_ms": 0.08590083110729538, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1715200, "timesteps_this_iter": 4096, "agent_timesteps_total": 1715199, "timers": {"load_time_ms": 0.13, "load_throughput": 31436174.17, "learn_time_ms": 5.987, "learn_throughput": 684113.52, "update_time_ms": 1.307}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9000902771949768, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1715200, "num_agent_steps_sampled": 1715199, "num_steps_trained": 6799360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13598720, "last_target_update_ts": 1705984, "num_target_updates": 166}, "done": false, "episodes_total": 668390, "training_iteration": 1660, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-02", "timestamp": 1651739462, "time_this_iter_s": 0.5064661502838135, "time_total_s": 984.534854888916, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 984.534854888916, "timesteps_since_restore": 6799360, "iterations_since_restore": 1660, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.503, "episode_media": {}, "episodes_this_iter": 404, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.16, "best_response": 0.16}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23673996241140288, "mean_inference_ms": 0.45919863051778465, "mean_action_processing_ms": 0.029157677741909405, "mean_env_wait_ms": 0.08590293438822666, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1725440, "timesteps_this_iter": 4096, "agent_timesteps_total": 1725438, "timers": {"load_time_ms": 0.132, "load_throughput": 31128590.658, "learn_time_ms": 6.045, "learn_throughput": 677634.697, "update_time_ms": 1.328}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9438390731811523, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1725440, "num_agent_steps_sampled": 1725438, "num_steps_trained": 6840320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13680640, "last_target_update_ts": 1716224, "num_target_updates": 167}, "done": false, "episodes_total": 672509, "training_iteration": 1670, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-08", "timestamp": 1651739468, "time_this_iter_s": 0.4869544506072998, "time_total_s": 990.6022915840149, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 990.6022915840149, "timesteps_since_restore": 6840320, "iterations_since_restore": 1670, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.494, "episode_media": {}, "episodes_this_iter": 412, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.201, "best_response": 0.201}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23678193935200095, "mean_inference_ms": 0.4592953361519295, "mean_action_processing_ms": 0.029164781130475836, "mean_env_wait_ms": 0.08591222676543417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1735680, "timesteps_this_iter": 4096, "agent_timesteps_total": 1735677, "timers": {"load_time_ms": 0.141, "load_throughput": 29049491.349, "learn_time_ms": 6.374, "learn_throughput": 642634.492, "update_time_ms": 1.419}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9101287126541138, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1735680, "num_agent_steps_sampled": 1735677, "num_steps_trained": 6881280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13762560, "last_target_update_ts": 1726464, "num_target_updates": 168}, "done": false, "episodes_total": 676579, "training_iteration": 1680, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-14", "timestamp": 1651739474, "time_this_iter_s": 0.4791738986968994, "time_total_s": 996.8515000343323, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 996.8515000343323, "timesteps_since_restore": 6881280, "iterations_since_restore": 1680, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.675, "episode_media": {}, "episodes_this_iter": 383, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.184, "best_response": 0.184}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23678275206713464, "mean_inference_ms": 0.45908556511965104, "mean_action_processing_ms": 0.02917882219147427, "mean_env_wait_ms": 0.0859383973376234, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1745920, "timesteps_this_iter": 4096, "agent_timesteps_total": 1745918, "timers": {"load_time_ms": 0.13, "load_throughput": 31470725.745, "learn_time_ms": 5.916, "learn_throughput": 692384.884, "update_time_ms": 1.268}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8881545066833496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1745920, "num_agent_steps_sampled": 1745918, "num_steps_trained": 6922240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13844480, "last_target_update_ts": 1736704, "num_target_updates": 169}, "done": false, "episodes_total": 680523, "training_iteration": 1690, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-21", "timestamp": 1651739481, "time_this_iter_s": 0.5596568584442139, "time_total_s": 1003.0493340492249, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1003.0493340492249, "timesteps_since_restore": 6922240, "iterations_since_restore": 1690, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.614, "episode_media": {}, "episodes_this_iter": 385, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.052, "best_response": 0.052}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23675147177809525, "mean_inference_ms": 0.45914678661100256, "mean_action_processing_ms": 0.029162982188261417, "mean_env_wait_ms": 0.08592915965631201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1756160, "timesteps_this_iter": 4096, "agent_timesteps_total": 1756156, "timers": {"load_time_ms": 0.132, "load_throughput": 31122951.42, "learn_time_ms": 5.968, "learn_throughput": 686321.766, "update_time_ms": 1.414}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8846849203109741, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1756160, "num_agent_steps_sampled": 1756156, "num_steps_trained": 6963200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13926400, "last_target_update_ts": 1746944, "num_target_updates": 170}, "done": false, "episodes_total": 684496, "training_iteration": 1700, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-27", "timestamp": 1651739487, "time_this_iter_s": 0.481273889541626, "time_total_s": 1009.1699695587158, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1009.1699695587158, "timesteps_since_restore": 6963200, "iterations_since_restore": 1700, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.513, "episode_media": {}, "episodes_this_iter": 406, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.177, "best_response": 0.177}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367158142010486, "mean_inference_ms": 0.4592402038836227, "mean_action_processing_ms": 0.029153459870455437, "mean_env_wait_ms": 0.08590309683550282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1766400, "timesteps_this_iter": 4096, "agent_timesteps_total": 1766399, "timers": {"load_time_ms": 0.131, "load_throughput": 31281626.336, "learn_time_ms": 6.295, "learn_throughput": 650710.719, "update_time_ms": 1.419}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9009612202644348, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1766400, "num_agent_steps_sampled": 1766399, "num_steps_trained": 7004160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14008320, "last_target_update_ts": 1757184, "num_target_updates": 171}, "done": false, "episodes_total": 688496, "training_iteration": 1710, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-33", "timestamp": 1651739493, "time_this_iter_s": 0.5087335109710693, "time_total_s": 1015.2369666099548, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1015.2369666099548, "timesteps_since_restore": 7004160, "iterations_since_restore": 1710, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 6.6, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.503, "episode_media": {}, "episodes_this_iter": 411, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.148, "best_response": 0.148}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23678604688991656, "mean_inference_ms": 0.4592852224329951, "mean_action_processing_ms": 0.029169772278155672, "mean_env_wait_ms": 0.08592590380390355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1776640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1776637, "timers": {"load_time_ms": 0.139, "load_throughput": 29432703.759, "learn_time_ms": 6.059, "learn_throughput": 675973.606, "update_time_ms": 1.42}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.8877925276756287, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1776640, "num_agent_steps_sampled": 1776637, "num_steps_trained": 7045120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14090240, "last_target_update_ts": 1767424, "num_target_updates": 172}, "done": false, "episodes_total": 692491, "training_iteration": 1720, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-39", "timestamp": 1651739499, "time_this_iter_s": 0.5255639553070068, "time_total_s": 1021.5596976280212, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1021.5596976280212, "timesteps_since_restore": 7045120, "iterations_since_restore": 1720, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.48, "episode_media": {}, "episodes_this_iter": 413, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.186, "best_response": 0.186}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680645160206426, "mean_inference_ms": 0.45931693431862425, "mean_action_processing_ms": 0.02916910362958852, "mean_env_wait_ms": 0.08592662263068172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1786880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1786879, "timers": {"load_time_ms": 0.132, "load_throughput": 30932425.61, "learn_time_ms": 5.647, "learn_throughput": 725323.577, "update_time_ms": 1.353}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.898264467716217, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1786880, "num_agent_steps_sampled": 1786879, "num_steps_trained": 7086080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14172160, "last_target_update_ts": 1777664, "num_target_updates": 173}, "done": false, "episodes_total": 696464, "training_iteration": 1730, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-46", "timestamp": 1651739506, "time_this_iter_s": 0.531968355178833, "time_total_s": 1027.6798429489136, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1027.6798429489136, "timesteps_since_restore": 7086080, "iterations_since_restore": 1730, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.5, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.167, "episode_media": {}, "episodes_this_iter": 471, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": 0.019, "best_response": -0.019}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23698125715055499, "mean_inference_ms": 0.45908951058562636, "mean_action_processing_ms": 0.02918101695959159, "mean_env_wait_ms": 0.08591252455092616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1797120, "timesteps_this_iter": 4096, "agent_timesteps_total": 1797116, "timers": {"load_time_ms": 0.132, "load_throughput": 30921290.828, "learn_time_ms": 5.731, "learn_throughput": 714752.775, "update_time_ms": 1.363}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9219127297401428, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1797120, "num_agent_steps_sampled": 1797116, "num_steps_trained": 7127040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14254080, "last_target_update_ts": 1787904, "num_target_updates": 174}, "done": false, "episodes_total": 700705, "training_iteration": 1740, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-52", "timestamp": 1651739512, "time_this_iter_s": 0.47048282623291016, "time_total_s": 1033.8333489894867, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1033.8333489894867, "timesteps_since_restore": 7127040, "iterations_since_restore": 1740, "warmup_time": 1.5560460090637207, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.501, "episode_media": {}, "episodes_this_iter": 410, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.167, "best_response": 0.167}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23682724973109687, "mean_inference_ms": 0.45921721958475514, "mean_action_processing_ms": 0.02916041001312179, "mean_env_wait_ms": 0.08592049020893955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1807360, "timesteps_this_iter": 4096, "agent_timesteps_total": 1807359, "timers": {"load_time_ms": 0.132, "load_throughput": 31055439.595, "learn_time_ms": 5.598, "learn_throughput": 731634.231, "update_time_ms": 1.317}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.9013398885726929, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1807360, "num_agent_steps_sampled": 1807359, "num_steps_trained": 7168000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14336000, "last_target_update_ts": 1798144, "num_target_updates": 175}, "done": false, "episodes_total": 704720, "training_iteration": 1750, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-31-58", "timestamp": 1651739518, "time_this_iter_s": 0.4931004047393799, "time_total_s": 1040.055176973343, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1040.055176973343, "timesteps_since_restore": 7168000, "iterations_since_restore": 1750, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.509, "episode_media": {}, "episodes_this_iter": 405, "policy_reward_min": {"metanash": -2.0, "best_response": -2.0}, "policy_reward_max": {"metanash": 2.0, "best_response": 2.0}, "policy_reward_mean": {"metanash": -0.144, "best_response": 0.144}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23681322210490852, "mean_inference_ms": 0.45914861369393595, "mean_action_processing_ms": 0.029153289095810338, "mean_env_wait_ms": 0.0859135619436942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1817600, "timesteps_this_iter": 4096, "agent_timesteps_total": 1817597, "timers": {"load_time_ms": 0.134, "load_throughput": 30612739.102, "learn_time_ms": 5.84, "learn_throughput": 701390.92, "update_time_ms": 1.352}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.941498875617981, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1817600, "num_agent_steps_sampled": 1817597, "num_steps_trained": 7208960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14417920, "last_target_update_ts": 1808384, "num_target_updates": 176}, "done": false, "episodes_total": 708819, "training_iteration": 1760, "trial_id": "default", "experiment_id": "bc3a8da5607641b2a2c44a68c9b912ba", "date": "2022-05-05_16-32-04", "timestamp": 1651739524, "time_this_iter_s": 0.4705479145050049, "time_total_s": 1046.2722337245941, "pid": 2851445, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7f7bbc2d9550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1046.2722337245941, "timesteps_since_restore": 7208960, "iterations_since_restore": 1760, "warmup_time": 1.5560460090637207, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
