{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.628, "episode_media": {}, "episodes_this_iter": 391, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": -0.142, "metanash": 0.142}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21501381262530134, "mean_inference_ms": 0.4252430721672128, "mean_action_processing_ms": 0.027934641835327796, "mean_env_wait_ms": 0.08187540016403697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 25600, "timesteps_this_iter": 4096, "agent_timesteps_total": 25599, "timers": {"load_time_ms": 0.136, "load_throughput": 30013747.701, "learn_time_ms": 6.649, "learn_throughput": 616037.507, "update_time_ms": 1.321}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 1.0343130826950073, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 25600, "num_agent_steps_sampled": 25599, "num_steps_trained": 40960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 81920, "last_target_update_ts": 16384, "num_target_updates": 1}, "done": false, "episodes_total": 9508, "training_iteration": 10, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-14-44", "timestamp": 1651738484, "time_this_iter_s": 0.4144599437713623, "time_total_s": 9.094865798950195, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 9.094865798950195, "timesteps_since_restore": 40960, "iterations_since_restore": 10, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.35, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.077, "metanash": -0.077}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22616326247972177, "mean_inference_ms": 0.4297696544817718, "mean_action_processing_ms": 0.02829300121687866, "mean_env_wait_ms": 0.08316866514605008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 35840, "timesteps_this_iter": 4096, "agent_timesteps_total": 35836, "timers": {"load_time_ms": 0.133, "load_throughput": 30782779.402, "learn_time_ms": 6.153, "learn_throughput": 665646.46, "update_time_ms": 1.354}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.6981297135353088, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 35840, "num_agent_steps_sampled": 35836, "num_steps_trained": 81920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 163840, "last_target_update_ts": 26624, "num_target_updates": 2}, "done": false, "episodes_total": 13858, "training_iteration": 20, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-14-50", "timestamp": 1651738490, "time_this_iter_s": 0.6202929019927979, "time_total_s": 14.644091606140137, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 14.644091606140137, "timesteps_since_restore": 81920, "iterations_since_restore": 20, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.353, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.09, "metanash": -0.09}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23444675156094621, "mean_inference_ms": 0.43614462136321813, "mean_action_processing_ms": 0.028732107673986092, "mean_env_wait_ms": 0.08443699253353924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 46080, "timesteps_this_iter": 4096, "agent_timesteps_total": 46077, "timers": {"load_time_ms": 0.134, "load_throughput": 30498613.854, "learn_time_ms": 5.825, "learn_throughput": 703231.253, "update_time_ms": 1.319}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.6086568832397461, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 46080, "num_agent_steps_sampled": 46077, "num_steps_trained": 122880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 245760, "last_target_update_ts": 36864, "num_target_updates": 3}, "done": false, "episodes_total": 18215, "training_iteration": 30, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-14-55", "timestamp": 1651738495, "time_this_iter_s": 0.43935251235961914, "time_total_s": 19.989381313323975, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 19.989381313323975, "timesteps_since_restore": 122880, "iterations_since_restore": 30, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.351, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.106, "metanash": -0.106}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23861059370925042, "mean_inference_ms": 0.43902178516757967, "mean_action_processing_ms": 0.028917302161898292, "mean_env_wait_ms": 0.08507825714679074, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 56320, "timesteps_this_iter": 4096, "agent_timesteps_total": 56318, "timers": {"load_time_ms": 0.139, "load_throughput": 29503467.601, "learn_time_ms": 6.178, "learn_throughput": 663046.61, "update_time_ms": 1.424}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.5796259045600891, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 56320, "num_agent_steps_sampled": 56318, "num_steps_trained": 163840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 327680, "last_target_update_ts": 47104, "num_target_updates": 4}, "done": false, "episodes_total": 22542, "training_iteration": 40, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-01", "timestamp": 1651738501, "time_this_iter_s": 0.6902105808258057, "time_total_s": 25.686595678329468, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 25.686595678329468, "timesteps_since_restore": 163840, "iterations_since_restore": 40, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 4.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.357, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.24, "metanash": -0.24}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24223766122845394, "mean_inference_ms": 0.4418553910283101, "mean_action_processing_ms": 0.029082589038461795, "mean_env_wait_ms": 0.08567050556050394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 66560, "timesteps_this_iter": 4096, "agent_timesteps_total": 66557, "timers": {"load_time_ms": 0.134, "load_throughput": 30498613.854, "learn_time_ms": 6.158, "learn_throughput": 665143.916, "update_time_ms": 1.341}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.5294138193130493, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 66560, "num_agent_steps_sampled": 66557, "num_steps_trained": 204800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 409600, "last_target_update_ts": 57344, "num_target_updates": 5}, "done": false, "episodes_total": 26879, "training_iteration": 50, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-06", "timestamp": 1651738506, "time_this_iter_s": 0.4412190914154053, "time_total_s": 31.303248167037964, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 31.303248167037964, "timesteps_since_restore": 204800, "iterations_since_restore": 50, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 4.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.337, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.166, "metanash": -0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24463592903107684, "mean_inference_ms": 0.44322200872075873, "mean_action_processing_ms": 0.029175832582343457, "mean_env_wait_ms": 0.08598931782014221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76800, "timesteps_this_iter": 4096, "agent_timesteps_total": 76798, "timers": {"load_time_ms": 0.136, "load_throughput": 30219646.762, "learn_time_ms": 6.122, "learn_throughput": 669084.002, "update_time_ms": 1.319}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.5165453553199768, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76798, "num_steps_trained": 245760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 491520, "last_target_update_ts": 67584, "num_target_updates": 6}, "done": false, "episodes_total": 31222, "training_iteration": 60, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-12", "timestamp": 1651738512, "time_this_iter_s": 0.48216915130615234, "time_total_s": 36.87034869194031, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 36.87034869194031, "timesteps_since_restore": 245760, "iterations_since_restore": 60, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.326, "episode_media": {}, "episodes_this_iter": 443, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.168, "metanash": -0.168}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24581232460524982, "mean_inference_ms": 0.44294183152586936, "mean_action_processing_ms": 0.029143337798392562, "mean_env_wait_ms": 0.08599884098903707, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 87040, "timesteps_this_iter": 4096, "agent_timesteps_total": 87038, "timers": {"load_time_ms": 0.134, "load_throughput": 30520286.346, "learn_time_ms": 6.225, "learn_throughput": 658025.8, "update_time_ms": 1.371}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.5123709440231323, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 87040, "num_agent_steps_sampled": 87038, "num_steps_trained": 286720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 573440, "last_target_update_ts": 77824, "num_target_updates": 7}, "done": false, "episodes_total": 35610, "training_iteration": 70, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-18", "timestamp": 1651738518, "time_this_iter_s": 0.4541327953338623, "time_total_s": 42.3297381401062, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 42.3297381401062, "timesteps_since_restore": 286720, "iterations_since_restore": 70, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.313, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.097, "metanash": -0.097}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24618073474351188, "mean_inference_ms": 0.442022694697609, "mean_action_processing_ms": 0.029090936345021613, "mean_env_wait_ms": 0.08589544702477733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 97280, "timesteps_this_iter": 4096, "agent_timesteps_total": 97279, "timers": {"load_time_ms": 0.133, "load_throughput": 30782779.402, "learn_time_ms": 6.226, "learn_throughput": 657839.344, "update_time_ms": 1.311}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.5107861757278442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 97280, "num_agent_steps_sampled": 97279, "num_steps_trained": 327680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 655360, "last_target_update_ts": 88064, "num_target_updates": 8}, "done": false, "episodes_total": 39997, "training_iteration": 80, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-23", "timestamp": 1651738523, "time_this_iter_s": 0.741309642791748, "time_total_s": 47.97366523742676, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 47.97366523742676, "timesteps_since_restore": 327680, "iterations_since_restore": 80, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.336, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.181, "metanash": -0.181}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24717610191729905, "mean_inference_ms": 0.44244205423276967, "mean_action_processing_ms": 0.02907901827960491, "mean_env_wait_ms": 0.08594537918010815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 107520, "timesteps_this_iter": 4096, "agent_timesteps_total": 107517, "timers": {"load_time_ms": 0.135, "load_throughput": 30444567.046, "learn_time_ms": 6.031, "learn_throughput": 679150.904, "update_time_ms": 1.267}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.49338266253471375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 107520, "num_agent_steps_sampled": 107517, "num_steps_trained": 368640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 737280, "last_target_update_ts": 98304, "num_target_updates": 9}, "done": false, "episodes_total": 44375, "training_iteration": 90, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-29", "timestamp": 1651738529, "time_this_iter_s": 0.7933449745178223, "time_total_s": 53.86706209182739, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 53.86706209182739, "timesteps_since_restore": 368640, "iterations_since_restore": 90, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 4.7}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.336, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.148, "metanash": -0.148}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24711891818767082, "mean_inference_ms": 0.44341441078149624, "mean_action_processing_ms": 0.029000808802015138, "mean_env_wait_ms": 0.08577064248056084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 117760, "timesteps_this_iter": 4096, "agent_timesteps_total": 117758, "timers": {"load_time_ms": 0.136, "load_throughput": 30134834.562, "learn_time_ms": 6.064, "learn_throughput": 675468.632, "update_time_ms": 1.299}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.48412349820137024, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 117760, "num_agent_steps_sampled": 117758, "num_steps_trained": 409600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 819200, "last_target_update_ts": 108544, "num_target_updates": 10}, "done": false, "episodes_total": 48755, "training_iteration": 100, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-35", "timestamp": 1651738535, "time_this_iter_s": 0.4523787498474121, "time_total_s": 59.34338188171387, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 59.34338188171387, "timesteps_since_restore": 409600, "iterations_since_restore": 100, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.357, "episode_media": {}, "episodes_this_iter": 431, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.203, "metanash": -0.203}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2469103696332157, "mean_inference_ms": 0.44200717006176243, "mean_action_processing_ms": 0.028926878261403832, "mean_env_wait_ms": 0.08560154140852061, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 128000, "timesteps_this_iter": 4096, "agent_timesteps_total": 127998, "timers": {"load_time_ms": 0.134, "load_throughput": 30552852.897, "learn_time_ms": 5.904, "learn_throughput": 693715.695, "update_time_ms": 1.423}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.48959752917289734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 127998, "num_steps_trained": 450560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 901120, "last_target_update_ts": 118784, "num_target_updates": 11}, "done": false, "episodes_total": 53130, "training_iteration": 110, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-41", "timestamp": 1651738541, "time_this_iter_s": 0.7497668266296387, "time_total_s": 65.10162329673767, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 65.10162329673767, "timesteps_since_restore": 450560, "iterations_since_restore": 110, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 4.8}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.356, "episode_media": {}, "episodes_this_iter": 431, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.209, "metanash": -0.209}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24859057556706957, "mean_inference_ms": 0.44386958189366205, "mean_action_processing_ms": 0.02905369098623211, "mean_env_wait_ms": 0.08596659215072505, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 138240, "timesteps_this_iter": 4096, "agent_timesteps_total": 138236, "timers": {"load_time_ms": 0.135, "load_throughput": 30444567.046, "learn_time_ms": 6.282, "learn_throughput": 652027.037, "update_time_ms": 1.369}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.48104846477508545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 138240, "num_agent_steps_sampled": 138236, "num_steps_trained": 491520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 983040, "last_target_update_ts": 129024, "num_target_updates": 12}, "done": false, "episodes_total": 57509, "training_iteration": 120, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-46", "timestamp": 1651738546, "time_this_iter_s": 0.49794769287109375, "time_total_s": 70.69255375862122, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 70.69255375862122, "timesteps_since_restore": 491520, "iterations_since_restore": 120, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.315, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.1, "metanash": -0.1}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24869322848742148, "mean_inference_ms": 0.44307687557371, "mean_action_processing_ms": 0.029016615226752612, "mean_env_wait_ms": 0.08589986844896523, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148480, "timesteps_this_iter": 4096, "agent_timesteps_total": 148480, "timers": {"load_time_ms": 0.133, "load_throughput": 30843571.246, "learn_time_ms": 5.844, "learn_throughput": 700913.037, "update_time_ms": 1.284}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.47836703062057495, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 148480, "num_agent_steps_sampled": 148480, "num_steps_trained": 532480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1064960, "last_target_update_ts": 139264, "num_target_updates": 13}, "done": false, "episodes_total": 61912, "training_iteration": 130, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-52", "timestamp": 1651738552, "time_this_iter_s": 0.48771142959594727, "time_total_s": 76.43588280677795, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 76.43588280677795, "timesteps_since_restore": 532480, "iterations_since_restore": 130, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.336, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.157, "metanash": -0.157}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24870113926152979, "mean_inference_ms": 0.4426316854079693, "mean_action_processing_ms": 0.02900182720189882, "mean_env_wait_ms": 0.08587168956276785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 158720, "timesteps_this_iter": 4096, "agent_timesteps_total": 158718, "timers": {"load_time_ms": 0.134, "load_throughput": 30661911.804, "learn_time_ms": 5.935, "learn_throughput": 690201.284, "update_time_ms": 1.366}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4734085500240326, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 158720, "num_agent_steps_sampled": 158718, "num_steps_trained": 573440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1146880, "last_target_update_ts": 149504, "num_target_updates": 14}, "done": false, "episodes_total": 66282, "training_iteration": 140, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-15-58", "timestamp": 1651738558, "time_this_iter_s": 0.46759676933288574, "time_total_s": 81.92231917381287, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 81.92231917381287, "timesteps_since_restore": 573440, "iterations_since_restore": 140, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 9.4, "ram_util_percent": 4.9}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.346, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.208, "metanash": -0.208}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24881431033342005, "mean_inference_ms": 0.4422542796773456, "mean_action_processing_ms": 0.02898487797058182, "mean_env_wait_ms": 0.08585205659205619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 168960, "timesteps_this_iter": 4096, "agent_timesteps_total": 168957, "timers": {"load_time_ms": 0.134, "load_throughput": 30547420.313, "learn_time_ms": 6.124, "learn_throughput": 668826.127, "update_time_ms": 1.423}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4608355164527893, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 168960, "num_agent_steps_sampled": 168957, "num_steps_trained": 614400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1228800, "last_target_update_ts": 159744, "num_target_updates": 15}, "done": false, "episodes_total": 70661, "training_iteration": 150, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-03", "timestamp": 1651738563, "time_this_iter_s": 0.8203344345092773, "time_total_s": 87.6761360168457, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 87.6761360168457, "timesteps_since_restore": 614400, "iterations_since_restore": 150, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.1, "ram_util_percent": 4.9}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.323, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.137, "metanash": -0.137}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24891455335498391, "mean_inference_ms": 0.441926824299877, "mean_action_processing_ms": 0.02897384667940046, "mean_env_wait_ms": 0.08583512666804799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 179200, "timesteps_this_iter": 4096, "agent_timesteps_total": 179198, "timers": {"load_time_ms": 0.133, "load_throughput": 30843571.246, "learn_time_ms": 6.09, "learn_throughput": 672557.232, "update_time_ms": 1.494}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4600452184677124, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 179200, "num_agent_steps_sampled": 179198, "num_steps_trained": 655360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1310720, "last_target_update_ts": 169984, "num_target_updates": 16}, "done": false, "episodes_total": 75029, "training_iteration": 160, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-09", "timestamp": 1651738569, "time_this_iter_s": 0.4751114845275879, "time_total_s": 93.23587274551392, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 93.23587274551392, "timesteps_since_restore": 655360, "iterations_since_restore": 160, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.4, "ram_util_percent": 4.9}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.343, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.162, "metanash": -0.162}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24884179044011617, "mean_inference_ms": 0.4412908305619351, "mean_action_processing_ms": 0.028936373520402434, "mean_env_wait_ms": 0.08573761209434122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 189440, "timesteps_this_iter": 4096, "agent_timesteps_total": 189439, "timers": {"load_time_ms": 0.135, "load_throughput": 30283569.864, "learn_time_ms": 6.111, "learn_throughput": 670321.436, "update_time_ms": 1.282}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.45877504348754883, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 189440, "num_agent_steps_sampled": 189439, "num_steps_trained": 696320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1392640, "last_target_update_ts": 180224, "num_target_updates": 17}, "done": false, "episodes_total": 79402, "training_iteration": 170, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-15", "timestamp": 1651738575, "time_this_iter_s": 0.46325063705444336, "time_total_s": 98.79567909240723, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 98.79567909240723, "timesteps_since_restore": 696320, "iterations_since_restore": 170, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.305, "episode_media": {}, "episodes_this_iter": 445, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.113, "metanash": -0.113}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24945155007264372, "mean_inference_ms": 0.4415285115460509, "mean_action_processing_ms": 0.02896000760904814, "mean_env_wait_ms": 0.08581314967741813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 199680, "timesteps_this_iter": 4096, "agent_timesteps_total": 199678, "timers": {"load_time_ms": 0.137, "load_throughput": 29805463.539, "learn_time_ms": 5.908, "learn_throughput": 693267.793, "update_time_ms": 1.331}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.46061229705810547, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 199680, "num_agent_steps_sampled": 199678, "num_steps_trained": 737280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1474560, "last_target_update_ts": 190464, "num_target_updates": 18}, "done": false, "episodes_total": 83806, "training_iteration": 180, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-20", "timestamp": 1651738580, "time_this_iter_s": 0.44318532943725586, "time_total_s": 104.29265785217285, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 104.29265785217285, "timesteps_since_restore": 737280, "iterations_since_restore": 180, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.6, "ram_util_percent": 5.0}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.377, "episode_media": {}, "episodes_this_iter": 433, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.278, "metanash": -0.278}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24929932496710286, "mean_inference_ms": 0.44096093642861384, "mean_action_processing_ms": 0.028920623599433207, "mean_env_wait_ms": 0.08570995030879609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 209920, "timesteps_this_iter": 4096, "agent_timesteps_total": 209917, "timers": {"load_time_ms": 0.141, "load_throughput": 28966226.916, "learn_time_ms": 6.127, "learn_throughput": 668539.832, "update_time_ms": 1.338}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.46294325590133667, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 209920, "num_agent_steps_sampled": 209917, "num_steps_trained": 778240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1556480, "last_target_update_ts": 200704, "num_target_updates": 19}, "done": false, "episodes_total": 88178, "training_iteration": 190, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-26", "timestamp": 1651738586, "time_this_iter_s": 0.5472640991210938, "time_total_s": 109.92455244064331, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 109.92455244064331, "timesteps_since_restore": 778240, "iterations_since_restore": 190, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.339, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.178, "metanash": -0.178}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24959312210847298, "mean_inference_ms": 0.4420904944436204, "mean_action_processing_ms": 0.02894178200051701, "mean_env_wait_ms": 0.08577120181448435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 220160, "timesteps_this_iter": 4096, "agent_timesteps_total": 220156, "timers": {"load_time_ms": 0.143, "load_throughput": 28628343.916, "learn_time_ms": 6.043, "learn_throughput": 677837.893, "update_time_ms": 1.312}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.46076056361198425, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 220160, "num_agent_steps_sampled": 220156, "num_steps_trained": 819200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1638400, "last_target_update_ts": 210944, "num_target_updates": 20}, "done": false, "episodes_total": 92549, "training_iteration": 200, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-32", "timestamp": 1651738592, "time_this_iter_s": 0.5111308097839355, "time_total_s": 115.71366739273071, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 115.71366739273071, "timesteps_since_restore": 819200, "iterations_since_restore": 200, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.35, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.221, "metanash": -0.221}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2498877994744221, "mean_inference_ms": 0.4424279117444016, "mean_action_processing_ms": 0.02894838028738366, "mean_env_wait_ms": 0.08578538943797451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 230400, "timesteps_this_iter": 4096, "agent_timesteps_total": 230398, "timers": {"load_time_ms": 0.135, "load_throughput": 30288908.999, "learn_time_ms": 6.083, "learn_throughput": 673308.454, "update_time_ms": 1.366}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.436936616897583, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 230398, "num_steps_trained": 860160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1720320, "last_target_update_ts": 221184, "num_target_updates": 21}, "done": false, "episodes_total": 96932, "training_iteration": 210, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-37", "timestamp": 1651738597, "time_this_iter_s": 0.4472949504852295, "time_total_s": 121.33148169517517, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 121.33148169517517, "timesteps_since_restore": 860160, "iterations_since_restore": 210, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 5.1}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.34, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.225, "metanash": -0.225}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24991278908902348, "mean_inference_ms": 0.4420780518774581, "mean_action_processing_ms": 0.028931984721918966, "mean_env_wait_ms": 0.0857569949629105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 240640, "timesteps_this_iter": 4096, "agent_timesteps_total": 240640, "timers": {"load_time_ms": 0.137, "load_throughput": 29924872.294, "learn_time_ms": 6.396, "learn_throughput": 640370.851, "update_time_ms": 1.273}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4563118815422058, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 240640, "num_agent_steps_sampled": 240640, "num_steps_trained": 901120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1802240, "last_target_update_ts": 231424, "num_target_updates": 22}, "done": false, "episodes_total": 101318, "training_iteration": 220, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-43", "timestamp": 1651738603, "time_this_iter_s": 0.47174644470214844, "time_total_s": 127.13976001739502, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 127.13976001739502, "timesteps_since_restore": 901120, "iterations_since_restore": 220, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 5.1}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.347, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.208, "metanash": -0.208}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24996590864358892, "mean_inference_ms": 0.441758775718557, "mean_action_processing_ms": 0.02891463643589044, "mean_env_wait_ms": 0.08572237692053855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 250880, "timesteps_this_iter": 4096, "agent_timesteps_total": 250877, "timers": {"load_time_ms": 0.137, "load_throughput": 29909243.008, "learn_time_ms": 6.084, "learn_throughput": 673253.043, "update_time_ms": 1.319}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.45840755105018616, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 250880, "num_agent_steps_sampled": 250877, "num_steps_trained": 942080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1884160, "last_target_update_ts": 241664, "num_target_updates": 23}, "done": false, "episodes_total": 105703, "training_iteration": 230, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-49", "timestamp": 1651738609, "time_this_iter_s": 0.4532642364501953, "time_total_s": 132.33370804786682, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 132.33370804786682, "timesteps_since_restore": 942080, "iterations_since_restore": 230, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.339, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.162, "metanash": -0.162}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25037936024132945, "mean_inference_ms": 0.4420796801430424, "mean_action_processing_ms": 0.028941681371304328, "mean_env_wait_ms": 0.08579530145691035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 261120, "timesteps_this_iter": 4096, "agent_timesteps_total": 261117, "timers": {"load_time_ms": 0.139, "load_throughput": 29392419.476, "learn_time_ms": 6.024, "learn_throughput": 679895.41, "update_time_ms": 1.386}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4489676356315613, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 261120, "num_agent_steps_sampled": 261117, "num_steps_trained": 983040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 1966080, "last_target_update_ts": 251904, "num_target_updates": 24}, "done": false, "episodes_total": 110091, "training_iteration": 240, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-16-55", "timestamp": 1651738615, "time_this_iter_s": 0.4383575916290283, "time_total_s": 138.3269944190979, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 138.3269944190979, "timesteps_since_restore": 983040, "iterations_since_restore": 240, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 9.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.356, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.203, "metanash": -0.203}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25110374720360246, "mean_inference_ms": 0.4430324106456241, "mean_action_processing_ms": 0.029012272195485637, "mean_env_wait_ms": 0.08596644409082169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 271360, "timesteps_this_iter": 4096, "agent_timesteps_total": 271358, "timers": {"load_time_ms": 0.136, "load_throughput": 30061013.445, "learn_time_ms": 5.738, "learn_throughput": 713811.366, "update_time_ms": 1.352}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4468553066253662, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 271360, "num_agent_steps_sampled": 271358, "num_steps_trained": 1024000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2048000, "last_target_update_ts": 262144, "num_target_updates": 25}, "done": false, "episodes_total": 114494, "training_iteration": 250, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-01", "timestamp": 1651738621, "time_this_iter_s": 0.4748525619506836, "time_total_s": 144.46335315704346, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 144.46335315704346, "timesteps_since_restore": 1024000, "iterations_since_restore": 250, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.344, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.195, "metanash": -0.195}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25138211884662387, "mean_inference_ms": 0.44323550402318224, "mean_action_processing_ms": 0.029035253630450317, "mean_env_wait_ms": 0.08602554514799202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 281600, "timesteps_this_iter": 4096, "agent_timesteps_total": 281599, "timers": {"load_time_ms": 0.137, "load_throughput": 29898832.551, "learn_time_ms": 5.901, "learn_throughput": 694152.957, "update_time_ms": 1.318}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43059852719306946, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 281600, "num_agent_steps_sampled": 281599, "num_steps_trained": 1064960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2129920, "last_target_update_ts": 272384, "num_target_updates": 26}, "done": false, "episodes_total": 118890, "training_iteration": 260, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-06", "timestamp": 1651738626, "time_this_iter_s": 0.4974997043609619, "time_total_s": 149.83726739883423, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 149.83726739883423, "timesteps_since_restore": 1064960, "iterations_since_restore": 260, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.316, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.099, "metanash": -0.099}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25145513600123987, "mean_inference_ms": 0.4431172232483479, "mean_action_processing_ms": 0.02903625070133378, "mean_env_wait_ms": 0.08603633088828863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 291840, "timesteps_this_iter": 4096, "agent_timesteps_total": 291838, "timers": {"load_time_ms": 0.137, "load_throughput": 29846888.784, "learn_time_ms": 5.861, "learn_throughput": 698902.787, "update_time_ms": 1.236}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4278295040130615, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 291840, "num_agent_steps_sampled": 291838, "num_steps_trained": 1105920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2211840, "last_target_update_ts": 282624, "num_target_updates": 27}, "done": false, "episodes_total": 123283, "training_iteration": 270, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-12", "timestamp": 1651738632, "time_this_iter_s": 0.4442892074584961, "time_total_s": 155.72273755073547, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 155.72273755073547, "timesteps_since_restore": 1105920, "iterations_since_restore": 270, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.338, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.173, "metanash": -0.173}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25143470466200546, "mean_inference_ms": 0.44279283099792255, "mean_action_processing_ms": 0.0290153044663143, "mean_env_wait_ms": 0.08598471268957789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 302080, "timesteps_this_iter": 4096, "agent_timesteps_total": 302078, "timers": {"load_time_ms": 0.138, "load_throughput": 29635792.969, "learn_time_ms": 5.961, "learn_throughput": 687079.338, "update_time_ms": 1.323}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43940895795822144, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 302080, "num_agent_steps_sampled": 302078, "num_steps_trained": 1146880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2293760, "last_target_update_ts": 292864, "num_target_updates": 28}, "done": false, "episodes_total": 127695, "training_iteration": 280, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-18", "timestamp": 1651738638, "time_this_iter_s": 0.47132182121276855, "time_total_s": 161.17498183250427, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 161.17498183250427, "timesteps_since_restore": 1146880, "iterations_since_restore": 280, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.5, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.334, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.162, "metanash": -0.162}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514642296285872, "mean_inference_ms": 0.4426871991152419, "mean_action_processing_ms": 0.029013176413900367, "mean_env_wait_ms": 0.08598131371395516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 312320, "timesteps_this_iter": 4096, "agent_timesteps_total": 312317, "timers": {"load_time_ms": 0.137, "load_throughput": 29992788.38, "learn_time_ms": 6.133, "learn_throughput": 667877.09, "update_time_ms": 1.317}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4281315505504608, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 312320, "num_agent_steps_sampled": 312317, "num_steps_trained": 1187840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2375680, "last_target_update_ts": 303104, "num_target_updates": 29}, "done": false, "episodes_total": 132076, "training_iteration": 290, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-23", "timestamp": 1651738643, "time_this_iter_s": 0.45550990104675293, "time_total_s": 166.619402885437, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 166.619402885437, "timesteps_since_restore": 1187840, "iterations_since_restore": 290, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.34, "episode_media": {}, "episodes_this_iter": 433, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.134, "metanash": -0.134}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517587095245673, "mean_inference_ms": 0.4435175614607062, "mean_action_processing_ms": 0.029036890051759526, "mean_env_wait_ms": 0.08604999171495382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 322560, "timesteps_this_iter": 4096, "agent_timesteps_total": 322556, "timers": {"load_time_ms": 0.135, "load_throughput": 30320983.382, "learn_time_ms": 6.066, "learn_throughput": 675184.584, "update_time_ms": 1.319}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.449325293302536, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 322560, "num_agent_steps_sampled": 322556, "num_steps_trained": 1228800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2457600, "last_target_update_ts": 313344, "num_target_updates": 30}, "done": false, "episodes_total": 136451, "training_iteration": 300, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-30", "timestamp": 1651738650, "time_this_iter_s": 0.5150971412658691, "time_total_s": 173.1224799156189, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 173.1224799156189, "timesteps_since_restore": 1228800, "iterations_since_restore": 300, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.327, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.162, "metanash": -0.162}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25177320619111637, "mean_inference_ms": 0.4437231131555981, "mean_action_processing_ms": 0.02903239218381466, "mean_env_wait_ms": 0.08604419872230983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 332800, "timesteps_this_iter": 4096, "agent_timesteps_total": 332798, "timers": {"load_time_ms": 0.143, "load_throughput": 28566460.233, "learn_time_ms": 6.395, "learn_throughput": 640540.369, "update_time_ms": 1.352}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4246646761894226, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 332800, "num_agent_steps_sampled": 332798, "num_steps_trained": 1269760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2539520, "last_target_update_ts": 323584, "num_target_updates": 31}, "done": false, "episodes_total": 140835, "training_iteration": 310, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-36", "timestamp": 1651738656, "time_this_iter_s": 0.4717259407043457, "time_total_s": 178.77926683425903, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 178.77926683425903, "timesteps_since_restore": 1269760, "iterations_since_restore": 310, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.317, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.109, "metanash": -0.109}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517475663613413, "mean_inference_ms": 0.4434028460058556, "mean_action_processing_ms": 0.02901934748026582, "mean_env_wait_ms": 0.0860136138681461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 343040, "timesteps_this_iter": 4096, "agent_timesteps_total": 343037, "timers": {"load_time_ms": 0.136, "load_throughput": 30039988.082, "learn_time_ms": 5.832, "learn_throughput": 702365.87, "update_time_ms": 1.321}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4361116886138916, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 343040, "num_agent_steps_sampled": 343037, "num_steps_trained": 1310720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2621440, "last_target_update_ts": 333824, "num_target_updates": 32}, "done": false, "episodes_total": 145241, "training_iteration": 320, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-41", "timestamp": 1651738661, "time_this_iter_s": 0.45946717262268066, "time_total_s": 184.12656664848328, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 184.12656664848328, "timesteps_since_restore": 1310720, "iterations_since_restore": 320, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.338, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.176, "metanash": -0.176}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25221334166251086, "mean_inference_ms": 0.4439855861551707, "mean_action_processing_ms": 0.02905190948084879, "mean_env_wait_ms": 0.08610465453345885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 353280, "timesteps_this_iter": 4096, "agent_timesteps_total": 353279, "timers": {"load_time_ms": 0.137, "load_throughput": 29857263.094, "learn_time_ms": 6.258, "learn_throughput": 654558.481, "update_time_ms": 1.393}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43319448828697205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 353280, "num_agent_steps_sampled": 353279, "num_steps_trained": 1351680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2703360, "last_target_update_ts": 344064, "num_target_updates": 33}, "done": false, "episodes_total": 149632, "training_iteration": 330, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-47", "timestamp": 1651738667, "time_this_iter_s": 0.5190212726593018, "time_total_s": 190.5862410068512, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 190.5862410068512, "timesteps_since_restore": 1351680, "iterations_since_restore": 330, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.344, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.203, "metanash": -0.203}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25284888007128237, "mean_inference_ms": 0.44492946881023704, "mean_action_processing_ms": 0.02911702531830062, "mean_env_wait_ms": 0.08627634127140894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 363520, "timesteps_this_iter": 4096, "agent_timesteps_total": 363517, "timers": {"load_time_ms": 0.135, "load_throughput": 30412230.809, "learn_time_ms": 5.828, "learn_throughput": 702805.483, "update_time_ms": 1.345}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4442737102508545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 363520, "num_agent_steps_sampled": 363517, "num_steps_trained": 1392640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2785280, "last_target_update_ts": 354304, "num_target_updates": 34}, "done": false, "episodes_total": 154000, "training_iteration": 340, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-53", "timestamp": 1651738673, "time_this_iter_s": 0.5055439472198486, "time_total_s": 196.38286805152893, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 196.38286805152893, "timesteps_since_restore": 1392640, "iterations_since_restore": 340, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.317, "episode_media": {}, "episodes_this_iter": 443, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.154, "metanash": -0.154}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25303984077034064, "mean_inference_ms": 0.44504605152891225, "mean_action_processing_ms": 0.02912990573137198, "mean_env_wait_ms": 0.08631062343123214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 373760, "timesteps_this_iter": 4096, "agent_timesteps_total": 373758, "timers": {"load_time_ms": 0.144, "load_throughput": 28410565.874, "learn_time_ms": 6.72, "learn_throughput": 609526.467, "update_time_ms": 1.451}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4278015196323395, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 373760, "num_agent_steps_sampled": 373758, "num_steps_trained": 1433600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2867200, "last_target_update_ts": 364544, "num_target_updates": 35}, "done": false, "episodes_total": 158411, "training_iteration": 350, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-17-59", "timestamp": 1651738679, "time_this_iter_s": 0.4820706844329834, "time_total_s": 202.14922213554382, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 202.14922213554382, "timesteps_since_restore": 1433600, "iterations_since_restore": 350, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.324, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.143, "metanash": -0.143}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2529756160637441, "mean_inference_ms": 0.44482937387789834, "mean_action_processing_ms": 0.029121179056687707, "mean_env_wait_ms": 0.08629201072448642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 384000, "timesteps_this_iter": 4096, "agent_timesteps_total": 383997, "timers": {"load_time_ms": 0.14, "load_throughput": 29177766.957, "learn_time_ms": 6.455, "learn_throughput": 634507.779, "update_time_ms": 1.384}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43675076961517334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 383997, "num_steps_trained": 1474560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 2949120, "last_target_update_ts": 374784, "num_target_updates": 36}, "done": false, "episodes_total": 162777, "training_iteration": 360, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-05", "timestamp": 1651738685, "time_this_iter_s": 0.5291416645050049, "time_total_s": 207.76963567733765, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 207.76963567733765, "timesteps_since_restore": 1474560, "iterations_since_restore": 360, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.343, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.198, "metanash": -0.198}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2529727028165866, "mean_inference_ms": 0.4446353280500345, "mean_action_processing_ms": 0.029114856217169516, "mean_env_wait_ms": 0.08627236626059445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 394240, "timesteps_this_iter": 4096, "agent_timesteps_total": 394238, "timers": {"load_time_ms": 0.136, "load_throughput": 30150700.569, "learn_time_ms": 5.756, "learn_throughput": 711558.531, "update_time_ms": 1.362}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4453306198120117, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 394240, "num_agent_steps_sampled": 394238, "num_steps_trained": 1515520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3031040, "last_target_update_ts": 385024, "num_target_updates": 37}, "done": false, "episodes_total": 167194, "training_iteration": 370, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-11", "timestamp": 1651738691, "time_this_iter_s": 1.2414381504058838, "time_total_s": 214.1500542163849, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 214.1500542163849, "timesteps_since_restore": 1515520, "iterations_since_restore": 370, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.1, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.335, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.194, "metanash": -0.194}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25323484443560584, "mean_inference_ms": 0.4448513980009595, "mean_action_processing_ms": 0.029130743639211608, "mean_env_wait_ms": 0.0863229521020023, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 404480, "timesteps_this_iter": 4096, "agent_timesteps_total": 404478, "timers": {"load_time_ms": 0.136, "load_throughput": 30029486.425, "learn_time_ms": 5.929, "learn_throughput": 690867.419, "update_time_ms": 1.388}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.44486796855926514, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 404480, "num_agent_steps_sampled": 404478, "num_steps_trained": 1556480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3112960, "last_target_update_ts": 395264, "num_target_updates": 38}, "done": false, "episodes_total": 171592, "training_iteration": 380, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-17", "timestamp": 1651738697, "time_this_iter_s": 0.44477105140686035, "time_total_s": 219.78805088996887, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 219.78805088996887, "timesteps_since_restore": 1556480, "iterations_since_restore": 380, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.372, "episode_media": {}, "episodes_this_iter": 428, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.232, "metanash": -0.232}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25331481473207895, "mean_inference_ms": 0.44490997682593303, "mean_action_processing_ms": 0.02913806343616379, "mean_env_wait_ms": 0.08633341325266905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 414720, "timesteps_this_iter": 4096, "agent_timesteps_total": 414717, "timers": {"load_time_ms": 0.138, "load_throughput": 29769310.664, "learn_time_ms": 6.187, "learn_throughput": 662055.207, "update_time_ms": 1.415}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43405649065971375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 414720, "num_agent_steps_sampled": 414717, "num_steps_trained": 1597440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3194880, "last_target_update_ts": 405504, "num_target_updates": 39}, "done": false, "episodes_total": 175969, "training_iteration": 390, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-23", "timestamp": 1651738703, "time_this_iter_s": 0.499126672744751, "time_total_s": 225.4936580657959, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 225.4936580657959, "timesteps_since_restore": 1597440, "iterations_since_restore": 390, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.4}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.351, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.239, "metanash": -0.239}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25336825020001363, "mean_inference_ms": 0.44513190058931146, "mean_action_processing_ms": 0.029144301849191485, "mean_env_wait_ms": 0.0863427734686108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 424960, "timesteps_this_iter": 4096, "agent_timesteps_total": 424959, "timers": {"load_time_ms": 0.134, "load_throughput": 30656440.371, "learn_time_ms": 6.007, "learn_throughput": 681897.785, "update_time_ms": 1.366}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4334613084793091, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 424960, "num_agent_steps_sampled": 424959, "num_steps_trained": 1638400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3276800, "last_target_update_ts": 415744, "num_target_updates": 40}, "done": false, "episodes_total": 180351, "training_iteration": 400, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-29", "timestamp": 1651738709, "time_this_iter_s": 0.4610261917114258, "time_total_s": 231.21337819099426, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 231.21337819099426, "timesteps_since_restore": 1638400, "iterations_since_restore": 400, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.329, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.131, "metanash": -0.131}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2535477433921088, "mean_inference_ms": 0.44571379501365765, "mean_action_processing_ms": 0.029151069032831933, "mean_env_wait_ms": 0.08637917720715481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 435200, "timesteps_this_iter": 4096, "agent_timesteps_total": 435198, "timers": {"load_time_ms": 0.136, "load_throughput": 30013747.701, "learn_time_ms": 5.947, "learn_throughput": 688795.528, "update_time_ms": 1.311}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4402933716773987, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 435200, "num_agent_steps_sampled": 435198, "num_steps_trained": 1679360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3358720, "last_target_update_ts": 425984, "num_target_updates": 41}, "done": false, "episodes_total": 184748, "training_iteration": 410, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-34", "timestamp": 1651738714, "time_this_iter_s": 0.5629715919494629, "time_total_s": 237.106862783432, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 237.106862783432, "timesteps_since_restore": 1679360, "iterations_since_restore": 410, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.345, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.183, "metanash": -0.183}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533822232574622, "mean_inference_ms": 0.4452988709581396, "mean_action_processing_ms": 0.029128610790921095, "mean_env_wait_ms": 0.08631184963437823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 445440, "timesteps_this_iter": 4096, "agent_timesteps_total": 445437, "timers": {"load_time_ms": 0.137, "load_throughput": 29909243.008, "learn_time_ms": 5.886, "learn_throughput": 695896.254, "update_time_ms": 1.444}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.44514086842536926, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 445440, "num_agent_steps_sampled": 445437, "num_steps_trained": 1720320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3440640, "last_target_update_ts": 436224, "num_target_updates": 42}, "done": false, "episodes_total": 189140, "training_iteration": 420, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-40", "timestamp": 1651738720, "time_this_iter_s": 0.5092282295227051, "time_total_s": 242.72347688674927, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 242.72347688674927, "timesteps_since_restore": 1720320, "iterations_since_restore": 420, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.334, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.204, "metanash": -0.204}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25334948240640615, "mean_inference_ms": 0.4451148812775133, "mean_action_processing_ms": 0.02912202368846136, "mean_env_wait_ms": 0.08630299136642242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 455680, "timesteps_this_iter": 4096, "agent_timesteps_total": 455677, "timers": {"load_time_ms": 0.136, "load_throughput": 30076801.793, "learn_time_ms": 6.185, "learn_throughput": 662198.113, "update_time_ms": 1.338}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43698540329933167, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 455680, "num_agent_steps_sampled": 455677, "num_steps_trained": 1761280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3522560, "last_target_update_ts": 446464, "num_target_updates": 43}, "done": false, "episodes_total": 193518, "training_iteration": 430, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-46", "timestamp": 1651738726, "time_this_iter_s": 0.5133142471313477, "time_total_s": 248.52065300941467, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 248.52065300941467, "timesteps_since_restore": 1761280, "iterations_since_restore": 430, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.325, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.139, "metanash": -0.139}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25312599714987355, "mean_inference_ms": 0.4446427286256925, "mean_action_processing_ms": 0.029101392664790206, "mean_env_wait_ms": 0.08624770038572467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 465920, "timesteps_this_iter": 4096, "agent_timesteps_total": 465917, "timers": {"load_time_ms": 0.137, "load_throughput": 29800293.467, "learn_time_ms": 6.228, "learn_throughput": 657663.065, "update_time_ms": 1.311}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.440670371055603, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 465920, "num_agent_steps_sampled": 465917, "num_steps_trained": 1802240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3604480, "last_target_update_ts": 456704, "num_target_updates": 44}, "done": false, "episodes_total": 197889, "training_iteration": 440, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-53", "timestamp": 1651738733, "time_this_iter_s": 1.331463098526001, "time_total_s": 255.04096722602844, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 255.04096722602844, "timesteps_since_restore": 1802240, "iterations_since_restore": 440, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.34, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.166, "metanash": -0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2529850383698323, "mean_inference_ms": 0.4443522170454756, "mean_action_processing_ms": 0.02908345401519464, "mean_env_wait_ms": 0.08620646616488081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 476160, "timesteps_this_iter": 4096, "agent_timesteps_total": 476159, "timers": {"load_time_ms": 0.137, "load_throughput": 29992788.38, "learn_time_ms": 6.107, "learn_throughput": 670685.181, "update_time_ms": 1.383}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43445461988449097, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 476160, "num_agent_steps_sampled": 476159, "num_steps_trained": 1843200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3686400, "last_target_update_ts": 466944, "num_target_updates": 45}, "done": false, "episodes_total": 202261, "training_iteration": 450, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-18-58", "timestamp": 1651738738, "time_this_iter_s": 1.3040189743041992, "time_total_s": 260.57306241989136, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 260.57306241989136, "timesteps_since_restore": 1843200, "iterations_since_restore": 450, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.318, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.14, "metanash": -0.14}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2528328472601687, "mean_inference_ms": 0.44398685302583285, "mean_action_processing_ms": 0.02906692303395394, "mean_env_wait_ms": 0.08616556069514789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 486400, "timesteps_this_iter": 4096, "agent_timesteps_total": 486396, "timers": {"load_time_ms": 0.137, "load_throughput": 29795125.189, "learn_time_ms": 5.949, "learn_throughput": 688558.112, "update_time_ms": 1.403}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.427040159702301, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 486400, "num_agent_steps_sampled": 486396, "num_steps_trained": 1884160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3768320, "last_target_update_ts": 477184, "num_target_updates": 46}, "done": false, "episodes_total": 206660, "training_iteration": 460, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-04", "timestamp": 1651738744, "time_this_iter_s": 0.5001382827758789, "time_total_s": 266.34677147865295, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 266.34677147865295, "timesteps_since_restore": 1884160, "iterations_since_restore": 460, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.313, "episode_media": {}, "episodes_this_iter": 445, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.118, "metanash": -0.118}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2528711754059739, "mean_inference_ms": 0.4439013188460651, "mean_action_processing_ms": 0.029062932064339422, "mean_env_wait_ms": 0.0861631891588885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 496640, "timesteps_this_iter": 4096, "agent_timesteps_total": 496638, "timers": {"load_time_ms": 0.136, "load_throughput": 30008505.125, "learn_time_ms": 5.825, "learn_throughput": 703144.906, "update_time_ms": 1.244}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4212208390235901, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 496640, "num_agent_steps_sampled": 496638, "num_steps_trained": 1925120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3850240, "last_target_update_ts": 487424, "num_target_updates": 47}, "done": false, "episodes_total": 211056, "training_iteration": 470, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-10", "timestamp": 1651738750, "time_this_iter_s": 0.45178699493408203, "time_total_s": 272.06460213661194, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 272.06460213661194, "timesteps_since_restore": 1925120, "iterations_since_restore": 470, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.331, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.109, "metanash": -0.109}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.252682904541394, "mean_inference_ms": 0.44355834812919065, "mean_action_processing_ms": 0.029042618371449103, "mean_env_wait_ms": 0.08610605054657475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 506880, "timesteps_this_iter": 4096, "agent_timesteps_total": 506877, "timers": {"load_time_ms": 0.136, "load_throughput": 30092606.733, "learn_time_ms": 5.697, "learn_throughput": 718997.463, "update_time_ms": 1.284}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4265575110912323, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 506880, "num_agent_steps_sampled": 506877, "num_steps_trained": 1966080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 3932160, "last_target_update_ts": 497664, "num_target_updates": 48}, "done": false, "episodes_total": 215433, "training_iteration": 480, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-16", "timestamp": 1651738756, "time_this_iter_s": 0.46173906326293945, "time_total_s": 277.7035508155823, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 277.7035508155823, "timesteps_since_restore": 1966080, "iterations_since_restore": 480, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.352, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.201, "metanash": -0.201}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25242391536591635, "mean_inference_ms": 0.44306664585257455, "mean_action_processing_ms": 0.02901489993103357, "mean_env_wait_ms": 0.0860356548661544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 517120, "timesteps_this_iter": 4096, "agent_timesteps_total": 517116, "timers": {"load_time_ms": 0.138, "load_throughput": 29605151.101, "learn_time_ms": 5.882, "learn_throughput": 696364.495, "update_time_ms": 1.455}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42403310537338257, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 517120, "num_agent_steps_sampled": 517116, "num_steps_trained": 2007040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4014080, "last_target_update_ts": 507904, "num_target_updates": 49}, "done": false, "episodes_total": 219809, "training_iteration": 490, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-21", "timestamp": 1651738761, "time_this_iter_s": 0.5150210857391357, "time_total_s": 283.17401003837585, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 283.17401003837585, "timesteps_since_restore": 2007040, "iterations_since_restore": 490, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.318, "episode_media": {}, "episodes_this_iter": 447, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.163, "metanash": -0.163}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524697952713758, "mean_inference_ms": 0.443195441504146, "mean_action_processing_ms": 0.02901778744220026, "mean_env_wait_ms": 0.08604533775831145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 527360, "timesteps_this_iter": 4096, "agent_timesteps_total": 527357, "timers": {"load_time_ms": 0.136, "load_throughput": 30150700.569, "learn_time_ms": 5.504, "learn_throughput": 744139.282, "update_time_ms": 1.214}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42125609517097473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 527360, "num_agent_steps_sampled": 527357, "num_steps_trained": 2048000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4096000, "last_target_update_ts": 518144, "num_target_updates": 50}, "done": false, "episodes_total": 224223, "training_iteration": 500, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-27", "timestamp": 1651738767, "time_this_iter_s": 0.4599606990814209, "time_total_s": 288.83681631088257, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 288.83681631088257, "timesteps_since_restore": 2048000, "iterations_since_restore": 500, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.32, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.162, "metanash": -0.162}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524861387692537, "mean_inference_ms": 0.44350308878471967, "mean_action_processing_ms": 0.029015251721508754, "mean_env_wait_ms": 0.0860382069050018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 537600, "timesteps_this_iter": 4096, "agent_timesteps_total": 537599, "timers": {"load_time_ms": 0.144, "load_throughput": 28429371.478, "learn_time_ms": 5.938, "learn_throughput": 689760.677, "update_time_ms": 1.385}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42243459820747375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 537600, "num_agent_steps_sampled": 537599, "num_steps_trained": 2088960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4177920, "last_target_update_ts": 528384, "num_target_updates": 51}, "done": false, "episodes_total": 228613, "training_iteration": 510, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-33", "timestamp": 1651738773, "time_this_iter_s": 0.46938633918762207, "time_total_s": 294.7931044101715, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 294.7931044101715, "timesteps_since_restore": 2088960, "iterations_since_restore": 510, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.3, "episode_media": {}, "episodes_this_iter": 450, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.075, "metanash": -0.075}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524480693901681, "mean_inference_ms": 0.44328136206768026, "mean_action_processing_ms": 0.029004771427981798, "mean_env_wait_ms": 0.08601905950920483, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 547840, "timesteps_this_iter": 4096, "agent_timesteps_total": 547837, "timers": {"load_time_ms": 0.143, "load_throughput": 28700082.165, "learn_time_ms": 6.091, "learn_throughput": 672433.507, "update_time_ms": 1.346}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4119376540184021, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 547840, "num_agent_steps_sampled": 547837, "num_steps_trained": 2129920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4259840, "last_target_update_ts": 538624, "num_target_updates": 52}, "done": false, "episodes_total": 233018, "training_iteration": 520, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-39", "timestamp": 1651738779, "time_this_iter_s": 0.45587968826293945, "time_total_s": 300.4654772281647, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 300.4654772281647, "timesteps_since_restore": 2129920, "iterations_since_restore": 520, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.302, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.081, "metanash": -0.081}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25240145441025313, "mean_inference_ms": 0.4431346610816796, "mean_action_processing_ms": 0.028997790338293614, "mean_env_wait_ms": 0.08600278258102487, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 558080, "timesteps_this_iter": 4096, "agent_timesteps_total": 558077, "timers": {"load_time_ms": 0.137, "load_throughput": 29930085.686, "learn_time_ms": 5.892, "learn_throughput": 695203.512, "update_time_ms": 1.373}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40953007340431213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 558080, "num_agent_steps_sampled": 558077, "num_steps_trained": 2170880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4341760, "last_target_update_ts": 548864, "num_target_updates": 53}, "done": false, "episodes_total": 237425, "training_iteration": 530, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-44", "timestamp": 1651738784, "time_this_iter_s": 0.45896196365356445, "time_total_s": 306.17959690093994, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 306.17959690093994, "timesteps_since_restore": 2170880, "iterations_since_restore": 530, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.316, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.124, "metanash": -0.124}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524542266409164, "mean_inference_ms": 0.44316463480860024, "mean_action_processing_ms": 0.02899988837489039, "mean_env_wait_ms": 0.08601179189535055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 568320, "timesteps_this_iter": 4096, "agent_timesteps_total": 568317, "timers": {"load_time_ms": 0.138, "load_throughput": 29646021.025, "learn_time_ms": 5.698, "learn_throughput": 718895.169, "update_time_ms": 1.304}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4302017092704773, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 568320, "num_agent_steps_sampled": 568317, "num_steps_trained": 2211840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4423680, "last_target_update_ts": 559104, "num_target_updates": 54}, "done": false, "episodes_total": 241801, "training_iteration": 540, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-50", "timestamp": 1651738790, "time_this_iter_s": 0.5367848873138428, "time_total_s": 312.25753831863403, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 312.25753831863403, "timesteps_since_restore": 2211840, "iterations_since_restore": 540, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.349, "episode_media": {}, "episodes_this_iter": 430, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.172, "metanash": -0.172}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25257043008334873, "mean_inference_ms": 0.4432905050735024, "mean_action_processing_ms": 0.029008824807980838, "mean_env_wait_ms": 0.08602997950220635, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 578560, "timesteps_this_iter": 4096, "agent_timesteps_total": 578557, "timers": {"load_time_ms": 0.138, "load_throughput": 29671622.079, "learn_time_ms": 5.926, "learn_throughput": 691220.435, "update_time_ms": 1.346}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4158349633216858, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 578560, "num_agent_steps_sampled": 578557, "num_steps_trained": 2252800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4505600, "last_target_update_ts": 569344, "num_target_updates": 55}, "done": false, "episodes_total": 246182, "training_iteration": 550, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-19-56", "timestamp": 1651738796, "time_this_iter_s": 0.45044732093811035, "time_total_s": 317.90278792381287, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 317.90278792381287, "timesteps_since_restore": 2252800, "iterations_since_restore": 550, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.354, "episode_media": {}, "episodes_this_iter": 432, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.198, "metanash": -0.198}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25259986929214717, "mean_inference_ms": 0.4432728053566797, "mean_action_processing_ms": 0.029008090303368934, "mean_env_wait_ms": 0.08603333837802461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 588800, "timesteps_this_iter": 4096, "agent_timesteps_total": 588798, "timers": {"load_time_ms": 0.14, "load_throughput": 29357261.08, "learn_time_ms": 6.258, "learn_throughput": 654558.481, "update_time_ms": 1.363}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4186221957206726, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 588800, "num_agent_steps_sampled": 588798, "num_steps_trained": 2293760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4587520, "last_target_update_ts": 579584, "num_target_updates": 56}, "done": false, "episodes_total": 250554, "training_iteration": 560, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-02", "timestamp": 1651738802, "time_this_iter_s": 0.4843406677246094, "time_total_s": 323.6294815540314, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 323.6294815540314, "timesteps_since_restore": 2293760, "iterations_since_restore": 560, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.347, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.164, "metanash": -0.164}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2526895053019941, "mean_inference_ms": 0.44330340961542775, "mean_action_processing_ms": 0.02901053201699768, "mean_env_wait_ms": 0.08604427510679476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 599040, "timesteps_this_iter": 4096, "agent_timesteps_total": 599037, "timers": {"load_time_ms": 0.139, "load_throughput": 29498401.758, "learn_time_ms": 5.863, "learn_throughput": 698590.17, "update_time_ms": 1.43}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40927454829216003, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 599040, "num_agent_steps_sampled": 599037, "num_steps_trained": 2334720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4669440, "last_target_update_ts": 589824, "num_target_updates": 57}, "done": false, "episodes_total": 254932, "training_iteration": 570, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-08", "timestamp": 1651738808, "time_this_iter_s": 0.4914267063140869, "time_total_s": 329.4066889286041, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 329.4066889286041, "timesteps_since_restore": 2334720, "iterations_since_restore": 570, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.325, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.166, "metanash": -0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2527677935205154, "mean_inference_ms": 0.4433135345255694, "mean_action_processing_ms": 0.02901778023775793, "mean_env_wait_ms": 0.08606160849168307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 609280, "timesteps_this_iter": 4096, "agent_timesteps_total": 609278, "timers": {"load_time_ms": 0.152, "load_throughput": 26991153.471, "learn_time_ms": 6.036, "learn_throughput": 678630.451, "update_time_ms": 1.302}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4147176742553711, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 609280, "num_agent_steps_sampled": 609278, "num_steps_trained": 2375680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4751360, "last_target_update_ts": 600064, "num_target_updates": 58}, "done": false, "episodes_total": 259317, "training_iteration": 580, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-14", "timestamp": 1651738814, "time_this_iter_s": 0.44404053688049316, "time_total_s": 335.0985600948334, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 335.0985600948334, "timesteps_since_restore": 2375680, "iterations_since_restore": 580, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.325, "episode_media": {}, "episodes_this_iter": 443, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.187, "metanash": -0.187}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25281410056024545, "mean_inference_ms": 0.4433276246984564, "mean_action_processing_ms": 0.029021600841294088, "mean_env_wait_ms": 0.08607512967178828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 619520, "timesteps_this_iter": 4096, "agent_timesteps_total": 619517, "timers": {"load_time_ms": 0.137, "load_throughput": 29789958.703, "learn_time_ms": 5.947, "learn_throughput": 688732.017, "update_time_ms": 1.342}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4237859845161438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 619520, "num_agent_steps_sampled": 619517, "num_steps_trained": 2416640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4833280, "last_target_update_ts": 610304, "num_target_updates": 59}, "done": false, "episodes_total": 263709, "training_iteration": 590, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-20", "timestamp": 1651738820, "time_this_iter_s": 1.3555262088775635, "time_total_s": 341.7188675403595, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 341.7188675403595, "timesteps_since_restore": 2416640, "iterations_since_restore": 590, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.328, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.207, "metanash": -0.207}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.252913730063838, "mean_inference_ms": 0.4434332639747804, "mean_action_processing_ms": 0.029030612410710983, "mean_env_wait_ms": 0.08609955613906467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 629760, "timesteps_this_iter": 4096, "agent_timesteps_total": 629759, "timers": {"load_time_ms": 0.144, "load_throughput": 28373029.206, "learn_time_ms": 6.258, "learn_throughput": 654503.621, "update_time_ms": 1.339}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4130561649799347, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 629760, "num_agent_steps_sampled": 629759, "num_steps_trained": 2457600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4915200, "last_target_update_ts": 620544, "num_target_updates": 60}, "done": false, "episodes_total": 268081, "training_iteration": 600, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-26", "timestamp": 1651738826, "time_this_iter_s": 0.5302014350891113, "time_total_s": 347.6337876319885, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 347.6337876319885, "timesteps_since_restore": 2457600, "iterations_since_restore": 600, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.31, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.166, "metanash": -0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25289147929553424, "mean_inference_ms": 0.4436481030236911, "mean_action_processing_ms": 0.029024817887889437, "mean_env_wait_ms": 0.08608345629605374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 640000, "timesteps_this_iter": 4096, "agent_timesteps_total": 639997, "timers": {"load_time_ms": 0.137, "load_throughput": 29987553.123, "learn_time_ms": 5.8, "learn_throughput": 706170.994, "update_time_ms": 1.405}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.411279559135437, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 639997, "num_steps_trained": 2498560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 4997120, "last_target_update_ts": 630784, "num_target_updates": 61}, "done": false, "episodes_total": 272482, "training_iteration": 610, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-32", "timestamp": 1651738832, "time_this_iter_s": 0.5216655731201172, "time_total_s": 353.5357451438904, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 353.5357451438904, "timesteps_since_restore": 2498560, "iterations_since_restore": 610, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.318, "episode_media": {}, "episodes_this_iter": 444, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.096, "metanash": -0.096}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2529267030911827, "mean_inference_ms": 0.4437603016450978, "mean_action_processing_ms": 0.0290265692994571, "mean_env_wait_ms": 0.08609392157492798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 650240, "timesteps_this_iter": 4096, "agent_timesteps_total": 650238, "timers": {"load_time_ms": 0.137, "load_throughput": 29815809.066, "learn_time_ms": 5.719, "learn_throughput": 716147.165, "update_time_ms": 1.267}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4068430960178375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 650240, "num_agent_steps_sampled": 650238, "num_steps_trained": 2539520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5079040, "last_target_update_ts": 641024, "num_target_updates": 62}, "done": false, "episodes_total": 276851, "training_iteration": 620, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-38", "timestamp": 1651738838, "time_this_iter_s": 0.4828009605407715, "time_total_s": 359.2805244922638, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 359.2805244922638, "timesteps_since_restore": 2539520, "iterations_since_restore": 620, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.339, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.122, "metanash": -0.122}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25294736373449767, "mean_inference_ms": 0.44376150198845093, "mean_action_processing_ms": 0.029026859953632935, "mean_env_wait_ms": 0.08609274080050648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 660480, "timesteps_this_iter": 4096, "agent_timesteps_total": 660479, "timers": {"load_time_ms": 0.136, "load_throughput": 30193091.712, "learn_time_ms": 5.62, "learn_throughput": 728837.634, "update_time_ms": 1.33}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.422893762588501, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 660480, "num_agent_steps_sampled": 660479, "num_steps_trained": 2580480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5160960, "last_target_update_ts": 651264, "num_target_updates": 63}, "done": false, "episodes_total": 281232, "training_iteration": 630, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-44", "timestamp": 1651738844, "time_this_iter_s": 0.47962522506713867, "time_total_s": 365.0684976577759, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 365.0684976577759, "timesteps_since_restore": 2580480, "iterations_since_restore": 630, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.361, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.202, "metanash": -0.202}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25280722785220694, "mean_inference_ms": 0.44354560128150833, "mean_action_processing_ms": 0.0290092406581801, "mean_env_wait_ms": 0.08605376265542515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 670720, "timesteps_this_iter": 4096, "agent_timesteps_total": 670719, "timers": {"load_time_ms": 0.137, "load_throughput": 29898832.551, "learn_time_ms": 5.937, "learn_throughput": 689885.32, "update_time_ms": 1.363}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4203890562057495, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 670720, "num_agent_steps_sampled": 670719, "num_steps_trained": 2621440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5242880, "last_target_update_ts": 661504, "num_target_updates": 64}, "done": false, "episodes_total": 285613, "training_iteration": 640, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-50", "timestamp": 1651738850, "time_this_iter_s": 0.4661228656768799, "time_total_s": 370.72112679481506, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 370.72112679481506, "timesteps_since_restore": 2621440, "iterations_since_restore": 640, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.342, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.189, "metanash": -0.189}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2527700798789059, "mean_inference_ms": 0.4433665102422848, "mean_action_processing_ms": 0.029005907322093506, "mean_env_wait_ms": 0.08604439030028573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 680960, "timesteps_this_iter": 4096, "agent_timesteps_total": 680957, "timers": {"load_time_ms": 0.137, "load_throughput": 29815809.066, "learn_time_ms": 5.903, "learn_throughput": 693942.666, "update_time_ms": 1.329}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41873815655708313, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 680960, "num_agent_steps_sampled": 680957, "num_steps_trained": 2662400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5324800, "last_target_update_ts": 671744, "num_target_updates": 65}, "done": false, "episodes_total": 289977, "training_iteration": 650, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-20-55", "timestamp": 1651738855, "time_this_iter_s": 0.47517871856689453, "time_total_s": 376.43498134613037, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 376.43498134613037, "timesteps_since_restore": 2662400, "iterations_since_restore": 650, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.321, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.147, "metanash": -0.147}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25267959201597784, "mean_inference_ms": 0.44315206423025766, "mean_action_processing_ms": 0.028993160355758767, "mean_env_wait_ms": 0.0860165487515439, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 691200, "timesteps_this_iter": 4096, "agent_timesteps_total": 691197, "timers": {"load_time_ms": 0.135, "load_throughput": 30240924.457, "learn_time_ms": 5.951, "learn_throughput": 688315.345, "update_time_ms": 1.246}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41795626282691956, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 691200, "num_agent_steps_sampled": 691197, "num_steps_trained": 2703360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5406720, "last_target_update_ts": 681984, "num_target_updates": 66}, "done": false, "episodes_total": 294362, "training_iteration": 660, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-01", "timestamp": 1651738861, "time_this_iter_s": 0.5223944187164307, "time_total_s": 382.1116418838501, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 382.1116418838501, "timesteps_since_restore": 2703360, "iterations_since_restore": 660, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.348, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.198, "metanash": -0.198}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2527584187192746, "mean_inference_ms": 0.4432430872727841, "mean_action_processing_ms": 0.028999338671452726, "mean_env_wait_ms": 0.08602978850737683, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 701440, "timesteps_this_iter": 4096, "agent_timesteps_total": 701436, "timers": {"load_time_ms": 0.14, "load_throughput": 29262253.763, "learn_time_ms": 5.772, "learn_throughput": 709692.004, "update_time_ms": 1.343}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42330867052078247, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 701440, "num_agent_steps_sampled": 701436, "num_steps_trained": 2744320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5488640, "last_target_update_ts": 692224, "num_target_updates": 67}, "done": false, "episodes_total": 298752, "training_iteration": 670, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-07", "timestamp": 1651738867, "time_this_iter_s": 0.46556782722473145, "time_total_s": 387.92145252227783, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 387.92145252227783, "timesteps_since_restore": 2744320, "iterations_since_restore": 670, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.359, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.214, "metanash": -0.214}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2529446895993661, "mean_inference_ms": 0.4434790536266976, "mean_action_processing_ms": 0.02901583749953063, "mean_env_wait_ms": 0.08607747405529076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 711680, "timesteps_this_iter": 4096, "agent_timesteps_total": 711677, "timers": {"load_time_ms": 0.143, "load_throughput": 28590229.962, "learn_time_ms": 6.279, "learn_throughput": 652282.024, "update_time_ms": 1.41}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42017582058906555, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 711680, "num_agent_steps_sampled": 711677, "num_steps_trained": 2785280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5570560, "last_target_update_ts": 702464, "num_target_updates": 68}, "done": false, "episodes_total": 303145, "training_iteration": 680, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-13", "timestamp": 1651738873, "time_this_iter_s": 0.47255682945251465, "time_total_s": 393.88831973075867, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 393.88831973075867, "timesteps_since_restore": 2785280, "iterations_since_restore": 680, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.35, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.17, "metanash": -0.17}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2528891179864019, "mean_inference_ms": 0.44333194829692857, "mean_action_processing_ms": 0.029011205854029762, "mean_env_wait_ms": 0.0860627975363089, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 721920, "timesteps_this_iter": 4096, "agent_timesteps_total": 721917, "timers": {"load_time_ms": 0.136, "load_throughput": 30087336.574, "learn_time_ms": 6.087, "learn_throughput": 672947.131, "update_time_ms": 1.325}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41543883085250854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 721920, "num_agent_steps_sampled": 721917, "num_steps_trained": 2826240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5652480, "last_target_update_ts": 712704, "num_target_updates": 69}, "done": false, "episodes_total": 307530, "training_iteration": 690, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-19", "timestamp": 1651738879, "time_this_iter_s": 0.46184802055358887, "time_total_s": 399.8217830657959, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 399.8217830657959, "timesteps_since_restore": 2826240, "iterations_since_restore": 690, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.341, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.125, "metanash": -0.125}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25278719597837035, "mean_inference_ms": 0.443100701860871, "mean_action_processing_ms": 0.029000896701158574, "mean_env_wait_ms": 0.08604008838297159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 732160, "timesteps_this_iter": 4096, "agent_timesteps_total": 732157, "timers": {"load_time_ms": 0.139, "load_throughput": 29452887.338, "learn_time_ms": 5.596, "learn_throughput": 731980.247, "update_time_ms": 1.303}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4231477677822113, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 732160, "num_agent_steps_sampled": 732157, "num_steps_trained": 2867200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5734400, "last_target_update_ts": 722944, "num_target_updates": 70}, "done": false, "episodes_total": 311903, "training_iteration": 700, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-25", "timestamp": 1651738885, "time_this_iter_s": 0.5043957233428955, "time_total_s": 405.5458962917328, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 405.5458962917328, "timesteps_since_restore": 2867200, "iterations_since_restore": 700, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.348, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.185, "metanash": -0.185}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25281267979430366, "mean_inference_ms": 0.44328180662372696, "mean_action_processing_ms": 0.029002220687041513, "mean_env_wait_ms": 0.08604072568017046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 742400, "timesteps_this_iter": 4096, "agent_timesteps_total": 742398, "timers": {"load_time_ms": 0.138, "load_throughput": 29635792.969, "learn_time_ms": 5.76, "learn_throughput": 711149.114, "update_time_ms": 1.314}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4207499027252197, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 742400, "num_agent_steps_sampled": 742398, "num_steps_trained": 2908160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5816320, "last_target_update_ts": 733184, "num_target_updates": 71}, "done": false, "episodes_total": 316294, "training_iteration": 710, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-31", "timestamp": 1651738891, "time_this_iter_s": 0.5088365077972412, "time_total_s": 411.6017770767212, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 411.6017770767212, "timesteps_since_restore": 2908160, "iterations_since_restore": 710, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.328, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.23, "metanash": -0.23}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25282171680321247, "mean_inference_ms": 0.4434474046107485, "mean_action_processing_ms": 0.029003548711690114, "mean_env_wait_ms": 0.0860484680971762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 752640, "timesteps_this_iter": 4096, "agent_timesteps_total": 752638, "timers": {"load_time_ms": 0.141, "load_throughput": 28951582.717, "learn_time_ms": 5.888, "learn_throughput": 695693.357, "update_time_ms": 1.32}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4077989459037781, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 752640, "num_agent_steps_sampled": 752638, "num_steps_trained": 2949120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5898240, "last_target_update_ts": 743424, "num_target_updates": 72}, "done": false, "episodes_total": 320677, "training_iteration": 720, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-37", "timestamp": 1651738897, "time_this_iter_s": 0.451887845993042, "time_total_s": 417.5349590778351, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 417.5349590778351, "timesteps_since_restore": 2949120, "iterations_since_restore": 720, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.326, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.14, "metanash": -0.14}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25287272972325386, "mean_inference_ms": 0.4434558765776875, "mean_action_processing_ms": 0.02900847482617783, "mean_env_wait_ms": 0.0860590341441211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 762880, "timesteps_this_iter": 4096, "agent_timesteps_total": 762877, "timers": {"load_time_ms": 0.14, "load_throughput": 29212496.487, "learn_time_ms": 5.744, "learn_throughput": 713046.999, "update_time_ms": 1.331}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4267095625400543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 762880, "num_agent_steps_sampled": 762877, "num_steps_trained": 2990080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 5980160, "last_target_update_ts": 753664, "num_target_updates": 73}, "done": false, "episodes_total": 325072, "training_iteration": 730, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-44", "timestamp": 1651738904, "time_this_iter_s": 1.4289729595184326, "time_total_s": 424.42187762260437, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 424.42187762260437, "timesteps_since_restore": 2990080, "iterations_since_restore": 730, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.357, "episode_media": {}, "episodes_this_iter": 430, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.241, "metanash": -0.241}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25295808391559, "mean_inference_ms": 0.4435672084077576, "mean_action_processing_ms": 0.029013129407611325, "mean_env_wait_ms": 0.08607735301137102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 773120, "timesteps_this_iter": 4096, "agent_timesteps_total": 773118, "timers": {"load_time_ms": 0.139, "load_throughput": 29362278.558, "learn_time_ms": 5.972, "learn_throughput": 685812.17, "update_time_ms": 1.329}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42448171973228455, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 773120, "num_agent_steps_sampled": 773118, "num_steps_trained": 3031040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6062080, "last_target_update_ts": 763904, "num_target_updates": 74}, "done": false, "episodes_total": 329459, "training_iteration": 740, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-50", "timestamp": 1651738910, "time_this_iter_s": 0.476346492767334, "time_total_s": 430.1842670440674, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 430.1842670440674, "timesteps_since_restore": 3031040, "iterations_since_restore": 740, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.326, "episode_media": {}, "episodes_this_iter": 443, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.18, "metanash": -0.18}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25303092285422857, "mean_inference_ms": 0.44357753042685083, "mean_action_processing_ms": 0.029020847821344013, "mean_env_wait_ms": 0.08609707486794281, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 783360, "timesteps_this_iter": 4096, "agent_timesteps_total": 783359, "timers": {"load_time_ms": 0.138, "load_throughput": 29620464.11, "learn_time_ms": 5.762, "learn_throughput": 710878.392, "update_time_ms": 1.324}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4154556095600128, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 783360, "num_agent_steps_sampled": 783359, "num_steps_trained": 3072000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6144000, "last_target_update_ts": 774144, "num_target_updates": 75}, "done": false, "episodes_total": 333868, "training_iteration": 750, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-21-56", "timestamp": 1651738916, "time_this_iter_s": 0.5171477794647217, "time_total_s": 436.03859210014343, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 436.03859210014343, "timesteps_since_restore": 3072000, "iterations_since_restore": 750, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.334, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.182, "metanash": -0.182}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25303972650745565, "mean_inference_ms": 0.44357230026931754, "mean_action_processing_ms": 0.029022011237374343, "mean_env_wait_ms": 0.08609279636051735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 793600, "timesteps_this_iter": 4096, "agent_timesteps_total": 793596, "timers": {"load_time_ms": 0.137, "load_throughput": 29826161.778, "learn_time_ms": 5.797, "learn_throughput": 706632.823, "update_time_ms": 1.353}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4285711646080017, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 793600, "num_agent_steps_sampled": 793596, "num_steps_trained": 3112960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6225920, "last_target_update_ts": 784384, "num_target_updates": 76}, "done": false, "episodes_total": 338266, "training_iteration": 760, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-01", "timestamp": 1651738921, "time_this_iter_s": 0.4426569938659668, "time_total_s": 441.8835644721985, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 441.8835644721985, "timesteps_since_restore": 3112960, "iterations_since_restore": 760, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.31, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.091, "metanash": -0.091}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253087076948714, "mean_inference_ms": 0.4435933668429082, "mean_action_processing_ms": 0.029029963730706997, "mean_env_wait_ms": 0.08611533005800963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 803840, "timesteps_this_iter": 4096, "agent_timesteps_total": 803836, "timers": {"load_time_ms": 0.136, "load_throughput": 30066274.386, "learn_time_ms": 5.515, "learn_throughput": 742649.922, "update_time_ms": 1.397}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4210115671157837, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 803840, "num_agent_steps_sampled": 803836, "num_steps_trained": 3153920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6307840, "last_target_update_ts": 794624, "num_target_updates": 77}, "done": false, "episodes_total": 342638, "training_iteration": 770, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-07", "timestamp": 1651738927, "time_this_iter_s": 0.4971444606781006, "time_total_s": 447.8196156024933, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 447.8196156024933, "timesteps_since_restore": 3153920, "iterations_since_restore": 770, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.342, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.155, "metanash": -0.155}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25308594332456646, "mean_inference_ms": 0.443544712620338, "mean_action_processing_ms": 0.029023358143974002, "mean_env_wait_ms": 0.08609956699117469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 814080, "timesteps_this_iter": 4096, "agent_timesteps_total": 814079, "timers": {"load_time_ms": 0.14, "load_throughput": 29352245.317, "learn_time_ms": 5.95, "learn_throughput": 688436.707, "update_time_ms": 1.353}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4179444909095764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 814080, "num_agent_steps_sampled": 814079, "num_steps_trained": 3194880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6389760, "last_target_update_ts": 804864, "num_target_updates": 78}, "done": false, "episodes_total": 347037, "training_iteration": 780, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-13", "timestamp": 1651738933, "time_this_iter_s": 0.515557050704956, "time_total_s": 453.569890499115, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 453.569890499115, "timesteps_since_restore": 3194880, "iterations_since_restore": 780, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.362, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.246, "metanash": -0.246}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531064995050145, "mean_inference_ms": 0.4435506507470879, "mean_action_processing_ms": 0.029025758882197508, "mean_env_wait_ms": 0.08609793386421577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 824320, "timesteps_this_iter": 4096, "agent_timesteps_total": 824317, "timers": {"load_time_ms": 0.139, "load_throughput": 29387391.693, "learn_time_ms": 5.878, "learn_throughput": 696822.061, "update_time_ms": 1.411}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41796302795410156, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 824320, "num_agent_steps_sampled": 824317, "num_steps_trained": 3235840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6471680, "last_target_update_ts": 815104, "num_target_updates": 79}, "done": false, "episodes_total": 351402, "training_iteration": 790, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-19", "timestamp": 1651738939, "time_this_iter_s": 0.5045473575592041, "time_total_s": 459.56526827812195, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 459.56526827812195, "timesteps_since_restore": 3235840, "iterations_since_restore": 790, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.342, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.213, "metanash": -0.213}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531870305341202, "mean_inference_ms": 0.44361587254779816, "mean_action_processing_ms": 0.029034851074935617, "mean_env_wait_ms": 0.08612571778580785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 834560, "timesteps_this_iter": 4096, "agent_timesteps_total": 834558, "timers": {"load_time_ms": 0.139, "load_throughput": 29432703.759, "learn_time_ms": 5.707, "learn_throughput": 717729.867, "update_time_ms": 1.498}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41557687520980835, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 834560, "num_agent_steps_sampled": 834558, "num_steps_trained": 3276800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6553600, "last_target_update_ts": 825344, "num_target_updates": 80}, "done": false, "episodes_total": 355778, "training_iteration": 800, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-25", "timestamp": 1651738945, "time_this_iter_s": 0.5018103122711182, "time_total_s": 465.4873285293579, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 465.4873285293579, "timesteps_since_restore": 3276800, "iterations_since_restore": 800, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.35, "episode_media": {}, "episodes_this_iter": 432, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.228, "metanash": -0.228}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25324934140064015, "mean_inference_ms": 0.4438128558155912, "mean_action_processing_ms": 0.02904037888132592, "mean_env_wait_ms": 0.08614049605822513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 844800, "timesteps_this_iter": 4096, "agent_timesteps_total": 844799, "timers": {"load_time_ms": 0.139, "load_throughput": 29498401.758, "learn_time_ms": 5.813, "learn_throughput": 704676.379, "update_time_ms": 1.346}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40720224380493164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 844800, "num_agent_steps_sampled": 844799, "num_steps_trained": 3317760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6635520, "last_target_update_ts": 835584, "num_target_updates": 81}, "done": false, "episodes_total": 360145, "training_iteration": 810, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-32", "timestamp": 1651738952, "time_this_iter_s": 0.46539735794067383, "time_total_s": 471.6698639392853, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 471.6698639392853, "timesteps_since_restore": 3317760, "iterations_since_restore": 810, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.333, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.172, "metanash": -0.172}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25325949348845783, "mean_inference_ms": 0.4440104544859056, "mean_action_processing_ms": 0.02904158638207957, "mean_env_wait_ms": 0.08614575002484777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 855040, "timesteps_this_iter": 4096, "agent_timesteps_total": 855039, "timers": {"load_time_ms": 0.138, "load_throughput": 29769310.664, "learn_time_ms": 6.188, "learn_throughput": 661907.262, "update_time_ms": 1.411}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4232726991176605, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 855040, "num_agent_steps_sampled": 855039, "num_steps_trained": 3358720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6717440, "last_target_update_ts": 845824, "num_target_updates": 82}, "done": false, "episodes_total": 364538, "training_iteration": 820, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-38", "timestamp": 1651738958, "time_this_iter_s": 0.47689366340637207, "time_total_s": 477.6010835170746, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 477.6010835170746, "timesteps_since_restore": 3358720, "iterations_since_restore": 820, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.325, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.18, "metanash": -0.18}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25331166872293165, "mean_inference_ms": 0.44404988915713184, "mean_action_processing_ms": 0.029044450789841414, "mean_env_wait_ms": 0.0861629075784014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 865280, "timesteps_this_iter": 4096, "agent_timesteps_total": 865278, "timers": {"load_time_ms": 0.136, "load_throughput": 30061013.445, "learn_time_ms": 5.722, "learn_throughput": 715851.744, "update_time_ms": 1.354}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.414843887090683, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 865280, "num_agent_steps_sampled": 865278, "num_steps_trained": 3399680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6799360, "last_target_update_ts": 856064, "num_target_updates": 83}, "done": false, "episodes_total": 368908, "training_iteration": 830, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-44", "timestamp": 1651738964, "time_this_iter_s": 0.4716339111328125, "time_total_s": 483.69757556915283, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 483.69757556915283, "timesteps_since_restore": 3399680, "iterations_since_restore": 830, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.325, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.112, "metanash": -0.112}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25325335254148384, "mean_inference_ms": 0.4438566868888374, "mean_action_processing_ms": 0.02903628770304774, "mean_env_wait_ms": 0.0861397157533903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 875520, "timesteps_this_iter": 4096, "agent_timesteps_total": 875518, "timers": {"load_time_ms": 0.135, "load_throughput": 30283569.864, "learn_time_ms": 5.976, "learn_throughput": 685374.413, "update_time_ms": 1.286}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4121697247028351, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 875520, "num_agent_steps_sampled": 875518, "num_steps_trained": 3440640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6881280, "last_target_update_ts": 866304, "num_target_updates": 84}, "done": false, "episodes_total": 373302, "training_iteration": 840, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-50", "timestamp": 1651738970, "time_this_iter_s": 0.47716379165649414, "time_total_s": 489.616384267807, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 489.616384267807, "timesteps_since_restore": 3440640, "iterations_since_restore": 840, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.35, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.187, "metanash": -0.187}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531841040404361, "mean_inference_ms": 0.44374707209949743, "mean_action_processing_ms": 0.02903071347398792, "mean_env_wait_ms": 0.08611406573139252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 885760, "timesteps_this_iter": 4096, "agent_timesteps_total": 885758, "timers": {"load_time_ms": 0.138, "load_throughput": 29681874.886, "learn_time_ms": 5.953, "learn_throughput": 688100.307, "update_time_ms": 1.342}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41956827044487, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 885760, "num_agent_steps_sampled": 885758, "num_steps_trained": 3481600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 6963200, "last_target_update_ts": 876544, "num_target_updates": 85}, "done": false, "episodes_total": 377677, "training_iteration": 850, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-22-56", "timestamp": 1651738976, "time_this_iter_s": 0.44968509674072266, "time_total_s": 495.5574493408203, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 495.5574493408203, "timesteps_since_restore": 3481600, "iterations_since_restore": 850, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.332, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.133, "metanash": -0.133}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531666830328166, "mean_inference_ms": 0.4436234569100236, "mean_action_processing_ms": 0.02902548402288705, "mean_env_wait_ms": 0.08610947862890046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 896000, "timesteps_this_iter": 4096, "agent_timesteps_total": 895997, "timers": {"load_time_ms": 0.139, "load_throughput": 29468043.197, "learn_time_ms": 6.323, "learn_throughput": 647773.842, "update_time_ms": 1.393}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4254242777824402, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 896000, "num_agent_steps_sampled": 895997, "num_steps_trained": 3522560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7045120, "last_target_update_ts": 886784, "num_target_updates": 86}, "done": false, "episodes_total": 382065, "training_iteration": 860, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-02", "timestamp": 1651738982, "time_this_iter_s": 0.4821321964263916, "time_total_s": 501.4290964603424, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 501.4290964603424, "timesteps_since_restore": 3522560, "iterations_since_restore": 860, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.337, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.181, "metanash": -0.181}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531565023375727, "mean_inference_ms": 0.4435942228544566, "mean_action_processing_ms": 0.029026343286801887, "mean_env_wait_ms": 0.08611105843881185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 906240, "timesteps_this_iter": 4096, "agent_timesteps_total": 906237, "timers": {"load_time_ms": 0.146, "load_throughput": 28021316.562, "learn_time_ms": 6.162, "learn_throughput": 664744.999, "update_time_ms": 1.441}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40468186140060425, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 906240, "num_agent_steps_sampled": 906237, "num_steps_trained": 3563520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7127040, "last_target_update_ts": 897024, "num_target_updates": 87}, "done": false, "episodes_total": 386446, "training_iteration": 870, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-09", "timestamp": 1651738989, "time_this_iter_s": 0.5061616897583008, "time_total_s": 508.64351534843445, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 508.64351534843445, "timesteps_since_restore": 3563520, "iterations_since_restore": 870, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.327, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.165, "metanash": -0.165}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531317773415666, "mean_inference_ms": 0.4435534585632038, "mean_action_processing_ms": 0.029026209492091445, "mean_env_wait_ms": 0.08610263203160021, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 916480, "timesteps_this_iter": 4096, "agent_timesteps_total": 916477, "timers": {"load_time_ms": 0.141, "load_throughput": 29024952.161, "learn_time_ms": 6.028, "learn_throughput": 679508.171, "update_time_ms": 1.387}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4165222942829132, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 916480, "num_agent_steps_sampled": 916477, "num_steps_trained": 3604480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7208960, "last_target_update_ts": 907264, "num_target_updates": 88}, "done": false, "episodes_total": 390844, "training_iteration": 880, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-16", "timestamp": 1651738996, "time_this_iter_s": 1.5762102603912354, "time_total_s": 515.6585206985474, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 515.6585206985474, "timesteps_since_restore": 3604480, "iterations_since_restore": 880, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.322, "episode_media": {}, "episodes_this_iter": 444, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.191, "metanash": -0.191}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25318530868887335, "mean_inference_ms": 0.4435776885436527, "mean_action_processing_ms": 0.029028319380755414, "mean_env_wait_ms": 0.08611629940080616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 926720, "timesteps_this_iter": 4096, "agent_timesteps_total": 926718, "timers": {"load_time_ms": 0.139, "load_throughput": 29528822.936, "learn_time_ms": 5.976, "learn_throughput": 685437.306, "update_time_ms": 1.268}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4116359055042267, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 926720, "num_agent_steps_sampled": 926718, "num_steps_trained": 3645440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7290880, "last_target_update_ts": 917504, "num_target_updates": 89}, "done": false, "episodes_total": 395236, "training_iteration": 890, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-22", "timestamp": 1651739002, "time_this_iter_s": 0.5894486904144287, "time_total_s": 521.9125649929047, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 521.9125649929047, "timesteps_since_restore": 3645440, "iterations_since_restore": 890, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.351, "episode_media": {}, "episodes_this_iter": 443, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.182, "metanash": -0.182}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25324857931472333, "mean_inference_ms": 0.44366000547837775, "mean_action_processing_ms": 0.029036701686156546, "mean_env_wait_ms": 0.0861355390863174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 936960, "timesteps_this_iter": 4096, "agent_timesteps_total": 936958, "timers": {"load_time_ms": 0.14, "load_throughput": 29337208.306, "learn_time_ms": 5.96, "learn_throughput": 687208.512, "update_time_ms": 1.348}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.405681848526001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 936960, "num_agent_steps_sampled": 936958, "num_steps_trained": 3686400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7372800, "last_target_update_ts": 927744, "num_target_updates": 90}, "done": false, "episodes_total": 399605, "training_iteration": 900, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-28", "timestamp": 1651739008, "time_this_iter_s": 0.5033230781555176, "time_total_s": 527.8405914306641, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 527.8405914306641, "timesteps_since_restore": 3686400, "iterations_since_restore": 900, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.32, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.119, "metanash": -0.119}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532782373701363, "mean_inference_ms": 0.4436048560562118, "mean_action_processing_ms": 0.02903458389144928, "mean_env_wait_ms": 0.08613945250883069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 947200, "timesteps_this_iter": 4096, "agent_timesteps_total": 947199, "timers": {"load_time_ms": 0.137, "load_throughput": 29971858.311, "learn_time_ms": 6.09, "learn_throughput": 672596.728, "update_time_ms": 1.383}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42248937487602234, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 947200, "num_agent_steps_sampled": 947199, "num_steps_trained": 3727360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7454720, "last_target_update_ts": 937984, "num_target_updates": 91}, "done": false, "episodes_total": 404021, "training_iteration": 910, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-34", "timestamp": 1651739014, "time_this_iter_s": 0.4611086845397949, "time_total_s": 533.700582742691, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 533.700582742691, "timesteps_since_restore": 3727360, "iterations_since_restore": 910, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.326, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.15, "metanash": -0.15}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532877547117979, "mean_inference_ms": 0.44356888360205476, "mean_action_processing_ms": 0.029034734910501826, "mean_env_wait_ms": 0.08613743190586148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 957440, "timesteps_this_iter": 4096, "agent_timesteps_total": 957437, "timers": {"load_time_ms": 0.138, "load_throughput": 29764153.125, "learn_time_ms": 5.773, "learn_throughput": 709510.285, "update_time_ms": 1.332}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4193199872970581, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 957440, "num_agent_steps_sampled": 957437, "num_steps_trained": 3768320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7536640, "last_target_update_ts": 948224, "num_target_updates": 92}, "done": false, "episodes_total": 408419, "training_iteration": 920, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-40", "timestamp": 1651739020, "time_this_iter_s": 0.46938490867614746, "time_total_s": 539.7131097316742, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 539.7131097316742, "timesteps_since_restore": 3768320, "iterations_since_restore": 920, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.342, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.157, "metanash": -0.157}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25331872420477375, "mean_inference_ms": 0.4435899662268494, "mean_action_processing_ms": 0.0290367921993833, "mean_env_wait_ms": 0.08614123017904592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 967680, "timesteps_this_iter": 4096, "agent_timesteps_total": 967677, "timers": {"load_time_ms": 0.139, "load_throughput": 29372318.66, "learn_time_ms": 5.781, "learn_throughput": 708492.038, "update_time_ms": 1.36}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41681569814682007, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 967680, "num_agent_steps_sampled": 967677, "num_steps_trained": 3809280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7618560, "last_target_update_ts": 958464, "num_target_updates": 93}, "done": false, "episodes_total": 412792, "training_iteration": 930, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-46", "timestamp": 1651739026, "time_this_iter_s": 0.5970706939697266, "time_total_s": 545.7789268493652, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 545.7789268493652, "timesteps_since_restore": 3809280, "iterations_since_restore": 930, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.3, "episode_media": {}, "episodes_this_iter": 444, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.091, "metanash": -0.091}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25335343064883065, "mean_inference_ms": 0.4435561586196718, "mean_action_processing_ms": 0.029038673602879185, "mean_env_wait_ms": 0.08614891349107553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 977920, "timesteps_this_iter": 4096, "agent_timesteps_total": 977917, "timers": {"load_time_ms": 0.137, "load_throughput": 29862452.953, "learn_time_ms": 5.875, "learn_throughput": 697200.996, "update_time_ms": 1.333}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41366592049598694, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 977920, "num_agent_steps_sampled": 977917, "num_steps_trained": 3850240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7700480, "last_target_update_ts": 968704, "num_target_updates": 94}, "done": false, "episodes_total": 417197, "training_iteration": 940, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-52", "timestamp": 1651739032, "time_this_iter_s": 0.4496755599975586, "time_total_s": 551.6344413757324, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 551.6344413757324, "timesteps_since_restore": 3850240, "iterations_since_restore": 940, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.287, "episode_media": {}, "episodes_this_iter": 447, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.057, "metanash": -0.057}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25346258416416995, "mean_inference_ms": 0.44364869320209893, "mean_action_processing_ms": 0.029045699025886995, "mean_env_wait_ms": 0.08617167572531861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 988160, "timesteps_this_iter": 4096, "agent_timesteps_total": 988156, "timers": {"load_time_ms": 0.138, "load_throughput": 29687003.947, "learn_time_ms": 6.291, "learn_throughput": 651110.238, "update_time_ms": 1.345}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4235193729400635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 988160, "num_agent_steps_sampled": 988156, "num_steps_trained": 3891200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7782400, "last_target_update_ts": 978944, "num_target_updates": 95}, "done": false, "episodes_total": 421602, "training_iteration": 950, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-23-58", "timestamp": 1651739038, "time_this_iter_s": 0.4849874973297119, "time_total_s": 557.6550598144531, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 557.6550598144531, "timesteps_since_restore": 3891200, "iterations_since_restore": 950, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.348, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.177, "metanash": -0.177}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533357876086966, "mean_inference_ms": 0.4434528775695387, "mean_action_processing_ms": 0.02902940569165208, "mean_env_wait_ms": 0.08613425761857536, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 998400, "timesteps_this_iter": 4096, "agent_timesteps_total": 998398, "timers": {"load_time_ms": 0.139, "load_throughput": 29493337.655, "learn_time_ms": 6.26, "learn_throughput": 654364.016, "update_time_ms": 1.472}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4108416438102722, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 998400, "num_agent_steps_sampled": 998398, "num_steps_trained": 3932160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7864320, "last_target_update_ts": 989184, "num_target_updates": 96}, "done": false, "episodes_total": 425965, "training_iteration": 960, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-04", "timestamp": 1651739044, "time_this_iter_s": 0.46050024032592773, "time_total_s": 563.4298777580261, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 563.4298777580261, "timesteps_since_restore": 3932160, "iterations_since_restore": 960, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.343, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.201, "metanash": -0.201}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25324699820609087, "mean_inference_ms": 0.44357213109819127, "mean_action_processing_ms": 0.029021787716627577, "mean_env_wait_ms": 0.08610184192159966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1008640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1008638, "timers": {"load_time_ms": 0.137, "load_throughput": 29998025.465, "learn_time_ms": 5.605, "learn_throughput": 730793.933, "update_time_ms": 1.313}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.410571813583374, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1008640, "num_agent_steps_sampled": 1008638, "num_steps_trained": 3973120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 7946240, "last_target_update_ts": 999424, "num_target_updates": 97}, "done": false, "episodes_total": 430352, "training_iteration": 970, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-10", "timestamp": 1651739050, "time_this_iter_s": 0.49181699752807617, "time_total_s": 569.3671433925629, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 569.3671433925629, "timesteps_since_restore": 3973120, "iterations_since_restore": 970, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.324, "episode_media": {}, "episodes_this_iter": 443, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.131, "metanash": -0.131}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533054120688716, "mean_inference_ms": 0.4435854509064092, "mean_action_processing_ms": 0.029026679772113113, "mean_env_wait_ms": 0.08611987774482953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1018880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1018879, "timers": {"load_time_ms": 0.137, "load_throughput": 29846888.784, "learn_time_ms": 5.649, "learn_throughput": 725124.584, "update_time_ms": 1.45}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4017419219017029, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1018880, "num_agent_steps_sampled": 1018879, "num_steps_trained": 4014080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8028160, "last_target_update_ts": 1009664, "num_target_updates": 98}, "done": false, "episodes_total": 434749, "training_iteration": 980, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-16", "timestamp": 1651739056, "time_this_iter_s": 0.48447608947753906, "time_total_s": 575.2267484664917, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 575.2267484664917, "timesteps_since_restore": 4014080, "iterations_since_restore": 980, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.31, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.158, "metanash": -0.158}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533067643885785, "mean_inference_ms": 0.44354782292960915, "mean_action_processing_ms": 0.029026579067905574, "mean_env_wait_ms": 0.08612747622364324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1029120, "timesteps_this_iter": 4096, "agent_timesteps_total": 1029117, "timers": {"load_time_ms": 0.146, "load_throughput": 27975686.67, "learn_time_ms": 5.829, "learn_throughput": 702635.894, "update_time_ms": 1.393}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41556188464164734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1029120, "num_agent_steps_sampled": 1029117, "num_steps_trained": 4055040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8110080, "last_target_update_ts": 1019904, "num_target_updates": 99}, "done": false, "episodes_total": 439146, "training_iteration": 990, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-22", "timestamp": 1651739062, "time_this_iter_s": 0.5128023624420166, "time_total_s": 581.1017820835114, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 581.1017820835114, "timesteps_since_restore": 4055040, "iterations_since_restore": 990, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.305, "episode_media": {}, "episodes_this_iter": 451, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.133, "metanash": -0.133}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25329185484289624, "mean_inference_ms": 0.44348835905226897, "mean_action_processing_ms": 0.02902692868896919, "mean_env_wait_ms": 0.08611792809446404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1039360, "timesteps_this_iter": 4096, "agent_timesteps_total": 1039356, "timers": {"load_time_ms": 0.143, "load_throughput": 28719273.126, "learn_time_ms": 6.135, "learn_throughput": 667677.227, "update_time_ms": 1.361}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42349135875701904, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1039360, "num_agent_steps_sampled": 1039356, "num_steps_trained": 4096000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8192000, "last_target_update_ts": 1030144, "num_target_updates": 100}, "done": false, "episodes_total": 443551, "training_iteration": 1000, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-28", "timestamp": 1651739068, "time_this_iter_s": 0.5109481811523438, "time_total_s": 587.0834610462189, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 587.0834610462189, "timesteps_since_restore": 4096000, "iterations_since_restore": 1000, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.334, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.17, "metanash": -0.17}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532823721031841, "mean_inference_ms": 0.4434347087867911, "mean_action_processing_ms": 0.02901978390714866, "mean_env_wait_ms": 0.08610624728316256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1049600, "timesteps_this_iter": 4096, "agent_timesteps_total": 1049597, "timers": {"load_time_ms": 0.139, "load_throughput": 29554221.889, "learn_time_ms": 5.571, "learn_throughput": 735194.121, "update_time_ms": 1.328}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4095889627933502, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1049600, "num_agent_steps_sampled": 1049597, "num_steps_trained": 4136960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8273920, "last_target_update_ts": 1040384, "num_target_updates": 101}, "done": false, "episodes_total": 447947, "training_iteration": 1010, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-34", "timestamp": 1651739074, "time_this_iter_s": 0.45739293098449707, "time_total_s": 593.0492627620697, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 593.0492627620697, "timesteps_since_restore": 4136960, "iterations_since_restore": 1010, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.344, "episode_media": {}, "episodes_this_iter": 432, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.188, "metanash": -0.188}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531696920794127, "mean_inference_ms": 0.44320247248293504, "mean_action_processing_ms": 0.02901030463406453, "mean_env_wait_ms": 0.08607150443498314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1059840, "timesteps_this_iter": 4096, "agent_timesteps_total": 1059838, "timers": {"load_time_ms": 0.139, "load_throughput": 29508535.184, "learn_time_ms": 6.065, "learn_throughput": 675319.942, "update_time_ms": 1.345}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4105394184589386, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1059840, "num_agent_steps_sampled": 1059838, "num_steps_trained": 4177920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8355840, "last_target_update_ts": 1050624, "num_target_updates": 102}, "done": false, "episodes_total": 452342, "training_iteration": 1020, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-41", "timestamp": 1651739081, "time_this_iter_s": 1.5398094654083252, "time_total_s": 600.1528298854828, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 600.1528298854828, "timesteps_since_restore": 4177920, "iterations_since_restore": 1020, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.05, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.32, "episode_media": {}, "episodes_this_iter": 446, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.145, "metanash": -0.145}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532567611510771, "mean_inference_ms": 0.44325779434173534, "mean_action_processing_ms": 0.029013145773511703, "mean_env_wait_ms": 0.0860974137196763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1070080, "timesteps_this_iter": 4096, "agent_timesteps_total": 1070078, "timers": {"load_time_ms": 0.138, "load_throughput": 29640906.115, "learn_time_ms": 5.494, "learn_throughput": 745472.853, "update_time_ms": 1.226}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4209958016872406, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1070080, "num_agent_steps_sampled": 1070078, "num_steps_trained": 4218880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8437760, "last_target_update_ts": 1060864, "num_target_updates": 103}, "done": false, "episodes_total": 456727, "training_iteration": 1030, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-47", "timestamp": 1651739087, "time_this_iter_s": 0.4850575923919678, "time_total_s": 606.2503607273102, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 606.2503607273102, "timesteps_since_restore": 4218880, "iterations_since_restore": 1030, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.149, "metanash": -0.149}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25309988874472916, "mean_inference_ms": 0.4430094347570203, "mean_action_processing_ms": 0.029000463696658228, "mean_env_wait_ms": 0.08604841779818743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1080320, "timesteps_this_iter": 4096, "agent_timesteps_total": 1080318, "timers": {"load_time_ms": 0.139, "load_throughput": 29498401.758, "learn_time_ms": 5.601, "learn_throughput": 731238.739, "update_time_ms": 1.293}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4151948392391205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1080320, "num_agent_steps_sampled": 1080318, "num_steps_trained": 4259840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8519680, "last_target_update_ts": 1071104, "num_target_updates": 104}, "done": false, "episodes_total": 461093, "training_iteration": 1040, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-53", "timestamp": 1651739093, "time_this_iter_s": 0.5342466831207275, "time_total_s": 612.1426813602448, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 612.1426813602448, "timesteps_since_restore": 4259840, "iterations_since_restore": 1040, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.327, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.137, "metanash": -0.137}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25313023597936424, "mean_inference_ms": 0.4430003044865585, "mean_action_processing_ms": 0.028998544296145734, "mean_env_wait_ms": 0.08605785025758647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1090560, "timesteps_this_iter": 4096, "agent_timesteps_total": 1090558, "timers": {"load_time_ms": 0.139, "load_throughput": 29362278.558, "learn_time_ms": 5.843, "learn_throughput": 701010.278, "update_time_ms": 1.388}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4196328818798065, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1090560, "num_agent_steps_sampled": 1090558, "num_steps_trained": 4300800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8601600, "last_target_update_ts": 1081344, "num_target_updates": 105}, "done": false, "episodes_total": 465479, "training_iteration": 1050, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-24-59", "timestamp": 1651739099, "time_this_iter_s": 0.4650146961212158, "time_total_s": 618.0873584747314, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 618.0873584747314, "timesteps_since_restore": 4300800, "iterations_since_restore": 1050, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.341, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.189, "metanash": -0.189}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25313663393163593, "mean_inference_ms": 0.4430013290890764, "mean_action_processing_ms": 0.02900022697202553, "mean_env_wait_ms": 0.08605757511791358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1100800, "timesteps_this_iter": 4096, "agent_timesteps_total": 1100800, "timers": {"load_time_ms": 0.138, "load_throughput": 29743540.831, "learn_time_ms": 5.995, "learn_throughput": 683221.153, "update_time_ms": 1.454}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40833044052124023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1100800, "num_agent_steps_sampled": 1100800, "num_steps_trained": 4341760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8683520, "last_target_update_ts": 1091584, "num_target_updates": 106}, "done": false, "episodes_total": 469877, "training_iteration": 1060, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-05", "timestamp": 1651739105, "time_this_iter_s": 0.4703242778778076, "time_total_s": 623.9982550144196, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 623.9982550144196, "timesteps_since_restore": 4341760, "iterations_since_restore": 1060, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.334, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.205, "metanash": -0.205}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531216656466961, "mean_inference_ms": 0.4432712429255034, "mean_action_processing_ms": 0.02900018091080781, "mean_env_wait_ms": 0.08605231685707534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1111040, "timesteps_this_iter": 4096, "agent_timesteps_total": 1111036, "timers": {"load_time_ms": 0.138, "load_throughput": 29738392.217, "learn_time_ms": 5.768, "learn_throughput": 710114.42, "update_time_ms": 1.337}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41279566287994385, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1111040, "num_agent_steps_sampled": 1111036, "num_steps_trained": 4382720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8765440, "last_target_update_ts": 1101824, "num_target_updates": 107}, "done": false, "episodes_total": 474257, "training_iteration": 1070, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-12", "timestamp": 1651739112, "time_this_iter_s": 0.49733805656433105, "time_total_s": 630.0814111232758, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 630.0814111232758, "timesteps_since_restore": 4382720, "iterations_since_restore": 1070, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.362, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.242, "metanash": -0.242}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2530717167398807, "mean_inference_ms": 0.4431663465202248, "mean_action_processing_ms": 0.02898970392935136, "mean_env_wait_ms": 0.08603364283361009, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1121280, "timesteps_this_iter": 4096, "agent_timesteps_total": 1121278, "timers": {"load_time_ms": 0.137, "load_throughput": 29841704.332, "learn_time_ms": 5.695, "learn_throughput": 719262.36, "update_time_ms": 1.294}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41756072640419006, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1121280, "num_agent_steps_sampled": 1121278, "num_steps_trained": 4423680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8847360, "last_target_update_ts": 1112064, "num_target_updates": 108}, "done": false, "episodes_total": 478644, "training_iteration": 1080, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-18", "timestamp": 1651739118, "time_this_iter_s": 0.4586191177368164, "time_total_s": 636.0286808013916, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 636.0286808013916, "timesteps_since_restore": 4423680, "iterations_since_restore": 1080, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.147, "metanash": -0.147}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531347714965117, "mean_inference_ms": 0.4432070923349396, "mean_action_processing_ms": 0.028994221232471893, "mean_env_wait_ms": 0.08605543642138715, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1131520, "timesteps_this_iter": 4096, "agent_timesteps_total": 1131518, "timers": {"load_time_ms": 0.143, "load_throughput": 28575963.38, "learn_time_ms": 6.314, "learn_throughput": 648744.952, "update_time_ms": 1.386}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4119037389755249, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1131520, "num_agent_steps_sampled": 1131518, "num_steps_trained": 4464640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 8929280, "last_target_update_ts": 1122304, "num_target_updates": 109}, "done": false, "episodes_total": 483026, "training_iteration": 1090, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-24", "timestamp": 1651739124, "time_this_iter_s": 0.4892709255218506, "time_total_s": 642.0642113685608, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 642.0642113685608, "timesteps_since_restore": 4464640, "iterations_since_restore": 1090, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.361, "episode_media": {}, "episodes_this_iter": 432, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.224, "metanash": -0.224}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2530225311497515, "mean_inference_ms": 0.44305212926052734, "mean_action_processing_ms": 0.028985116212934158, "mean_env_wait_ms": 0.0860214155087653, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1141760, "timesteps_this_iter": 4096, "agent_timesteps_total": 1141757, "timers": {"load_time_ms": 0.137, "load_throughput": 29831340.83, "learn_time_ms": 5.664, "learn_throughput": 723113.249, "update_time_ms": 1.303}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4102998971939087, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1141760, "num_agent_steps_sampled": 1141757, "num_steps_trained": 4505600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9011200, "last_target_update_ts": 1132544, "num_target_updates": 110}, "done": false, "episodes_total": 487406, "training_iteration": 1100, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-30", "timestamp": 1651739130, "time_this_iter_s": 0.48138928413391113, "time_total_s": 647.9523394107819, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 647.9523394107819, "timesteps_since_restore": 4505600, "iterations_since_restore": 1100, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.125, "metanash": -0.125}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25307520501723546, "mean_inference_ms": 0.4430579962738561, "mean_action_processing_ms": 0.028989873146908995, "mean_env_wait_ms": 0.08603993217775054, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1152000, "timesteps_this_iter": 4096, "agent_timesteps_total": 1152000, "timers": {"load_time_ms": 0.149, "load_throughput": 27518611.539, "learn_time_ms": 6.176, "learn_throughput": 663166.904, "update_time_ms": 1.32}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4290725886821747, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1152000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 4546560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9093120, "last_target_update_ts": 1142784, "num_target_updates": 111}, "done": false, "episodes_total": 491806, "training_iteration": 1110, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-36", "timestamp": 1651739136, "time_this_iter_s": 0.5046167373657227, "time_total_s": 653.9350833892822, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 653.9350833892822, "timesteps_since_restore": 4546560, "iterations_since_restore": 1110, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 9.8, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.342, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.16, "metanash": -0.16}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2530473342088747, "mean_inference_ms": 0.4430140934286777, "mean_action_processing_ms": 0.028990161078593823, "mean_env_wait_ms": 0.08603080199523437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1162240, "timesteps_this_iter": 4096, "agent_timesteps_total": 1162238, "timers": {"load_time_ms": 0.138, "load_throughput": 29733245.386, "learn_time_ms": 5.806, "learn_throughput": 705489.522, "update_time_ms": 1.295}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4069569706916809, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1162240, "num_agent_steps_sampled": 1162238, "num_steps_trained": 4587520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9175040, "last_target_update_ts": 1153024, "num_target_updates": 112}, "done": false, "episodes_total": 496196, "training_iteration": 1120, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-42", "timestamp": 1651739142, "time_this_iter_s": 0.4998619556427002, "time_total_s": 659.9501695632935, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 659.9501695632935, "timesteps_since_restore": 4587520, "iterations_since_restore": 1120, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.357, "episode_media": {}, "episodes_this_iter": 432, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.254, "metanash": -0.254}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25309068463761153, "mean_inference_ms": 0.44305928699053265, "mean_action_processing_ms": 0.028993231402076724, "mean_env_wait_ms": 0.08603810640468533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1172480, "timesteps_this_iter": 4096, "agent_timesteps_total": 1172478, "timers": {"load_time_ms": 0.14, "load_throughput": 29357261.08, "learn_time_ms": 5.809, "learn_throughput": 705066.801, "update_time_ms": 1.281}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.414097398519516, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1172480, "num_agent_steps_sampled": 1172478, "num_steps_trained": 4628480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9256960, "last_target_update_ts": 1163264, "num_target_updates": 113}, "done": false, "episodes_total": 500578, "training_iteration": 1130, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-48", "timestamp": 1651739148, "time_this_iter_s": 0.5122413635253906, "time_total_s": 665.9661433696747, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 665.9661433696747, "timesteps_since_restore": 4628480, "iterations_since_restore": 1130, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.347, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.221, "metanash": -0.221}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531865985733194, "mean_inference_ms": 0.44319569198446107, "mean_action_processing_ms": 0.029003286960633853, "mean_env_wait_ms": 0.08606668908639419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1182720, "timesteps_this_iter": 4096, "agent_timesteps_total": 1182717, "timers": {"load_time_ms": 0.139, "load_throughput": 29387391.693, "learn_time_ms": 5.735, "learn_throughput": 714241.671, "update_time_ms": 1.38}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41082537174224854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1182720, "num_agent_steps_sampled": 1182717, "num_steps_trained": 4669440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9338880, "last_target_update_ts": 1173504, "num_target_updates": 114}, "done": false, "episodes_total": 504945, "training_iteration": 1140, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-25-54", "timestamp": 1651739154, "time_this_iter_s": 0.5032641887664795, "time_total_s": 672.0974586009979, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 672.0974586009979, "timesteps_since_restore": 4669440, "iterations_since_restore": 1140, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.321, "episode_media": {}, "episodes_this_iter": 444, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.096, "metanash": -0.096}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25332060247977584, "mean_inference_ms": 0.4433494564901747, "mean_action_processing_ms": 0.029020627134573502, "mean_env_wait_ms": 0.08611033148895912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1192960, "timesteps_this_iter": 4096, "agent_timesteps_total": 1192958, "timers": {"load_time_ms": 0.146, "load_throughput": 28113024.356, "learn_time_ms": 5.992, "learn_throughput": 683607.197, "update_time_ms": 1.386}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4137266278266907, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1192960, "num_agent_steps_sampled": 1192958, "num_steps_trained": 4710400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9420800, "last_target_update_ts": 1183744, "num_target_updates": 115}, "done": false, "episodes_total": 509344, "training_iteration": 1150, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-00", "timestamp": 1651739160, "time_this_iter_s": 0.5335018634796143, "time_total_s": 678.3567485809326, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 678.3567485809326, "timesteps_since_restore": 4710400, "iterations_since_restore": 1150, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.334, "episode_media": {}, "episodes_this_iter": 444, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.175, "metanash": -0.175}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533626291475234, "mean_inference_ms": 0.4434340188665885, "mean_action_processing_ms": 0.029024987105821055, "mean_env_wait_ms": 0.08612197643246475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1203200, "timesteps_this_iter": 4096, "agent_timesteps_total": 1203198, "timers": {"load_time_ms": 0.138, "load_throughput": 29717815.575, "learn_time_ms": 5.501, "learn_throughput": 744535.948, "update_time_ms": 1.34}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4210789203643799, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1203200, "num_agent_steps_sampled": 1203198, "num_steps_trained": 4751360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9502720, "last_target_update_ts": 1193984, "num_target_updates": 116}, "done": false, "episodes_total": 513725, "training_iteration": 1160, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-08", "timestamp": 1651739168, "time_this_iter_s": 1.5875294208526611, "time_total_s": 685.5505104064941, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 685.5505104064941, "timesteps_since_restore": 4751360, "iterations_since_restore": 1160, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.4, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.319, "episode_media": {}, "episodes_this_iter": 445, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.125, "metanash": -0.125}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2535241108674259, "mean_inference_ms": 0.44366254503963426, "mean_action_processing_ms": 0.02904253090941457, "mean_env_wait_ms": 0.08617607730725992, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1213440, "timesteps_this_iter": 4096, "agent_timesteps_total": 1213438, "timers": {"load_time_ms": 0.139, "load_throughput": 29407513.153, "learn_time_ms": 5.818, "learn_throughput": 704003.556, "update_time_ms": 1.403}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.433647483587265, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1213440, "num_agent_steps_sampled": 1213438, "num_steps_trained": 4792320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9584640, "last_target_update_ts": 1204224, "num_target_updates": 117}, "done": false, "episodes_total": 518101, "training_iteration": 1170, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-14", "timestamp": 1651739174, "time_this_iter_s": 1.565673589706421, "time_total_s": 691.7494943141937, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 691.7494943141937, "timesteps_since_restore": 4792320, "iterations_since_restore": 1170, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.050000000000001, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.339, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.188, "metanash": -0.188}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2535296628893605, "mean_inference_ms": 0.44391357186594, "mean_action_processing_ms": 0.029042617260221473, "mean_env_wait_ms": 0.0861709951333474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1223680, "timesteps_this_iter": 4096, "agent_timesteps_total": 1223679, "timers": {"load_time_ms": 0.137, "load_throughput": 29987553.123, "learn_time_ms": 5.82, "learn_throughput": 703830.505, "update_time_ms": 1.323}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41904762387275696, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1223680, "num_agent_steps_sampled": 1223679, "num_steps_trained": 4833280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9666560, "last_target_update_ts": 1214464, "num_target_updates": 118}, "done": false, "episodes_total": 522503, "training_iteration": 1180, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-20", "timestamp": 1651739180, "time_this_iter_s": 0.48611998558044434, "time_total_s": 697.8555426597595, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 697.8555426597595, "timesteps_since_restore": 4833280, "iterations_since_restore": 1180, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.355, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.214, "metanash": -0.214}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2534841058401734, "mean_inference_ms": 0.44381470073751206, "mean_action_processing_ms": 0.029037025372221643, "mean_env_wait_ms": 0.0861529138693056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1233920, "timesteps_this_iter": 4096, "agent_timesteps_total": 1233918, "timers": {"load_time_ms": 0.139, "load_throughput": 29422622.339, "learn_time_ms": 6.038, "learn_throughput": 678314.277, "update_time_ms": 1.398}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40432390570640564, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1233920, "num_agent_steps_sampled": 1233918, "num_steps_trained": 4874240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9748480, "last_target_update_ts": 1224704, "num_target_updates": 119}, "done": false, "episodes_total": 526889, "training_iteration": 1190, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-26", "timestamp": 1651739186, "time_this_iter_s": 0.5536398887634277, "time_total_s": 703.8730070590973, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 703.8730070590973, "timesteps_since_restore": 4874240, "iterations_since_restore": 1190, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.355, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.184, "metanash": -0.184}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25343032497054746, "mean_inference_ms": 0.44372167100870114, "mean_action_processing_ms": 0.029031058680513814, "mean_env_wait_ms": 0.08613989863724282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1244160, "timesteps_this_iter": 4096, "agent_timesteps_total": 1244159, "timers": {"load_time_ms": 0.139, "load_throughput": 29442792.089, "learn_time_ms": 5.803, "learn_throughput": 705840.243, "update_time_ms": 1.507}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4125388264656067, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1244160, "num_agent_steps_sampled": 1244159, "num_steps_trained": 4915200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9830400, "last_target_update_ts": 1234944, "num_target_updates": 120}, "done": false, "episodes_total": 531276, "training_iteration": 1200, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-32", "timestamp": 1651739192, "time_this_iter_s": 0.4691736698150635, "time_total_s": 709.7602984905243, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 709.7602984905243, "timesteps_since_restore": 4915200, "iterations_since_restore": 1200, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.325, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.169, "metanash": -0.169}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2534389409044575, "mean_inference_ms": 0.44366792710723785, "mean_action_processing_ms": 0.02903488961260883, "mean_env_wait_ms": 0.08615274597303625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1254400, "timesteps_this_iter": 4096, "agent_timesteps_total": 1254398, "timers": {"load_time_ms": 0.137, "load_throughput": 29914450.956, "learn_time_ms": 5.748, "learn_throughput": 712603.352, "update_time_ms": 1.443}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40434780716896057, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1254400, "num_agent_steps_sampled": 1254398, "num_steps_trained": 4956160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9912320, "last_target_update_ts": 1245184, "num_target_updates": 121}, "done": false, "episodes_total": 535668, "training_iteration": 1210, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-38", "timestamp": 1651739198, "time_this_iter_s": 0.47003722190856934, "time_total_s": 715.682413816452, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 715.682413816452, "timesteps_since_restore": 4956160, "iterations_since_restore": 1210, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.348, "episode_media": {}, "episodes_this_iter": 433, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.225, "metanash": -0.225}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533637760508925, "mean_inference_ms": 0.44356820265776237, "mean_action_processing_ms": 0.02902764319107976, "mean_env_wait_ms": 0.08613001808775723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1264640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1264636, "timers": {"load_time_ms": 0.145, "load_throughput": 28298252.65, "learn_time_ms": 6.044, "learn_throughput": 677741.627, "update_time_ms": 1.413}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4232816994190216, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1264640, "num_agent_steps_sampled": 1264636, "num_steps_trained": 4997120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 9994240, "last_target_update_ts": 1255424, "num_target_updates": 122}, "done": false, "episodes_total": 540055, "training_iteration": 1220, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-44", "timestamp": 1651739204, "time_this_iter_s": 0.4874999523162842, "time_total_s": 721.6420695781708, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 721.6420695781708, "timesteps_since_restore": 4997120, "iterations_since_restore": 1220, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.36, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.21, "metanash": -0.21}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2533638596632061, "mean_inference_ms": 0.4435594940681724, "mean_action_processing_ms": 0.02902939013362913, "mean_env_wait_ms": 0.08613384509568002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1274880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1274878, "timers": {"load_time_ms": 0.138, "load_throughput": 29728100.336, "learn_time_ms": 5.556, "learn_throughput": 737279.648, "update_time_ms": 1.342}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.43144503235816956, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1274880, "num_agent_steps_sampled": 1274878, "num_steps_trained": 5038080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10076160, "last_target_update_ts": 1265664, "num_target_updates": 123}, "done": false, "episodes_total": 544438, "training_iteration": 1230, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-50", "timestamp": 1651739210, "time_this_iter_s": 0.4585685729980469, "time_total_s": 727.6335575580597, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 727.6335575580597, "timesteps_since_restore": 5038080, "iterations_since_restore": 1230, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.305, "episode_media": {}, "episodes_this_iter": 445, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.097, "metanash": -0.097}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2534032061549994, "mean_inference_ms": 0.44353724057971927, "mean_action_processing_ms": 0.029031394918681955, "mean_env_wait_ms": 0.0861521649247033, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1285120, "timesteps_this_iter": 4096, "agent_timesteps_total": 1285117, "timers": {"load_time_ms": 0.136, "load_throughput": 30124266.498, "learn_time_ms": 5.653, "learn_throughput": 724555.761, "update_time_ms": 1.288}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41660887002944946, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1285120, "num_agent_steps_sampled": 1285117, "num_steps_trained": 5079040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10158080, "last_target_update_ts": 1275904, "num_target_updates": 124}, "done": false, "episodes_total": 548838, "training_iteration": 1240, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-26-56", "timestamp": 1651739216, "time_this_iter_s": 0.46111130714416504, "time_total_s": 733.8189237117767, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 733.8189237117767, "timesteps_since_restore": 5079040, "iterations_since_restore": 1240, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.343, "episode_media": {}, "episodes_this_iter": 429, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.141, "metanash": -0.141}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532843937080724, "mean_inference_ms": 0.44335228916819347, "mean_action_processing_ms": 0.029023307953081875, "mean_env_wait_ms": 0.08611599766637569, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1295360, "timesteps_this_iter": 4096, "agent_timesteps_total": 1295357, "timers": {"load_time_ms": 0.139, "load_throughput": 29452887.338, "learn_time_ms": 5.823, "learn_throughput": 703470.255, "update_time_ms": 1.379}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4325903058052063, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1295360, "num_agent_steps_sampled": 1295357, "num_steps_trained": 5120000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10240000, "last_target_update_ts": 1286144, "num_target_updates": 125}, "done": false, "episodes_total": 553219, "training_iteration": 1250, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-02", "timestamp": 1651739222, "time_this_iter_s": 0.46976184844970703, "time_total_s": 739.746776342392, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 739.746776342392, "timesteps_since_restore": 5120000, "iterations_since_restore": 1250, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.361, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.227, "metanash": -0.227}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25316293665485745, "mean_inference_ms": 0.44318161380806065, "mean_action_processing_ms": 0.029008209939190066, "mean_env_wait_ms": 0.08607808084818842, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1305600, "timesteps_this_iter": 4096, "agent_timesteps_total": 1305599, "timers": {"load_time_ms": 0.136, "load_throughput": 30013747.701, "learn_time_ms": 6.015, "learn_throughput": 681003.087, "update_time_ms": 1.362}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4226285219192505, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1305600, "num_agent_steps_sampled": 1305599, "num_steps_trained": 5160960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10321920, "last_target_update_ts": 1296384, "num_target_updates": 126}, "done": false, "episodes_total": 557599, "training_iteration": 1260, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-08", "timestamp": 1651739228, "time_this_iter_s": 0.4727816581726074, "time_total_s": 745.7251744270325, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 745.7251744270325, "timesteps_since_restore": 5160960, "iterations_since_restore": 1260, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.328, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.168, "metanash": -0.168}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25327088271525283, "mean_inference_ms": 0.44329068115704845, "mean_action_processing_ms": 0.02902039312420768, "mean_env_wait_ms": 0.08611753919060251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1315840, "timesteps_this_iter": 4096, "agent_timesteps_total": 1315838, "timers": {"load_time_ms": 0.139, "load_throughput": 29362278.558, "learn_time_ms": 6.062, "learn_throughput": 675718.367, "update_time_ms": 1.309}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42024222016334534, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1315840, "num_agent_steps_sampled": 1315838, "num_steps_trained": 5201920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10403840, "last_target_update_ts": 1306624, "num_target_updates": 127}, "done": false, "episodes_total": 561977, "training_iteration": 1270, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-15", "timestamp": 1651739235, "time_this_iter_s": 0.5025355815887451, "time_total_s": 751.853417634964, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 751.853417634964, "timesteps_since_restore": 5201920, "iterations_since_restore": 1270, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.327, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.159, "metanash": -0.159}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25326415908605754, "mean_inference_ms": 0.443472100684764, "mean_action_processing_ms": 0.029021441601401507, "mean_env_wait_ms": 0.08611738178609298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1326080, "timesteps_this_iter": 4096, "agent_timesteps_total": 1326076, "timers": {"load_time_ms": 0.14, "load_throughput": 29157958.561, "learn_time_ms": 5.961, "learn_throughput": 687153.538, "update_time_ms": 1.294}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4115630090236664, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1326080, "num_agent_steps_sampled": 1326076, "num_steps_trained": 5242880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10485760, "last_target_update_ts": 1316864, "num_target_updates": 128}, "done": false, "episodes_total": 566363, "training_iteration": 1280, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-21", "timestamp": 1651739241, "time_this_iter_s": 0.540010929107666, "time_total_s": 758.1558845043182, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 758.1558845043182, "timesteps_since_restore": 5242880, "iterations_since_restore": 1280, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.2, "ram_util_percent": 5.6}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.32, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.157, "metanash": -0.157}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25326352743121383, "mean_inference_ms": 0.44343132665147705, "mean_action_processing_ms": 0.029018679900030243, "mean_env_wait_ms": 0.08611145737775314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1336320, "timesteps_this_iter": 4096, "agent_timesteps_total": 1336317, "timers": {"load_time_ms": 0.137, "load_throughput": 29878033.363, "learn_time_ms": 5.558, "learn_throughput": 736985.508, "update_time_ms": 1.269}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41057515144348145, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1336320, "num_agent_steps_sampled": 1336317, "num_steps_trained": 5283840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10567680, "last_target_update_ts": 1327104, "num_target_updates": 129}, "done": false, "episodes_total": 570759, "training_iteration": 1290, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-27", "timestamp": 1651739247, "time_this_iter_s": 0.4515509605407715, "time_total_s": 764.1319718360901, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 764.1319718360901, "timesteps_since_restore": 5283840, "iterations_since_restore": 1290, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.339, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.183, "metanash": -0.183}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532303181979792, "mean_inference_ms": 0.4433412500812698, "mean_action_processing_ms": 0.029014315369763233, "mean_env_wait_ms": 0.08609947403604823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1346560, "timesteps_this_iter": 4096, "agent_timesteps_total": 1346559, "timers": {"load_time_ms": 0.139, "load_throughput": 29518675.574, "learn_time_ms": 5.697, "learn_throughput": 718928.261, "update_time_ms": 1.393}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4130311906337738, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1346560, "num_agent_steps_sampled": 1346559, "num_steps_trained": 5324800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10649600, "last_target_update_ts": 1337344, "num_target_updates": 130}, "done": false, "episodes_total": 575150, "training_iteration": 1300, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-34", "timestamp": 1651739254, "time_this_iter_s": 1.6077697277069092, "time_total_s": 771.2502903938293, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 771.2502903938293, "timesteps_since_restore": 5324800, "iterations_since_restore": 1300, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.337, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.163, "metanash": -0.163}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25322653187232624, "mean_inference_ms": 0.443300674395373, "mean_action_processing_ms": 0.029010565663292135, "mean_env_wait_ms": 0.08609511314310836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1356800, "timesteps_this_iter": 4096, "agent_timesteps_total": 1356796, "timers": {"load_time_ms": 0.14, "load_throughput": 29252288.752, "learn_time_ms": 5.851, "learn_throughput": 700036.232, "update_time_ms": 1.307}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4229164719581604, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1356800, "num_agent_steps_sampled": 1356796, "num_steps_trained": 5365760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10731520, "last_target_update_ts": 1347584, "num_target_updates": 131}, "done": false, "episodes_total": 579531, "training_iteration": 1310, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-40", "timestamp": 1651739260, "time_this_iter_s": 1.614595651626587, "time_total_s": 777.2040243148804, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 777.2040243148804, "timesteps_since_restore": 5365760, "iterations_since_restore": 1310, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.346, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.209, "metanash": -0.209}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2531822581091082, "mean_inference_ms": 0.4432277131517079, "mean_action_processing_ms": 0.02900890877768005, "mean_env_wait_ms": 0.08608441937255408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1367040, "timesteps_this_iter": 4096, "agent_timesteps_total": 1367037, "timers": {"load_time_ms": 0.141, "load_throughput": 28971111.609, "learn_time_ms": 6.187, "learn_throughput": 661991.43, "update_time_ms": 1.503}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42490893602371216, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1367040, "num_agent_steps_sampled": 1367037, "num_steps_trained": 5406720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10813440, "last_target_update_ts": 1357824, "num_target_updates": 132}, "done": false, "episodes_total": 583907, "training_iteration": 1320, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-46", "timestamp": 1651739266, "time_this_iter_s": 0.5292351245880127, "time_total_s": 783.241400718689, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 783.241400718689, "timesteps_since_restore": 5406720, "iterations_since_restore": 1320, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.342, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.172, "metanash": -0.172}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25321964819390186, "mean_inference_ms": 0.44324045618573293, "mean_action_processing_ms": 0.029011156504059783, "mean_env_wait_ms": 0.08609577090347381, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1377280, "timesteps_this_iter": 4096, "agent_timesteps_total": 1377277, "timers": {"load_time_ms": 0.137, "load_throughput": 29826161.778, "learn_time_ms": 5.757, "learn_throughput": 711514.327, "update_time_ms": 1.295}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42097610235214233, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1377280, "num_agent_steps_sampled": 1377277, "num_steps_trained": 5447680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10895360, "last_target_update_ts": 1368064, "num_target_updates": 133}, "done": false, "episodes_total": 588299, "training_iteration": 1330, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-52", "timestamp": 1651739272, "time_this_iter_s": 0.45187902450561523, "time_total_s": 789.2947356700897, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 789.2947356700897, "timesteps_since_restore": 5447680, "iterations_since_restore": 1330, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.341, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.129, "metanash": -0.129}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25323684097221455, "mean_inference_ms": 0.44323180777709953, "mean_action_processing_ms": 0.029013229126987464, "mean_env_wait_ms": 0.08609652397921468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1387520, "timesteps_this_iter": 4096, "agent_timesteps_total": 1387518, "timers": {"load_time_ms": 0.137, "load_throughput": 29930085.686, "learn_time_ms": 5.903, "learn_throughput": 693895.018, "update_time_ms": 1.437}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4139736294746399, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1387520, "num_agent_steps_sampled": 1387518, "num_steps_trained": 5488640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 10977280, "last_target_update_ts": 1378304, "num_target_updates": 134}, "done": false, "episodes_total": 592687, "training_iteration": 1340, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-27-59", "timestamp": 1651739279, "time_this_iter_s": 0.5028395652770996, "time_total_s": 795.3717045783997, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 795.3717045783997, "timesteps_since_restore": 5488640, "iterations_since_restore": 1340, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.332, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.167, "metanash": -0.167}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532927405617801, "mean_inference_ms": 0.44329620143753873, "mean_action_processing_ms": 0.029018554812468608, "mean_env_wait_ms": 0.0861117245692141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1397760, "timesteps_this_iter": 4096, "agent_timesteps_total": 1397757, "timers": {"load_time_ms": 0.141, "load_throughput": 28961343.871, "learn_time_ms": 5.887, "learn_throughput": 695746.888, "update_time_ms": 1.373}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41539517045021057, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1397760, "num_agent_steps_sampled": 1397757, "num_steps_trained": 5529600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11059200, "last_target_update_ts": 1388544, "num_target_updates": 135}, "done": false, "episodes_total": 597066, "training_iteration": 1350, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-05", "timestamp": 1651739285, "time_this_iter_s": 0.5456924438476562, "time_total_s": 801.3768348693848, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 801.3768348693848, "timesteps_since_restore": 5529600, "iterations_since_restore": 1350, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 5.5}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.339, "episode_media": {}, "episodes_this_iter": 433, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.154, "metanash": -0.154}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2534771404626739, "mean_inference_ms": 0.44356375841721435, "mean_action_processing_ms": 0.029033484334000628, "mean_env_wait_ms": 0.08615924843171073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1408000, "timesteps_this_iter": 4096, "agent_timesteps_total": 1407997, "timers": {"load_time_ms": 0.139, "load_throughput": 29554221.889, "learn_time_ms": 5.666, "learn_throughput": 722936.761, "update_time_ms": 1.386}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.414439857006073, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1408000, "num_agent_steps_sampled": 1407997, "num_steps_trained": 5570560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11141120, "last_target_update_ts": 1398784, "num_target_updates": 136}, "done": false, "episodes_total": 601456, "training_iteration": 1360, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-11", "timestamp": 1651739291, "time_this_iter_s": 0.4914703369140625, "time_total_s": 807.8534123897552, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 807.8534123897552, "timesteps_since_restore": 5570560, "iterations_since_restore": 1360, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 5.3}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.32, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.116, "metanash": -0.116}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2535451459244416, "mean_inference_ms": 0.44364411026375034, "mean_action_processing_ms": 0.0290422849482229, "mean_env_wait_ms": 0.08617733895010478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1418240, "timesteps_this_iter": 4096, "agent_timesteps_total": 1418238, "timers": {"load_time_ms": 0.145, "load_throughput": 28335591.595, "learn_time_ms": 6.228, "learn_throughput": 657718.457, "update_time_ms": 1.34}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4005158245563507, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1418240, "num_agent_steps_sampled": 1418238, "num_steps_trained": 5611520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11223040, "last_target_update_ts": 1409024, "num_target_updates": 137}, "done": false, "episodes_total": 605838, "training_iteration": 1370, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-17", "timestamp": 1651739297, "time_this_iter_s": 0.4928109645843506, "time_total_s": 814.0042116641998, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 814.0042116641998, "timesteps_since_restore": 5611520, "iterations_since_restore": 1370, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.338, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.172, "metanash": -0.172}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536006581960483, "mean_inference_ms": 0.4439229906226119, "mean_action_processing_ms": 0.029046336393149498, "mean_env_wait_ms": 0.08618774421374341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1428480, "timesteps_this_iter": 4096, "agent_timesteps_total": 1428479, "timers": {"load_time_ms": 0.142, "load_throughput": 28825283.866, "learn_time_ms": 6.022, "learn_throughput": 680145.737, "update_time_ms": 1.379}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4205787181854248, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1428480, "num_agent_steps_sampled": 1428479, "num_steps_trained": 5652480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11304960, "last_target_update_ts": 1419264, "num_target_updates": 138}, "done": false, "episodes_total": 610242, "training_iteration": 1380, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-24", "timestamp": 1651739304, "time_this_iter_s": 0.48034238815307617, "time_total_s": 820.2879383563995, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 820.2879383563995, "timesteps_since_restore": 5652480, "iterations_since_restore": 1380, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.31, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.141, "metanash": -0.141}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536284414818788, "mean_inference_ms": 0.44390388641215167, "mean_action_processing_ms": 0.02905153648680758, "mean_env_wait_ms": 0.08619526632584794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1438720, "timesteps_this_iter": 4096, "agent_timesteps_total": 1438717, "timers": {"load_time_ms": 0.136, "load_throughput": 30071537.168, "learn_time_ms": 5.553, "learn_throughput": 737570.857, "update_time_ms": 1.28}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41802266240119934, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1438720, "num_agent_steps_sampled": 1438717, "num_steps_trained": 5693440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11386880, "last_target_update_ts": 1429504, "num_target_updates": 139}, "done": false, "episodes_total": 614656, "training_iteration": 1390, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-30", "timestamp": 1651739310, "time_this_iter_s": 0.4830341339111328, "time_total_s": 826.3768322467804, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 826.3768322467804, "timesteps_since_restore": 5693440, "iterations_since_restore": 1390, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.338, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.214, "metanash": -0.214}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536713381772582, "mean_inference_ms": 0.4439868951652353, "mean_action_processing_ms": 0.029052592636768064, "mean_env_wait_ms": 0.08620212237728683, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1448960, "timesteps_this_iter": 4096, "agent_timesteps_total": 1448956, "timers": {"load_time_ms": 0.138, "load_throughput": 29656256.144, "learn_time_ms": 6.243, "learn_throughput": 656143.435, "update_time_ms": 1.349}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41427141427993774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1448960, "num_agent_steps_sampled": 1448956, "num_steps_trained": 5734400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11468800, "last_target_update_ts": 1439744, "num_target_updates": 140}, "done": false, "episodes_total": 619045, "training_iteration": 1400, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-36", "timestamp": 1651739316, "time_this_iter_s": 0.4849879741668701, "time_total_s": 832.7180407047272, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 832.7180407047272, "timesteps_since_restore": 5734400, "iterations_since_restore": 1400, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.126, "metanash": -0.126}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537033832897583, "mean_inference_ms": 0.44402142911027376, "mean_action_processing_ms": 0.02905872356509775, "mean_env_wait_ms": 0.08620992871379596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1459200, "timesteps_this_iter": 4096, "agent_timesteps_total": 1459196, "timers": {"load_time_ms": 0.141, "load_throughput": 29083916.005, "learn_time_ms": 6.248, "learn_throughput": 655575.071, "update_time_ms": 1.369}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41148021817207336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1459200, "num_agent_steps_sampled": 1459196, "num_steps_trained": 5775360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11550720, "last_target_update_ts": 1449984, "num_target_updates": 141}, "done": false, "episodes_total": 623416, "training_iteration": 1410, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-43", "timestamp": 1651739323, "time_this_iter_s": 0.5644636154174805, "time_total_s": 839.0422058105469, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 839.0422058105469, "timesteps_since_restore": 5775360, "iterations_since_restore": 1410, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.16, "metanash": -0.16}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25371163408054725, "mean_inference_ms": 0.44399531195298114, "mean_action_processing_ms": 0.02905630813059716, "mean_env_wait_ms": 0.08621140389981613, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1469440, "timesteps_this_iter": 4096, "agent_timesteps_total": 1469437, "timers": {"load_time_ms": 0.139, "load_throughput": 29377341.286, "learn_time_ms": 5.982, "learn_throughput": 684683.349, "update_time_ms": 1.341}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4134279191493988, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1469440, "num_agent_steps_sampled": 1469437, "num_steps_trained": 5816320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11632640, "last_target_update_ts": 1460224, "num_target_updates": 142}, "done": false, "episodes_total": 627807, "training_iteration": 1420, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-49", "timestamp": 1651739329, "time_this_iter_s": 0.5220456123352051, "time_total_s": 845.0516114234924, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 845.0516114234924, "timesteps_since_restore": 5816320, "iterations_since_restore": 1420, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.2, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.331, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.143, "metanash": -0.143}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25373003847001885, "mean_inference_ms": 0.44397798816337786, "mean_action_processing_ms": 0.02905913274857403, "mean_env_wait_ms": 0.0862199161166747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1479680, "timesteps_this_iter": 4096, "agent_timesteps_total": 1479678, "timers": {"load_time_ms": 0.137, "load_throughput": 29888429.339, "learn_time_ms": 5.676, "learn_throughput": 721634.03, "update_time_ms": 1.32}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41390547156333923, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1479680, "num_agent_steps_sampled": 1479678, "num_steps_trained": 5857280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11714560, "last_target_update_ts": 1470464, "num_target_updates": 143}, "done": false, "episodes_total": 632193, "training_iteration": 1430, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-28-55", "timestamp": 1651739335, "time_this_iter_s": 0.5383038520812988, "time_total_s": 851.2049796581268, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 851.2049796581268, "timesteps_since_restore": 5857280, "iterations_since_restore": 1430, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.332, "episode_media": {}, "episodes_this_iter": 443, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.169, "metanash": -0.169}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537736082005836, "mean_inference_ms": 0.44403784974620053, "mean_action_processing_ms": 0.029062351380562786, "mean_env_wait_ms": 0.08622431503407169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1489920, "timesteps_this_iter": 4096, "agent_timesteps_total": 1489918, "timers": {"load_time_ms": 0.139, "load_throughput": 29488275.29, "learn_time_ms": 5.787, "learn_throughput": 707785.668, "update_time_ms": 1.416}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4093824326992035, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1489920, "num_agent_steps_sampled": 1489918, "num_steps_trained": 5898240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11796480, "last_target_update_ts": 1480704, "num_target_updates": 144}, "done": false, "episodes_total": 636609, "training_iteration": 1440, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-02", "timestamp": 1651739342, "time_this_iter_s": 1.5983963012695312, "time_total_s": 858.6273286342621, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 858.6273286342621, "timesteps_since_restore": 5898240, "iterations_since_restore": 1440, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.311, "episode_media": {}, "episodes_this_iter": 447, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.098, "metanash": -0.098}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253815649014076, "mean_inference_ms": 0.4440565331405267, "mean_action_processing_ms": 0.029062946627413468, "mean_env_wait_ms": 0.08623646278106897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1500160, "timesteps_this_iter": 4096, "agent_timesteps_total": 1500160, "timers": {"load_time_ms": 0.144, "load_throughput": 28415264.942, "learn_time_ms": 6.259, "learn_throughput": 654403.897, "update_time_ms": 1.431}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42664456367492676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1500160, "num_agent_steps_sampled": 1500160, "num_steps_trained": 5939200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11878400, "last_target_update_ts": 1490944, "num_target_updates": 145}, "done": false, "episodes_total": 641012, "training_iteration": 1450, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-09", "timestamp": 1651739349, "time_this_iter_s": 0.49335741996765137, "time_total_s": 864.6888809204102, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 864.6888809204102, "timesteps_since_restore": 5939200, "iterations_since_restore": 1450, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.344, "episode_media": {}, "episodes_this_iter": 433, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.214, "metanash": -0.214}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25378743878160176, "mean_inference_ms": 0.4439997513768314, "mean_action_processing_ms": 0.02905664970048044, "mean_env_wait_ms": 0.08622160290034955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1510400, "timesteps_this_iter": 4096, "agent_timesteps_total": 1510398, "timers": {"load_time_ms": 0.138, "load_throughput": 29615358.014, "learn_time_ms": 5.687, "learn_throughput": 720185.002, "update_time_ms": 1.417}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4186898469924927, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1510400, "num_agent_steps_sampled": 1510398, "num_steps_trained": 5980160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 11960320, "last_target_update_ts": 1501184, "num_target_updates": 146}, "done": false, "episodes_total": 645419, "training_iteration": 1460, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-15", "timestamp": 1651739355, "time_this_iter_s": 0.489469051361084, "time_total_s": 870.7172646522522, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 870.7172646522522, "timesteps_since_restore": 5980160, "iterations_since_restore": 1460, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.342, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.187, "metanash": -0.187}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537518100859745, "mean_inference_ms": 0.4439042399760034, "mean_action_processing_ms": 0.029057545984954667, "mean_env_wait_ms": 0.08621446690873423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1520640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1520637, "timers": {"load_time_ms": 0.139, "load_throughput": 29447838.848, "learn_time_ms": 6.122, "learn_throughput": 669070.973, "update_time_ms": 1.4}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4159241318702698, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1520640, "num_agent_steps_sampled": 1520637, "num_steps_trained": 6021120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12042240, "last_target_update_ts": 1511424, "num_target_updates": 147}, "done": false, "episodes_total": 649809, "training_iteration": 1470, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-21", "timestamp": 1651739361, "time_this_iter_s": 0.545482873916626, "time_total_s": 876.7376525402069, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 876.7376525402069, "timesteps_since_restore": 6021120, "iterations_since_restore": 1470, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.322, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.142, "metanash": -0.142}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253705142664348, "mean_inference_ms": 0.44396214655189536, "mean_action_processing_ms": 0.029054193802627182, "mean_env_wait_ms": 0.08620242821639346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1530880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1530878, "timers": {"load_time_ms": 0.136, "load_throughput": 30182482.755, "learn_time_ms": 5.7, "learn_throughput": 718651.585, "update_time_ms": 1.246}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.418594628572464, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1530880, "num_agent_steps_sampled": 1530878, "num_steps_trained": 6062080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12124160, "last_target_update_ts": 1521664, "num_target_updates": 148}, "done": false, "episodes_total": 654204, "training_iteration": 1480, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-27", "timestamp": 1651739367, "time_this_iter_s": 0.5079255104064941, "time_total_s": 882.9327166080475, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 882.9327166080475, "timesteps_since_restore": 6062080, "iterations_since_restore": 1480, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.359, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.244, "metanash": -0.244}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537095826308652, "mean_inference_ms": 0.443987124589913, "mean_action_processing_ms": 0.029049938864436492, "mean_env_wait_ms": 0.08619848820674719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1541120, "timesteps_this_iter": 4096, "agent_timesteps_total": 1541119, "timers": {"load_time_ms": 0.139, "load_throughput": 29493337.655, "learn_time_ms": 6.151, "learn_throughput": 665938.026, "update_time_ms": 1.396}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4195824861526489, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1541120, "num_agent_steps_sampled": 1541119, "num_steps_trained": 6103040, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12206080, "last_target_update_ts": 1531904, "num_target_updates": 149}, "done": false, "episodes_total": 658587, "training_iteration": 1490, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-33", "timestamp": 1651739373, "time_this_iter_s": 0.5573623180389404, "time_total_s": 889.1121518611908, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 889.1121518611908, "timesteps_since_restore": 6103040, "iterations_since_restore": 1490, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.8, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.339, "episode_media": {}, "episodes_this_iter": 435, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.144, "metanash": -0.144}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25370591921094654, "mean_inference_ms": 0.44393667485415506, "mean_action_processing_ms": 0.029051511660261133, "mean_env_wait_ms": 0.08619719113791663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1551360, "timesteps_this_iter": 4096, "agent_timesteps_total": 1551357, "timers": {"load_time_ms": 0.138, "load_throughput": 29697267.388, "learn_time_ms": 5.596, "learn_throughput": 731936.587, "update_time_ms": 1.277}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4240530729293823, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1551360, "num_agent_steps_sampled": 1551357, "num_steps_trained": 6144000, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12288000, "last_target_update_ts": 1542144, "num_target_updates": 150}, "done": false, "episodes_total": 662977, "training_iteration": 1500, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-39", "timestamp": 1651739379, "time_this_iter_s": 0.472808837890625, "time_total_s": 895.1607000827789, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 895.1607000827789, "timesteps_since_restore": 6144000, "iterations_since_restore": 1500, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.316, "episode_media": {}, "episodes_this_iter": 447, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.166, "metanash": -0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253666632267994, "mean_inference_ms": 0.4438392744877949, "mean_action_processing_ms": 0.029048096404212097, "mean_env_wait_ms": 0.08618646350859283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1561600, "timesteps_this_iter": 4096, "agent_timesteps_total": 1561597, "timers": {"load_time_ms": 0.14, "load_throughput": 29297184.829, "learn_time_ms": 5.966, "learn_throughput": 686576.848, "update_time_ms": 1.356}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4146925210952759, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1561600, "num_agent_steps_sampled": 1561597, "num_steps_trained": 6184960, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12369920, "last_target_update_ts": 1552384, "num_target_updates": 151}, "done": false, "episodes_total": 667368, "training_iteration": 1510, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-46", "timestamp": 1651739386, "time_this_iter_s": 0.4698812961578369, "time_total_s": 901.3032298088074, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 901.3032298088074, "timesteps_since_restore": 6184960, "iterations_since_restore": 1510, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.325, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.135, "metanash": -0.135}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536475175132082, "mean_inference_ms": 0.4437820695408982, "mean_action_processing_ms": 0.029045276204773315, "mean_env_wait_ms": 0.08617926937273387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1571840, "timesteps_this_iter": 4096, "agent_timesteps_total": 1571838, "timers": {"load_time_ms": 0.135, "load_throughput": 30288908.999, "learn_time_ms": 5.591, "learn_throughput": 732651.39, "update_time_ms": 1.307}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4180639386177063, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1571840, "num_agent_steps_sampled": 1571838, "num_steps_trained": 6225920, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12451840, "last_target_update_ts": 1562624, "num_target_updates": 152}, "done": false, "episodes_total": 671762, "training_iteration": 1520, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-52", "timestamp": 1651739392, "time_this_iter_s": 0.45122385025024414, "time_total_s": 907.4295613765717, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 907.4295613765717, "timesteps_since_restore": 6225920, "iterations_since_restore": 1520, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.329, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.19, "metanash": -0.19}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25372667273002963, "mean_inference_ms": 0.4438875563104671, "mean_action_processing_ms": 0.029051639985817227, "mean_env_wait_ms": 0.08619970019018555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1582080, "timesteps_this_iter": 4096, "agent_timesteps_total": 1582078, "timers": {"load_time_ms": 0.137, "load_throughput": 29852075.037, "learn_time_ms": 6.437, "learn_throughput": 636274.955, "update_time_ms": 1.405}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4122713506221771, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1582080, "num_agent_steps_sampled": 1582078, "num_steps_trained": 6266880, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12533760, "last_target_update_ts": 1572864, "num_target_updates": 153}, "done": false, "episodes_total": 676152, "training_iteration": 1530, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-29-58", "timestamp": 1651739398, "time_this_iter_s": 0.5063278675079346, "time_total_s": 913.6510574817657, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 913.6510574817657, "timesteps_since_restore": 6266880, "iterations_since_restore": 1530, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 447, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.166, "metanash": -0.166}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537108053992264, "mean_inference_ms": 0.4438398212912797, "mean_action_processing_ms": 0.029052927934225245, "mean_env_wait_ms": 0.08619848207512332, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1592320, "timesteps_this_iter": 4096, "agent_timesteps_total": 1592317, "timers": {"load_time_ms": 0.142, "load_throughput": 28893153.69, "learn_time_ms": 5.687, "learn_throughput": 720218.213, "update_time_ms": 1.344}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.42047548294067383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1592320, "num_agent_steps_sampled": 1592317, "num_steps_trained": 6307840, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12615680, "last_target_update_ts": 1583104, "num_target_updates": 154}, "done": false, "episodes_total": 680546, "training_iteration": 1540, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-04", "timestamp": 1651739404, "time_this_iter_s": 0.5090987682342529, "time_total_s": 919.7461588382721, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 919.7461588382721, "timesteps_since_restore": 6307840, "iterations_since_restore": 1540, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.308, "episode_media": {}, "episodes_this_iter": 448, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.098, "metanash": -0.098}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25375534712403147, "mean_inference_ms": 0.4438793715588555, "mean_action_processing_ms": 0.029055388948785447, "mean_env_wait_ms": 0.08621136644136664, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1602560, "timesteps_this_iter": 4096, "agent_timesteps_total": 1602557, "timers": {"load_time_ms": 0.138, "load_throughput": 29640906.115, "learn_time_ms": 5.738, "learn_throughput": 713802.468, "update_time_ms": 1.352}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4132882356643677, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1602560, "num_agent_steps_sampled": 1602557, "num_steps_trained": 6348800, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12697600, "last_target_update_ts": 1593344, "num_target_updates": 155}, "done": false, "episodes_total": 684952, "training_iteration": 1550, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-10", "timestamp": 1651739410, "time_this_iter_s": 0.5404953956604004, "time_total_s": 925.9227540493011, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 925.9227540493011, "timesteps_since_restore": 6348800, "iterations_since_restore": 1550, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.328, "episode_media": {}, "episodes_this_iter": 440, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.2, "metanash": -0.2}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253767860322897, "mean_inference_ms": 0.4438853630071974, "mean_action_processing_ms": 0.029055326668779097, "mean_env_wait_ms": 0.08621270254304893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1612800, "timesteps_this_iter": 4096, "agent_timesteps_total": 1612799, "timers": {"load_time_ms": 0.145, "load_throughput": 28265661.705, "learn_time_ms": 6.196, "learn_throughput": 661102.379, "update_time_ms": 1.303}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.417233943939209, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1612800, "num_agent_steps_sampled": 1612799, "num_steps_trained": 6389760, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12779520, "last_target_update_ts": 1603584, "num_target_updates": 156}, "done": false, "episodes_total": 689352, "training_iteration": 1560, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-17", "timestamp": 1651739417, "time_this_iter_s": 0.457935094833374, "time_total_s": 932.0240049362183, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 932.0240049362183, "timesteps_since_restore": 6389760, "iterations_since_restore": 1560, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.326, "episode_media": {}, "episodes_this_iter": 437, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.148, "metanash": -0.148}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537229324482988, "mean_inference_ms": 0.4437862205811596, "mean_action_processing_ms": 0.02905128077054165, "mean_env_wait_ms": 0.08620038356199552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1623040, "timesteps_this_iter": 4096, "agent_timesteps_total": 1623036, "timers": {"load_time_ms": 0.137, "load_throughput": 29795125.189, "learn_time_ms": 5.654, "learn_throughput": 724390.785, "update_time_ms": 1.317}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4075503945350647, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1623040, "num_agent_steps_sampled": 1623036, "num_steps_trained": 6430720, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12861440, "last_target_update_ts": 1613824, "num_target_updates": 157}, "done": false, "episodes_total": 693743, "training_iteration": 1570, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-23", "timestamp": 1651739423, "time_this_iter_s": 0.48265838623046875, "time_total_s": 937.9588475227356, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 937.9588475227356, "timesteps_since_restore": 6430720, "iterations_since_restore": 1570, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.322, "episode_media": {}, "episodes_this_iter": 442, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.126, "metanash": -0.126}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537446340477538, "mean_inference_ms": 0.4438498967992421, "mean_action_processing_ms": 0.02905343913629097, "mean_env_wait_ms": 0.08620152008825488, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1633280, "timesteps_this_iter": 4096, "agent_timesteps_total": 1633278, "timers": {"load_time_ms": 0.138, "load_throughput": 29615358.014, "learn_time_ms": 5.951, "learn_throughput": 688285.011, "update_time_ms": 1.35}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.423312246799469, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1633280, "num_agent_steps_sampled": 1633278, "num_steps_trained": 6471680, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 12943360, "last_target_update_ts": 1624064, "num_target_updates": 158}, "done": false, "episodes_total": 698136, "training_iteration": 1580, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-30", "timestamp": 1651739430, "time_this_iter_s": 1.7487967014312744, "time_total_s": 945.519448518753, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 945.519448518753, "timesteps_since_restore": 6471680, "iterations_since_restore": 1580, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.2, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.331, "episode_media": {}, "episodes_this_iter": 441, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.14, "metanash": -0.14}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537672461972037, "mean_inference_ms": 0.4440214142128808, "mean_action_processing_ms": 0.029051991316038424, "mean_env_wait_ms": 0.08620204098689134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1643520, "timesteps_this_iter": 4096, "agent_timesteps_total": 1643518, "timers": {"load_time_ms": 0.138, "load_throughput": 29610253.678, "learn_time_ms": 5.934, "learn_throughput": 690231.787, "update_time_ms": 1.389}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.40970578789711, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1643520, "num_agent_steps_sampled": 1643518, "num_steps_trained": 6512640, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13025280, "last_target_update_ts": 1634304, "num_target_updates": 159}, "done": false, "episodes_total": 702514, "training_iteration": 1590, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-37", "timestamp": 1651739437, "time_this_iter_s": 0.555001974105835, "time_total_s": 951.9890429973602, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 951.9890429973602, "timesteps_since_restore": 6512640, "iterations_since_restore": 1590, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.336, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.186, "metanash": -0.186}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25380080249972503, "mean_inference_ms": 0.44406235647011116, "mean_action_processing_ms": 0.029055496308922707, "mean_env_wait_ms": 0.08621536205001311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1653760, "timesteps_this_iter": 4096, "agent_timesteps_total": 1653758, "timers": {"load_time_ms": 0.137, "load_throughput": 29883230.447, "learn_time_ms": 5.735, "learn_throughput": 714256.518, "update_time_ms": 1.42}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4025312662124634, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1653760, "num_agent_steps_sampled": 1653758, "num_steps_trained": 6553600, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13107200, "last_target_update_ts": 1644544, "num_target_updates": 160}, "done": false, "episodes_total": 706894, "training_iteration": 1600, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-43", "timestamp": 1651739443, "time_this_iter_s": 0.45212221145629883, "time_total_s": 958.176504611969, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 958.176504611969, "timesteps_since_restore": 6553600, "iterations_since_restore": 1600, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.357, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.23, "metanash": -0.23}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25373454666485756, "mean_inference_ms": 0.44395184688218453, "mean_action_processing_ms": 0.029052302121825527, "mean_env_wait_ms": 0.0862021532511342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1664000, "timesteps_this_iter": 4096, "agent_timesteps_total": 1663997, "timers": {"load_time_ms": 0.141, "load_throughput": 28961343.871, "learn_time_ms": 6.123, "learn_throughput": 668938.109, "update_time_ms": 1.467}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4209449887275696, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1664000, "num_agent_steps_sampled": 1663997, "num_steps_trained": 6594560, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13189120, "last_target_update_ts": 1654784, "num_target_updates": 161}, "done": false, "episodes_total": 711256, "training_iteration": 1610, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-49", "timestamp": 1651739449, "time_this_iter_s": 0.5484907627105713, "time_total_s": 964.3394703865051, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 964.3394703865051, "timesteps_since_restore": 6594560, "iterations_since_restore": 1610, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.4, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.331, "episode_media": {}, "episodes_this_iter": 438, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.196, "metanash": -0.196}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25372051554594693, "mean_inference_ms": 0.44391134878963534, "mean_action_processing_ms": 0.029051643673588607, "mean_env_wait_ms": 0.08619930698221884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1674240, "timesteps_this_iter": 4096, "agent_timesteps_total": 1674237, "timers": {"load_time_ms": 0.141, "load_throughput": 29143119.905, "learn_time_ms": 6.203, "learn_throughput": 660274.073, "update_time_ms": 1.418}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4124128520488739, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1674240, "num_agent_steps_sampled": 1674237, "num_steps_trained": 6635520, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13271040, "last_target_update_ts": 1665024, "num_target_updates": 162}, "done": false, "episodes_total": 715638, "training_iteration": 1620, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-30-56", "timestamp": 1651739456, "time_this_iter_s": 0.514167308807373, "time_total_s": 970.6518132686615, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 970.6518132686615, "timesteps_since_restore": 6635520, "iterations_since_restore": 1620, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.32, "episode_media": {}, "episodes_this_iter": 445, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.099, "metanash": -0.099}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537755254817659, "mean_inference_ms": 0.44394891029997335, "mean_action_processing_ms": 0.02905606935960356, "mean_env_wait_ms": 0.08621128727373553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1684480, "timesteps_this_iter": 4096, "agent_timesteps_total": 1684478, "timers": {"load_time_ms": 0.143, "load_throughput": 28666559.626, "learn_time_ms": 6.186, "learn_throughput": 662090.928, "update_time_ms": 1.404}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41921529173851013, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1684480, "num_agent_steps_sampled": 1684478, "num_steps_trained": 6676480, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13352960, "last_target_update_ts": 1675264, "num_target_updates": 163}, "done": false, "episodes_total": 720035, "training_iteration": 1630, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-02", "timestamp": 1651739462, "time_this_iter_s": 0.5028843879699707, "time_total_s": 977.093385219574, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 977.093385219574, "timesteps_since_restore": 6676480, "iterations_since_restore": 1630, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.348, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.161, "metanash": -0.161}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253727201108874, "mean_inference_ms": 0.4438715940411298, "mean_action_processing_ms": 0.029051586754358275, "mean_env_wait_ms": 0.08619849025652246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1694720, "timesteps_this_iter": 4096, "agent_timesteps_total": 1694717, "timers": {"load_time_ms": 0.138, "load_throughput": 29717815.575, "learn_time_ms": 5.956, "learn_throughput": 687761.483, "update_time_ms": 1.33}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41755276918411255, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1694720, "num_agent_steps_sampled": 1694717, "num_steps_trained": 6717440, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13434880, "last_target_update_ts": 1685504, "num_target_updates": 164}, "done": false, "episodes_total": 724420, "training_iteration": 1640, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-08", "timestamp": 1651739468, "time_this_iter_s": 0.5638549327850342, "time_total_s": 983.2273736000061, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 983.2273736000061, "timesteps_since_restore": 6717440, "iterations_since_restore": 1640, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.344, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.222, "metanash": -0.222}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537139889584836, "mean_inference_ms": 0.443879952327002, "mean_action_processing_ms": 0.02905088004029222, "mean_env_wait_ms": 0.08619354227652366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1704960, "timesteps_this_iter": 4096, "agent_timesteps_total": 1704956, "timers": {"load_time_ms": 0.135, "load_throughput": 30272897.241, "learn_time_ms": 6.099, "learn_throughput": 671558.206, "update_time_ms": 1.387}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41619759798049927, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1704960, "num_agent_steps_sampled": 1704956, "num_steps_trained": 6758400, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13516800, "last_target_update_ts": 1695744, "num_target_updates": 165}, "done": false, "episodes_total": 728803, "training_iteration": 1650, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-15", "timestamp": 1651739475, "time_this_iter_s": 0.4617743492126465, "time_total_s": 989.5420620441437, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 989.5420620441437, "timesteps_since_restore": 6758400, "iterations_since_restore": 1650, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.337, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.128, "metanash": -0.128}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253753762659246, "mean_inference_ms": 0.4438833785536475, "mean_action_processing_ms": 0.029054721735547736, "mean_env_wait_ms": 0.08621407852877518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1715200, "timesteps_this_iter": 4096, "agent_timesteps_total": 1715197, "timers": {"load_time_ms": 0.138, "load_throughput": 29579664.573, "learn_time_ms": 6.06, "learn_throughput": 675893.823, "update_time_ms": 1.38}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4132606089115143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1715200, "num_agent_steps_sampled": 1715197, "num_steps_trained": 6799360, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13598720, "last_target_update_ts": 1705984, "num_target_updates": 166}, "done": false, "episodes_total": 733190, "training_iteration": 1660, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-21", "timestamp": 1651739481, "time_this_iter_s": 0.5832014083862305, "time_total_s": 995.8169710636139, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 995.8169710636139, "timesteps_since_restore": 6799360, "iterations_since_restore": 1660, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.216, "metanash": -0.216}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537130257357007, "mean_inference_ms": 0.4438425302913744, "mean_action_processing_ms": 0.02905044088422669, "mean_env_wait_ms": 0.0861990436438883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1725440, "timesteps_this_iter": 4096, "agent_timesteps_total": 1725436, "timers": {"load_time_ms": 0.138, "load_throughput": 29758997.374, "learn_time_ms": 5.775, "learn_throughput": 709237.881, "update_time_ms": 1.341}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4178335666656494, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1725440, "num_agent_steps_sampled": 1725436, "num_steps_trained": 6840320, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13680640, "last_target_update_ts": 1716224, "num_target_updates": 167}, "done": false, "episodes_total": 737578, "training_iteration": 1670, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-27", "timestamp": 1651739487, "time_this_iter_s": 0.48641371726989746, "time_total_s": 1001.9748547077179, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1001.9748547077179, "timesteps_since_restore": 6840320, "iterations_since_restore": 1670, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.33, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.139, "metanash": -0.139}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537403908145325, "mean_inference_ms": 0.4438461109982563, "mean_action_processing_ms": 0.029053320295024252, "mean_env_wait_ms": 0.08620763116263964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1735680, "timesteps_this_iter": 4096, "agent_timesteps_total": 1735678, "timers": {"load_time_ms": 0.137, "load_throughput": 29992788.38, "learn_time_ms": 5.649, "learn_throughput": 725038.898, "update_time_ms": 1.363}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4081606864929199, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1735680, "num_agent_steps_sampled": 1735678, "num_steps_trained": 6881280, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13762560, "last_target_update_ts": 1726464, "num_target_updates": 168}, "done": false, "episodes_total": 741961, "training_iteration": 1680, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-33", "timestamp": 1651739493, "time_this_iter_s": 0.4745903015136719, "time_total_s": 1008.1229937076569, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1008.1229937076569, "timesteps_since_restore": 6881280, "iterations_since_restore": 1680, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.34, "episode_media": {}, "episodes_this_iter": 434, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.188, "metanash": -0.188}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25385230526368757, "mean_inference_ms": 0.4440366399939841, "mean_action_processing_ms": 0.029059515218195348, "mean_env_wait_ms": 0.08622105992318833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1745920, "timesteps_this_iter": 4096, "agent_timesteps_total": 1745918, "timers": {"load_time_ms": 0.139, "load_throughput": 29493337.655, "learn_time_ms": 5.893, "learn_throughput": 695119.125, "update_time_ms": 1.457}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41676387190818787, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1745920, "num_agent_steps_sampled": 1745918, "num_steps_trained": 6922240, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13844480, "last_target_update_ts": 1736704, "num_target_updates": 169}, "done": false, "episodes_total": 746341, "training_iteration": 1690, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-40", "timestamp": 1651739500, "time_this_iter_s": 0.4929769039154053, "time_total_s": 1014.6242005825043, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1014.6242005825043, "timesteps_since_restore": 6922240, "iterations_since_restore": 1690, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.337, "episode_media": {}, "episodes_this_iter": 439, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.173, "metanash": -0.173}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253868642986318, "mean_inference_ms": 0.44405079429989674, "mean_action_processing_ms": 0.02905843005856268, "mean_env_wait_ms": 0.08622878050620619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1756160, "timesteps_this_iter": 4096, "agent_timesteps_total": 1756157, "timers": {"load_time_ms": 0.139, "load_throughput": 29362278.558, "learn_time_ms": 5.96, "learn_throughput": 687192.019, "update_time_ms": 1.458}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4233245551586151, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1756160, "num_agent_steps_sampled": 1756157, "num_steps_trained": 6963200, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 13926400, "last_target_update_ts": 1746944, "num_target_updates": 170}, "done": false, "episodes_total": 750726, "training_iteration": 1700, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-46", "timestamp": 1651739506, "time_this_iter_s": 0.5138692855834961, "time_total_s": 1020.8367342948914, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1020.8367342948914, "timesteps_since_restore": 6963200, "iterations_since_restore": 1700, "warmup_time": 1.601977825164795, "perf": {}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.336, "episode_media": {}, "episodes_this_iter": 433, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.152, "metanash": -0.152}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537985475280385, "mean_inference_ms": 0.44395518972259346, "mean_action_processing_ms": 0.029054549200737422, "mean_env_wait_ms": 0.08621003196666426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1766400, "timesteps_this_iter": 4096, "agent_timesteps_total": 1766397, "timers": {"load_time_ms": 0.139, "load_throughput": 29554221.889, "learn_time_ms": 6.128, "learn_throughput": 668370.773, "update_time_ms": 1.419}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.418016254901886, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1766400, "num_agent_steps_sampled": 1766397, "num_steps_trained": 7004160, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14008320, "last_target_update_ts": 1757184, "num_target_updates": 171}, "done": false, "episodes_total": 755080, "training_iteration": 1710, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-31-53", "timestamp": 1651739513, "time_this_iter_s": 0.5281403064727783, "time_total_s": 1027.007493019104, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1027.007493019104, "timesteps_since_restore": 7004160, "iterations_since_restore": 1710, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.348, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -1.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 1.0}, "policy_reward_mean": {"best_response": 0.226, "metanash": -0.226}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537805829170619, "mean_inference_ms": 0.44392153557967545, "mean_action_processing_ms": 0.02905339005292884, "mean_env_wait_ms": 0.08620697936719131, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1776640, "timesteps_this_iter": 4096, "agent_timesteps_total": 1776638, "timers": {"load_time_ms": 0.134, "load_throughput": 30493200.54, "learn_time_ms": 5.544, "learn_throughput": 738753.878, "update_time_ms": 1.333}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.4031582474708557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1776640, "num_agent_steps_sampled": 1776638, "num_steps_trained": 7045120, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14090240, "last_target_update_ts": 1767424, "num_target_updates": 172}, "done": false, "episodes_total": 759455, "training_iteration": 1720, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-32-00", "timestamp": 1651739520, "time_this_iter_s": 1.7336492538452148, "time_total_s": 1034.396467924118, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1034.396467924118, "timesteps_since_restore": 7045120, "iterations_since_restore": 1720, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 6.55, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 2.35, "episode_media": {}, "episodes_this_iter": 436, "policy_reward_min": {"best_response": -2.0, "metanash": -2.0}, "policy_reward_max": {"best_response": 2.0, "metanash": 2.0}, "policy_reward_mean": {"best_response": 0.217, "metanash": -0.217}, "custom_metrics": {}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25375137785276014, "mean_inference_ms": 0.44384962211278595, "mean_action_processing_ms": 0.02905217954317566, "mean_env_wait_ms": 0.0862015199612734, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1786880, "timesteps_this_iter": 4096, "agent_timesteps_total": 1786879, "timers": {"load_time_ms": 0.134, "load_throughput": 30471566.485, "learn_time_ms": 5.638, "learn_throughput": 726510.616, "update_time_ms": 1.296}, "info": {"learner": {"best_response": {"learner_stats": {"allreduce_latency": 0.0}, "loss": 0.41741788387298584, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4096.0}}, "num_steps_sampled": 1786880, "num_agent_steps_sampled": 1786879, "num_steps_trained": 7086080, "num_steps_trained_this_iter": 4096, "num_agent_steps_trained": 14172160, "last_target_update_ts": 1777664, "num_target_updates": 173}, "done": false, "episodes_total": 763835, "training_iteration": 1730, "trial_id": "default", "experiment_id": "17d30577442b47ac905bc5a3eb0f3a2f", "date": "2022-05-05_16-32-06", "timestamp": 1651739526, "time_this_iter_s": 1.7650339603424072, "time_total_s": 1040.6889832019806, "pid": 2851732, "hostname": "sjtu-marl1", "node_ip": "192.168.2.51", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 256, "batch_mode": "truncate_episodes", "gamma": 1.0, "lr": 0.01, "train_batch_size": 4096, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "PokerMultiAgentEnv", "observation_space": null, "action_space": null, "env_config": {"version": "kuhn_poker", "fixed_players": true}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class '__main__.train_psro_best_response.<locals>.P2SROPreAndPostEpisodeCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "<class 'rlapps.rllib_tools.valid_actions_epsilon_greedy.ValidActionsEpsilonGreedy'>", "initial_epsilon": 0.2, "final_epsilon": 0.001, "epsilon_timesteps": 100000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 1000, "min_time_s_per_reporting": 0, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"metanash": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {"explore": false}], "best_response": ["<class 'ray.rllib.policy.policy_template.SimpleQPolicy'>", "Box([0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.], (11,), float32)", "Discrete(2)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function train_psro_best_response.<locals>.select_policy at 0x7fe899a5b550>", "policies_to_train": ["best_response"], "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": false, "disable_env_checking": false, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 10000, "buffer_size": 200000, "replay_buffer_config": {"type": "MultiAgentReplayBuffer", "capacity": 50000}, "store_buffer_in_checkpoints": false, "replay_sequence_length": 1, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": null, "learning_starts": 16000, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": false, "hiddens": [256], "double_q": true, "n_step": 1, "prioritized_replay": false, "prioritized_replay_alpha": 0.0, "prioritized_replay_beta": 0.0, "final_prioritized_replay_beta": 0.0, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 0.0, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 1040.6889832019806, "timesteps_since_restore": 7086080, "iterations_since_restore": 1730, "warmup_time": 1.601977825164795, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 5.2}, "scenario_name": "kuhn_psro_dqn"}
